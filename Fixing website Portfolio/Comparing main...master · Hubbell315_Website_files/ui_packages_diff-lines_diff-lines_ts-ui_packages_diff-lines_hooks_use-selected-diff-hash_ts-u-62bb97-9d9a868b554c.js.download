"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["ui_packages_diff-lines_diff-lines_ts-ui_packages_diff-lines_hooks_use-selected-diff-hash_ts-u-62bb97","ui_packages_file-renderer-blob_FileRendererBlob_tsx"],{60281:(e,t,n)=>{n.d(t,{A:()=>i});let i={diff:"Diff-module__diff--GKRfQ",diffTargetable:"Diff-module__diffTargetable--hLfiB",diffHeaderWrapper:"Diff-module__diffHeaderWrapper--J03RC"}},73412:(e,t,n)=>{function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{z:()=>WebWorker});let WebWorker=class WebWorker{set onmessage(e){this.worker.onmessage=e}postMessage(e){this.worker.postMessage(e)}terminate(){this.worker.terminate()}constructor(e,t){i(this,"worker",void 0);try{this.worker=new Worker(`${e}?module=true`,{type:"module"})}catch{console.warn("Web workers are not available. Please enable web workers to benefit from the improved performance."),this.worker=new MainThreadWorker(t)}}};let MainThreadWorker=class MainThreadWorker{async postMessage(e){if(this.terminated)return;let t={data:this.job({data:e})};this.onmessage?.(t)}terminate(){this.terminated=!0}constructor(e){i(this,"terminated",!1),i(this,"onmessage",void 0),this.job=e}}},93307:(e,t,n)=>{function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{N:()=>DebouncedWorkerManager});let DebouncedWorkerManager=class DebouncedWorkerManager{post(e){if(this.debounceOverrideCondition&&this.debounceOverrideCondition(e))return this.delayId&&clearTimeout(this.delayId),this.postNow(e);this.idle()?(this.delayId&&clearTimeout(this.delayId),this.delayId=setTimeout(()=>{this.postNow(e)},this.delayMs)):this.nextRequest=e}postNow(e){this.currentRequest=e,this.worker.postMessage(e)}idle(){return!this.currentRequest}terminate(){this.worker.terminate()}constructor(e,t=200,n){i(this,"currentRequest",void 0),i(this,"nextRequest",void 0),i(this,"onResponse",void 0),i(this,"delayId",void 0),this.worker=e,this.delayMs=t,this.debounceOverrideCondition=n,this.worker.onmessage=({data:e})=>{this.onResponse&&this.onResponse(e),this.nextRequest?(this.postNow(this.nextRequest),this.nextRequest=void 0):this.currentRequest=void 0}}}},57259:(e,t,n)=>{n.d(t,{e:()=>i});function i(e){let t=document.querySelector('#__primerPortalRoot__ div[role="dialog"]'),n=document.querySelector(`#${e} div[role="dialog"]`);(t||n)&&document.dispatchEvent(new KeyboardEvent("keydown",{key:"Escape",code:"Escape",ctrlKey:!0}))}},91618:(e,t,n)=>{n.d(t,{HS:()=>l,Oc:()=>r,Tv:()=>o,Xr:()=>SymbolChangedEvent,f7:()=>a,fD:()=>s,qR:()=>i});let OpenCopilotChatEvent=class OpenCopilotChatEvent extends Event{constructor(e){super("open-copilot-chat",{bubbles:!1,cancelable:!0}),this.payload=e}};let AddCopilotChatReferenceEvent=class AddCopilotChatReferenceEvent extends Event{constructor(e,t=!1,n){super("add-copilot-chat-reference",{bubbles:!1,cancelable:!0}),this.reference=e,this.openPanel=t,this.id=n}};let SymbolChangedEvent=class SymbolChangedEvent extends Event{constructor(e){super("symbol-changed",{bubbles:!1,cancelable:!0}),this.context=e}};function i(e){window.dispatchEvent(new OpenCopilotChatEvent(e))}function r(e,t=!1,n){window.dispatchEvent(new AddCopilotChatReferenceEvent(e,t,n))}function l(e){return window.addEventListener("open-copilot-chat",e),()=>{window.removeEventListener("open-copilot-chat",e)}}function a(e){return window.addEventListener("add-copilot-chat-reference",e),()=>{window.removeEventListener("add-copilot-chat-reference",e)}}function s(e){return window.addEventListener("search-copilot-chat",e),()=>{window.removeEventListener("search-copilot-chat",e)}}function o(e){return window.addEventListener("symbol-changed",e),()=>{window.removeEventListener("symbol-changed",e)}}},77342:(e,t,n)=>{n.d(t,{C6:()=>r,UH:()=>o,Wp:()=>d,hs:()=>a,mF:()=>s,wh:()=>i,xP:()=>l});let i={explain:"explain",conversation:"conversation",suggest:"suggest",discussFileDiff:"discuss-file-diff",explainFileDiff:"explain-file-diff",reviewPr:"review-pull-request",actionsAgent:"actions-agent"},r=["exception","filtered","publicCode","contentTooLarge","rateLimit","agentUnauthorized","agentRequest","networkError","multipleAgentsAttempt"],l=["bing-search","codesearch","semantic-code-search","lexical-code-search","kb-search","getfile","getfilechanges","getdiscussion","get-actions-job-logs","getalert","planskill","get-github-data","support-search","get-figma","codesearchagentskill"],a={Experiments:"experiements",Prompt:"prompt",None:"none"},s={Unlicensed:"unlicensed",LicensedFull:"licensed_full",LicensedLimited:"licensed_limited"},o={IndividualFree:"free",IndividualPro:"pro",IndividualProPlus:"pro_plus",Business:"business",Enterprise:"enterprise"},d="NULL_MESSAGE"},1977:(e,t,n)=>{n.d(t,{B:()=>p,C:()=>g});var i=n(74848),r=n(21728),l=n(34164),a=n(38621),s=n(34614),o=n(16945),d=n(42522),c=n(84),u=n(69710),f=n(26514);let m={"diff-file-header":"DiffFileHeader-module__diff-file-header--TjXyn",collapsed:"DiffFileHeader-module__collapsed--FPwYM","file-name":"DiffFileHeader-module__file-name--mY1O5"};function h(e){let t,n;let l=(0,r.c)(13),{newPath:s,oldPath:o,status:d}=e;l[0]!==s?(t=(0,i.jsxs)(i.Fragment,{children:["\u200E",s]}),l[0]=s,l[1]=t):t=l[1];let c=t;l[2]!==o?(n=(0,i.jsxs)(i.Fragment,{children:["\u200E",o]}),l[2]=o,l[3]=n):n=l[3];let u=n;if("RENAMED"===d){let e,t,n;return l[4]===Symbol.for("react.memo_cache_sentinel")?(e=(0,i.jsx)(a.ArrowRightIcon,{}),t=(0,i.jsx)("span",{className:"sr-only",children:"renamed to "}),l[4]=e,l[5]=t):(e=l[4],t=l[5]),l[6]!==c||l[7]!==u?(n=(0,i.jsxs)("code",{children:[u," ",e,t,c]}),l[6]=c,l[7]=u,l[8]=n):n=l[8],n}if("DELETED"===d||"REMOVED"===d){let e;return l[9]!==u?(e=(0,i.jsx)("code",{children:u}),l[9]=u,l[10]=e):e=l[10],e}{let e;return l[11]!==c?(e=(0,i.jsx)("code",{children:c}),l[11]=c,l[12]=e):e=l[12],e}}function p(e){let t,n,p,g,x,b,y,C,v,N,j,w,L,k,S,D,I,E;let R=(0,r.c)(67),{additionalLeftSideContent:_,areLinesExpanded:A,canExpandOrCollapseLines:T,className:O,diffStatsProps:M,isBinary:$,isSubmodule:P,isCollapsed:F,canToggleRichDiff:U,headingId:H,linesAdded:B,linesChanged:z,linesDeleted:G,fileLinkHref:V,fileLinkRef:W,newMode:K,newPath:q,oldMode:X,oldPath:J,onCopyPath:Y,onHeaderClick:Q,onToggleDiffDisplay:Z,onToggleExpandAllLines:ee,onToggleFileCollapsed:et,patchStatus:en,path:ei,rightSideContent:er,size:el,showRichDiff:ea}=e,es=el&&"-"===el[0],eo=F?m.collapsed:"";R[0]!==O||R[1]!==eo?(t=(0,l.$)(m["diff-file-header"],eo,"flex-wrap flex-sm-nowrap",O),R[0]=O,R[1]=eo,R[2]=t):t=R[2];let ed=F?`Expand file: ${ei}`:`Collapse file: ${ei}`;R[3]!==F?(n=F?(0,i.jsx)(a.ChevronRightIcon,{}):(0,i.jsx)(a.ChevronDownIcon,{}),R[3]=F,R[4]=n):n=R[4],R[5]!==et||R[6]!==ed||R[7]!==n?(p=(0,i.jsx)("button",{onClick:et,className:"Button Button--iconOnly Button--invisible flex-shrink-0 flex-order-1","aria-label":ed,children:n}),R[5]=et,R[6]=ed,R[7]=n,R[8]=p):p=R[8],R[9]===Symbol.for("react.memo_cache_sentinel")?(g=(0,l.$)(m["file-name"]),R[9]=g):g=R[9],R[10]!==q||R[11]!==J||R[12]!==en?(x=(0,i.jsx)(h,{newPath:q,oldPath:J,status:en}),R[10]=q,R[11]=J,R[12]=en,R[13]=x):x=R[13],R[14]!==V||R[15]!==W||R[16]!==Q||R[17]!==x?(b=(0,i.jsx)(s.A,{className:"Link--primary",href:V,onClick:Q,ref:W,"data-analytics-opt-out":!0,children:x}),R[14]=V,R[15]=W,R[16]=Q,R[17]=x,R[18]=b):b=R[18],R[19]!==H||R[20]!==b?(y=(0,i.jsx)("h3",{id:H,className:g,children:b}),R[19]=H,R[20]=b,R[21]=y):y=R[21];let ec=q??J??"";return R[22]===Symbol.for("react.memo_cache_sentinel")?(C={direction:"s"},R[22]=C):C=R[22],R[23]!==Y||R[24]!==ec?(v=(0,i.jsx)(f.T,{className:"ml-1 flex-shrink-0",textToCopy:ec,ariaLabel:"Copy file name to clipboard",tooltipProps:C,onCopy:Y}),R[23]=Y,R[24]=ec,R[25]=v):v=R[25],R[26]!==K||R[27]!==X||R[28]!==en?(N=(0,c.AL)(en,X,K)&&(0,i.jsxs)("div",{className:"p-2",children:[(0,i.jsx)("code",{children:X}),(0,i.jsx)(a.ArrowRightIcon,{className:"mx-1"}),(0,i.jsx)("code",{children:K})]}),R[26]=K,R[27]=X,R[28]=en,R[29]=N):N=R[29],R[30]!==A||R[31]!==T||R[32]!==ee||R[33]!==ei?(j=T&&ee&&(0,i.jsx)(d.m,{text:A?`Collapse non-diff lines: ${ei}`:`Expand all lines: ${ei}`,direction:"s",children:(0,i.jsx)("button",{onClick:ee,className:`Button Button--iconOnly Button--invisible flex-shrink-0 ${A?"":"js-expand-all-difflines-button"}`,"aria-label":A?`Collapse non-diff lines: ${ei}`:`Expand all lines: ${ei}`,"data-file-path":ei,children:A?(0,i.jsx)(a.FoldIcon,{}):(0,i.jsx)(a.UnfoldIcon,{})})}),R[30]=A,R[31]=T,R[32]=ee,R[33]=ei,R[34]=j):j=R[34],R[35]!==v||R[36]!==N||R[37]!==j||R[38]!==y?(w=(0,i.jsxs)("div",{className:"d-flex px-1 flex-items-center overflow-hidden flex-order-2 flex-sm-order-1",children:[y,v,N,j]}),R[35]=v,R[36]=N,R[37]=j,R[38]=y,R[39]=w):w=R[39],R[40]!==M||R[41]!==P||R[42]!==B||R[43]!==z||R[44]!==G?(L=!P&&(0,i.jsx)(u.z,{linesAdded:B,linesDeleted:G,linesChanged:z,...M}),R[40]=M,R[41]=P,R[42]=B,R[43]=z,R[44]=G,R[45]=L):L=R[45],R[46]!==L?(k=(0,i.jsx)("div",{className:"d-flex mr-2 flex-justify-end flex-items-center flex-1",children:L}),R[46]=L,R[47]=k):k=R[47],R[48]!==$||R[49]!==es||R[50]!==el?(S=$&&(0,i.jsx)("div",{className:"d-flex flex-items-center",children:(0,i.jsx)("code",{className:(0,l.$)("px-2",es&&"fgColor-danger",!es&&"fgColor-success"),children:`${el}`})}),R[48]=$,R[49]=es,R[50]=el,R[51]=S):S=R[51],R[52]!==U||R[53]!==Z||R[54]!==ea?(D=U&&(0,i.jsxs)(o.I,{"aria-label":"File view",size:"small",className:"mx-2",onChange:Z?e=>Z(1===e):void 0,children:[(0,i.jsx)(o.I.IconButton,{"aria-label":"Display the source diff",selected:!ea,icon:a.CodeIcon}),(0,i.jsx)(o.I.IconButton,{"aria-label":"Display the rich diff",selected:ea,icon:a.FileIcon})]}),R[52]=U,R[53]=Z,R[54]=ea,R[55]=D):D=R[55],R[56]!==er||R[57]!==k||R[58]!==S||R[59]!==D?(I=(0,i.jsxs)("div",{className:"d-flex flex-row flex-justify-end flex-1 flex-order-1 flex-sm-order-2 flex-items-center",children:[k,S,D,er]}),R[56]=er,R[57]=k,R[58]=S,R[59]=D,R[60]=I):I=R[60],R[61]!==_||R[62]!==w||R[63]!==t||R[64]!==I||R[65]!==p?(E=(0,i.jsxs)("div",{className:t,children:[p,_,w,I]}),R[61]=_,R[62]=w,R[63]=t,R[64]=I,R[65]=p,R[66]=E):E=R[66],E}try{h.displayName||(h.displayName="FileName")}catch{}try{p.displayName||(p.displayName="DiffFileHeader")}catch{}function g(e){let t,n;let a=(0,r.c)(6),{children:s,isAddition:o,className:d}=e,c=o?"fgColor-success":"fgColor-danger";return a[0]!==d||a[1]!==c?(t=(0,l.$)("ml-1 text-small text-bold",c,d),a[0]=d,a[1]=c,a[2]=t):t=a[2],a[3]!==s||a[4]!==t?(n=(0,i.jsx)("div",{className:t,children:s}),a[3]=s,a[4]=t,a[5]=n):n=a[5],n}try{g.displayName||(g.displayName="LinesChangedCounterLabel")}catch{}},84:(e,t,n)=>{function i(e){return void 0!==e.linesChanged&&0!==e.linesChanged}function r(e,t,n){return"MODIFIED"===e&&t!==n}function l(e,t,n,r){return"MODIFIED"===t&&n!==r&&!i(e)}function a(e){return"COPIED"===e.status&&!i(e)}function s(e){return"RENAMED"===e.status&&!i(e)}function o(e){return!!e.oldTreeEntry&&null===e.newTreeEntry}function d(e){return!!e.truncatedReason}n.d(t,{AL:()=>r,HI:()=>d,Jc:()=>a,Sn:()=>l,dK:()=>s,lO:()=>o,l_:()=>f,s8:()=>h,xW:()=>m});let c=["maximum diff size exceeded.","maximum number of lines exceeded."],u=/^maximum file count exceeded/;function f(e){let t=e;return c.includes(e)?t="This diff could not be loaded automatically because of too many other changes.":u.test(e)&&(t="This diff could not be loaded automatically because of too many other files to display."),t}function m(e){return!!e.newTreeEntry?.isGenerated}function h(e){return 0===e.linesChanged}},26920:(e,t,n)=>{n.d(t,{QC:()=>f,s2:()=>m,wH:()=>a,xY:()=>u});var i=n(3240);function r(e,t){var n=function(e,t,n){if(!t.has(e))throw TypeError("attempted to get private field on non-instance");return t.get(e)}(e,t,0);return n.get?n.get.call(e):n.value}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){return e<t?-1:e>t?1:0}function s(e,t){return a(e.name,t.name)}function o(e,t){return a(e.fileName,t.fileName)}function d(e){return e.diff}let FileNode=class FileNode{constructor(e){this.diff=e,this.filePath=e.path;let t=this.filePath.split("/");this.fileName=t[t.length-1],this.directoryParts=t.slice(0,t.length-1)}};var c=new WeakMap;let DirectoryNode=class DirectoryNode{getOrCreateDirectory(e){let t=r(this,c).get(e);if(!t){let n=this.path?`${this.path}/`:"";t=new DirectoryNode(e,`${n}${e}`),this.directories.push(t),r(this,c).set(e,t)}return t}sort(){for(let e of(this.directories.sort(s),this.files.sort(o),this.directories))e.sort()}getOrderedDiffs(){let e=this.files.map(d);for(let t of this.directories)e.push(...t.getOrderedDiffs());return e}constructor(e,t){l(this,"directories",[]),l(this,"files",[]),function(e,t,n){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,n)}(this,c,{writable:!0,value:new Map}),this.name=e,this.path=t}};function u(e){let t=new DirectoryNode("","");for(let n of e.slice(0,300).map(e=>new FileNode(e))){let e=t;for(let t of n.directoryParts)e=e.getOrCreateDirectory(t);e.files.push(n)}return t.sort(),t}function f(e){let t;t="string"==typeof e?e:e?.newPath||e?.oldPath;let n=t?.lastIndexOf(".");return t?!n||n<0?i.F7:`.${t.substring(n+1)}`:""}function m(e){let t={};return e.map(e=>{let n=f(e.path);void 0!==t[n]?t[n]+=1:t[n]=1}),t}},95732:(e,t,n)=>{n.d(t,{oO:()=>ny,Ao:()=>nb,n$:()=>nj,cP:()=>nL,T5:()=>ne,Uz:()=>c,Wb:()=>na,Dd:()=>C.Dd,xB:()=>n_});var i=n(74848),r=n(1977),l=n(96540),a=n(8877),s=n(84688),o=n(44968),d=n(63867);function c({dependencyDiffPath:e,fileRendererInfo:t,proseDiffHtml:n,loading:r}){return r?(0,i.jsx)("div",{className:"d-flex flex-justify-center p-4",children:(0,i.jsx)(d.A,{size:"large"})}):n?(0,i.jsx)("div",{className:"prose-diff position-relative",children:(0,i.jsx)(o.oG,{html:n})}):t?(0,i.jsx)(a.default,{...t}):e?(0,i.jsx)(s.x,{src:e,children:(0,i.jsxs)("div",{className:"text-center py-3",children:[(0,i.jsx)(d.A,{size:"medium"}),(0,i.jsx)("p",{className:"color-fg-muted my-2",children:"Loading Dependency Review..."})]})}):(0,i.jsx)("div",{className:"d-flex flex-justify-center p-4",children:"This rich diff is not supported at the moment."})}try{c.displayName||(c.displayName="RichDiff")}catch{}var u=n(84),f=n(73974),m=n(67220),h=n(34614),p=n(13080),g=n(47584),x=n(46996),b=n(37109);function y({selectedDiffRowRange:e,leftLines:t,rightLines:n,isNumberCell:i}){let r=!!n,{startOrientation:l,endOrientation:a}=e;if(e.startLineNumber===e.endLineNumber&&e.startOrientation===e.endOrientation&&!i)return{isRowSelected:()=>!1,selectedRightLines:[],selectedLeftLines:[]};let s=u(l).findIndex(t=>(0,b.a2)(t,e.startLineNumber,e.startOrientation)),o=u(a).findIndex(t=>(0,b.a2)(t,e.endLineNumber,e.endOrientation)),d=s>=0&&o>=0;function c(e){if(!d||(0,b.Po)(e))return!1;let t=u((0,m.XU)(e.type)).indexOf(e);return t>=s&&t<=o}function u(e){return r&&"left"!==("string"==typeof e?e:(0,m.XU)(e.type))?n:t}let f=u("left").filter(e=>c(e)),h=u("right").filter(e=>c(e));return{isRowSelected:c,selectedRightLines:h,selectedLeftLines:f}}var C=n(29063),v=n(38568);let N=e=>{let t=(0,l.useRef)(e);return(0,v.N)(()=>(t.current=e,()=>t.current=null),[e]),(0,l.useCallback)((...e)=>t.current?.(...e),[])};var j=n(4460);let w=(0,l.createContext)(null);function L(){let e=(0,l.useContext)(w);if(!e)throw Error("useSelectedDiffRowRange must be used within a SelectedDiffRowRangeContext");return e}function k(e){e.startLineNumber===e.endLineNumber&&e.startOrientation===e.endOrientation?(0,p.i)(`${"left"===e.startOrientation?"L":"R"}${e.startLineNumber} selected.`):(0,p.i)(`${"left"===e.startOrientation?"L":"R"}${e.startLineNumber} to ${"left"===e.endOrientation?"L":"R"}${e.endLineNumber} selected.`)}function S({children:e}){let t=(0,l.useRef)(new Map),n=N((e,n)=>{if(!e)return;let i=e.diffAnchor,r=t.current.get(i);if(!r)return;let{leftLines:l,rightLines:a}=(0,b.Mk)(r);return y({selectedDiffRowRange:e,leftLines:l,rightLines:a,isNumberCell:n})}),[r,a]=(0,l.useState)(()=>(0,C.ZD)(g.fV.hash)),[s,o]=(0,l.useState)(()=>{if(r){let e=n(r);if(e)return{leftLines:e.selectedLeftLines,rightLines:e.selectedRightLines||[]}}return{leftLines:[],rightLines:[]}}),d=N((e,t)=>{let i=n(e,t),r=i?{leftLines:i.selectedLeftLines,rightLines:i.selectedRightLines||[]}:{leftLines:[],rightLines:[]};(0,x.A)(s,r)||o(r)}),c=N((e,t,n,i,l)=>{if(!t||!n)return;let s=i&&r&&r.diffAnchor===e?t<=r.firstSelectedLineNumber?{...r,startLineNumber:t,startOrientation:n,endLineNumber:r.firstSelectedLineNumber,endOrientation:r.firstSelectedOrientation}:{...r,startLineNumber:r.firstSelectedLineNumber,startOrientation:r.firstSelectedOrientation,endLineNumber:t,endOrientation:n}:{diffAnchor:e,endLineNumber:t,endOrientation:n,startLineNumber:t,startOrientation:n,firstSelectedLineNumber:t,firstSelectedOrientation:n};k(s),(l||i)&&a(s),d(s,l),(0,C.i8)(s)}),u=N(e=>{k(e),a(e),d(e),(0,C.i8)(e)}),f=N(({diffAnchor:e,startGridCell:t,endGridCell:n,focusedGridCell:i})=>{u({diffAnchor:e,endLineNumber:n.lineNumber,endOrientation:n.orientation,firstSelectedLineNumber:i.lineNumber,firstSelectedOrientation:i.orientation,startLineNumber:t.lineNumber,startOrientation:t.orientation})}),m=N(()=>{r&&(a(void 0),d(void 0),(0,p.i)("Selection Cleared"),(0,j.K3)())}),h=N((e,n)=>{t.current.set(e,n),r?.diffAnchor===e&&d(r)}),v=N(e=>t.current.get(e)),L=(0,l.useMemo)(()=>({selectedDiffRowRange:r,updateSelectedDiffRowRange:c,clearSelectedDiffRowRange:m,replaceSelectedDiffRowRange:u,replaceSelectedDiffRowRangeFromGridCells:f,updateDiffLines:h,selectedDiffLines:s,getDiffLinesFromLineRange:n,getDiffLinesByDiffAnchor:v}),[r,c,m,u,f,s,h,n,v]);return(0,i.jsx)(w.Provider,{value:L,children:e})}try{w.displayName||(w.displayName="SelectedDiffRowRangeContext")}catch{}try{S.displayName||(S.displayName="SelectedDiffRowRangeContextProvider")}catch{}var D=n(34164),I=n(55847);let E={gridColumnTemplate:"HiddenDiffPatch-module__gridColumnTemplate--3bEGq"};var R=n(38621);function _({children:e,helpText:t,helpUrl:n,onLoadDiff:r,diffAnchor:a}){let s=n&&t,[o,c]=(0,l.useState)("initial"),u=(0,l.useCallback)(async()=>{try{c("loading"),await r()}catch{c("error")}},[r,c]);return(0,i.jsx)("div",{className:"px-3 py-4 fgColor-muted","data-diff-anchor":a,children:(0,i.jsxs)("div",{className:(0,D.$)(E.gridColumnTemplate),children:[(0,i.jsx)("svg",{"aria-hidden":!0,height:"84",style:{maxWidth:"340px"},viewBox:"0 0 340 84",xmlns:"http://www.w3.org/2000/svg",children:(0,i.jsx)("path",{clipPath:"url(#diff-placeholder)",d:"M0 0h340v84H0z",fillRule:"evenodd",style:{fill:"var(--bgColor-muted, var(--color-canvas-subtle))"}})})," ",(0,i.jsxs)("div",{className:"d-flex flex-justify-center flex-column flex-column text-center flex-items-center",children:["loading"===o&&(0,i.jsx)(d.A,{size:"medium"}),"error"===o&&(0,i.jsx)(R.AlertIcon,{size:24}),"initial"===o&&(0,i.jsx)(I.Q,{className:"h4 mx-auto fgColor-accent",variant:"invisible",onClick:()=>{u(),c("loading")},children:"Load Diff"}),"error"===o?(0,i.jsxs)("span",{className:"fgColor-muted mt-1",children:["The contents of the file couldn't be loaded."," ",(0,i.jsx)(h.A,{inline:!0,as:"button",onClick:()=>{u(),c("loading")},children:"Retry"})]}):(0,i.jsxs)("span",{className:"fgColor-muted mt-1",children:[e,s&&(0,i.jsx)(h.A,{inline:!0,href:n,children:t})]})]})]})})}try{_.displayName||(_.displayName="HiddenDiffPatch")}catch{}let A={finalLineId:"final-hunk-header-line"};function T(e,t){return e.startBlobLineNumber-t.startBlobLineNumber}function O(e,t){if("HUNK"===e.type&&e.__id===A.finalLineId)return{currentHunk:t[t.length-1],previousHunk:t[t.length-2]};let n=t.sort(T).findIndex(t=>t.startBlobLineNumber<=e.blobLineNumber&&t.endBlobLineNumber>=e.blobLineNumber);return{currentHunk:t[n],nextHunk:t[n+1],previousHunk:t[n-1]}}function M(e){let t;let n=[],i=0;for(let r=1;r<e.length;r++){let l=e[r];if(l&&!(0,b.Po)(l)&&(t=l,"HUNK"===l.type)){let t;let a=e[i];if(!a||(0,b.Po)(a))continue;let s=r-1;for(;(!t||(0,b.Po)(t))&&(t=e[s],-1!=--s););t&&!(0,b.Po)(t)&&n.push({startBlobLineNumber:a.blobLineNumber,endBlobLineNumber:t.blobLineNumber}),l.__id===A.finalLineId&&n.push({startBlobLineNumber:l.blobLineNumber,endBlobLineNumber:l.blobLineNumber+20}),i=r;continue}}if(t&&"HUNK"!==t.type){let r=e[i];r&&!(0,b.Po)(r)&&n.push({startBlobLineNumber:r.blobLineNumber,endBlobLineNumber:t.blobLineNumber})}return n}let $=(0,l.createContext)(null);function P({children:e,currentHunk:t,diffEntryId:n,diffLine:r,fileAnchor:a,fileLineCount:s,filePath:o,hasHiddenUnicodeCharacters:d,isLeftSide:c,isRowSelected:u=!1,isSplit:f,modifiedLineThreads:m,nextHunk:h,originalLineThreads:p,previousHunk:g,rowId:x,diffContext:b,setInGridMode:y}){let C=(0,l.useMemo)(()=>({currentHunk:t,diffEntryId:n,diffLine:r,fileAnchor:a,fileLineCount:s,filePath:o,hasHiddenUnicodeCharacters:d,isLeftSide:c,isRowSelected:u,isSplit:f,modifiedLineThreads:m,modifiedLineHasThreads:m&&m.length>0,nextHunk:h,originalLineThreads:p,originalLineHasThreads:p&&p.length>0,previousHunk:g,rowId:x,diffContext:b,setInGridMode:y}),[t,n,r,a,s,o,d,c,u,f,m,h,p,g,x,b,y]);return(0,i.jsx)($.Provider,{value:C,children:e})}function F(){let e=(0,l.useContext)($);if(!e)throw Error("useDiffLineContext must be used within a DiffLineContextProvider");return e}try{$.displayName||($.displayName="DiffLineContext")}catch{}try{P.displayName||(P.displayName="DiffLineContextProvider")}catch{}function U(e,t){return e?.threads?.flatMap(e=>{let n=e?.id,i=e?.commentsData?.comments?.[0]?.author??t,r=e?.commentsData?.totalCount??0,l=e?.commentsData?.__id;return n&&i?[{id:n,author:i,commentCount:r,commentsConnectionId:l,diffSide:e.diffSide,isOutdated:e.isOutdated,line:e.line,startLine:e.startLine,startDiffSide:e.startDiffSide}]:[]})??[]}var H=n(82678);function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let GridNavigator=class GridNavigator{moveToNextItem(e,t){let n;let i=this.cellIdToGridLocation.get(this.focusedGridCell?.cellId??"");if(!i)return;let[r]=i,[,l]=i;switch(("ArrowDown"===e||"ArrowUp"===e)&&this.isHunkRow(r)&&this.savedColumnIndex&&(l=this.savedColumnIndex,this.savedColumnIndex=void 0),!0){case t&&"Home"===e:this.focusFirstGridCell();break;case t&&"End"===e:{let e=this.grid.length-1,t=this.grid[e]?.length;t&&(n=this.grid[e]?.[t-1]);break}case"ArrowUp"===e:this.isHunkRow(r-1)?(this.saveColumnIndex(l),n=this.grid[r-1]?.[0]):n=this.grid[r-1]?.[l];break;case"ArrowDown"===e:this.isHunkRow(r+1)?(this.saveColumnIndex(l),n=this.grid[r+1]?.[0]):n=this.grid[r+1]?.[l];break;case"ArrowLeft"===e:n=this.grid[r]?.[l-1];break;case"ArrowRight"===e:n=this.grid[r]?.[l+1];break;case"PageUp"===e:{this.saveColumnIndex(l);let e=this.getPreviousHunkRowIndex(r);n=this.grid[e]?.[0];break}case"PageDown"===e:{this.saveColumnIndex(l);let e=this.getNextHunkRowIndex(r),t=0;e||(e=this.grid.length-1,t=l),n=this.grid[e]?.[t];break}case"Home"===e:n=this.grid[r]?.[0];break;case"End"===e:{let e=this.grid[r];if(e&&!this.isHunkRow(r)){let t=e.length-1;n=this.grid[r]?.[t]}}}return n&&(this.focusedGridCell=n),this.focusedGridCell}reinitializeGrid(e,t){this.initializeGrid(e,t)}focusFirstGridCell(e){e&&this.cellIdToGridLocation.get(e)?this.focusGridCell(e):this.focusedGridCell=this.grid[0]?.[0]}focusGridCell(e){if(this.focusedGridCell?.cellId===e)return;let t=this.cellIdToGridLocation.get(e);if(!t)return;let[n,i]=t;this.focusedGridCell=this.grid[n]?.[i]}getNextSelectableCell(e){let t;let n=this.lastSelectedGridCell||this.focusedGridCell,i=this.cellIdToGridLocation.get(n?.cellId??"");if(!i)return;let[r,l]=i;if(("ArrowUp"!==e||!(r<=1))&&("ArrowDown"!==e||r!==this.grid.length-1)){if("ArrowUp"===e){let e=r-1;for(;!t;)t=this.getNextSelectableCellFromRow({rowIndex:e,columnIndex:l}),e--}if("ArrowDown"===e){let e=r+1;for(;!t;)t=this.getNextSelectableCellFromRow({rowIndex:e,columnIndex:l}),e++}return t&&(this.lastSelectedGridCell=t),t}}getValidSelectableRowCell(){if(this.focusedGridCell?.isHunk)return;if(!this.focusedGridCell?.isEmpty)return this.focusedGridCell;let e=this.cellIdToGridLocation.get(this.focusedGridCell.cellId)?.[0];if(e)return this.focusedGridCell.columnIndex<2?this.grid[e]?.[this.focusedGridCell.columnIndex+2]:this.grid[e]?.[this.focusedGridCell.columnIndex-2]}clearLastSelectedCell(){this.lastSelectedGridCell=void 0}getFirstCodeCell(){let e=this.grid.find(e=>e[0]&&!e[0].isHunk);return e?.find(e=>!e.isEmpty)}getLastCodeCell(){let e=this.grid.slice().reverse().find(e=>e[0]&&!e[0].isHunk);return e?.slice().reverse().find(e=>!e.isEmpty)}hasLine(e,t,n){let i=(0,b.qX)(this.fileAnchor,e,t),r=(0,b.u6)(i,0),l=this.cellIdToGridLocation.get(r);if(!l)return!1;let[a]=l;return!!n===this.isHunkRow(a)}getNextSelectableCellFromRow({rowIndex:e,columnIndex:t}){let n=this.grid[e],i=n?.[t];switch(!0){case i?.isHunk:return;case i?.orientation==="left"&&i.isEmpty:return n?.[t+2];case i?.orientation==="right"&&i.isEmpty:return n?.[t-2];default:return n?.[t]}}getNextHunkRowIndex(e){return Array.from(this.hunkRowIndexes).sort((e,t)=>e-t).find(t=>t>e)}getPreviousHunkRowIndex(e){return Array.from(this.hunkRowIndexes).sort((e,t)=>e-t).reverse().find(t=>t<e)??0}initializeGrid(e,t){this.grid=[],this.cellIdToGridLocation=new Map,this.hunkRowIndexes=new Set;for(let n=0;n<e.length;n++){let i=[],r=e[n];if(void 0!==r){if(this.isSplitDiff){let e=(t||[])[n],l=(0,b.qX)(this.fileAnchor,r,e);(0,b.Po)(r)||"HUNK"!==r.type?this.initializeSplitDiffCodeRow({leftLine:r,rightLine:e,row:i,rowIdentifier:l,rowIndex:n}):this.initializeHunkRow(i,l,n)}else{let e=(0,b.qX)(this.fileAnchor,r,r);(0,b.Po)(r)||"HUNK"!==r.type?this.initializeUnifiedDiffCodeRow({diffLine:r,row:i,rowIdentifier:e,rowIndex:n}):this.initializeHunkRow(i,e,n)}this.grid.push(i)}}}initializeContentCell({cellIndex:e,diffLine:t,orientation:n,row:i,rowIdentifier:r,rowIndex:l}){let a;let s=(0,b.u6)(r,e);(0,b.Po)(t)||"left"!==n||(a=t?.left),(0,b.Po)(t)||"right"!==n||(a=t?.right),i.push({lineNumber:a,orientation:n,isHunk:!1,isEmpty:(0,b.Po)(t),cellId:(0,b.u6)(r,e),columnIndex:e}),this.cellIdToGridLocation.set(s,[l,e])}initializeHunkRow(e,t,n){let i=(0,b.u6)(t,0);e.push({isHunk:!0,isEmpty:!1,cellId:i,columnIndex:0}),this.cellIdToGridLocation.set(i,[n,0]),this.hunkRowIndexes.add(n)}isHunkRow(e){return this.hunkRowIndexes.has(e)}initializeSplitDiffCodeRow({leftLine:e,rightLine:t,row:n,rowIdentifier:i,rowIndex:r}){this.initializeContentCell({cellIndex:0,diffLine:e,orientation:"left",row:n,rowIdentifier:i,rowIndex:r}),this.initializeContentCell({cellIndex:1,diffLine:e,orientation:"left",row:n,rowIdentifier:i,rowIndex:r}),this.initializeContentCell({cellIndex:2,diffLine:t,orientation:"right",row:n,rowIdentifier:i,rowIndex:r}),this.initializeContentCell({cellIndex:3,diffLine:t,orientation:"right",row:n,rowIdentifier:i,rowIndex:r})}initializeUnifiedDiffCodeRow({diffLine:e,row:t,rowIdentifier:n,rowIndex:i}){let r=(0,b.Po)(e)||"DELETION"!==e.type?"right":"left";this.initializeContentCell({cellIndex:0,diffLine:e,orientation:"left",row:t,rowIdentifier:n,rowIndex:i}),this.initializeContentCell({cellIndex:1,diffLine:e,orientation:"right",row:t,rowIdentifier:n,rowIndex:i}),this.initializeContentCell({cellIndex:2,diffLine:e,orientation:r,row:t,rowIdentifier:n,rowIndex:i})}saveColumnIndex(e){this.isHunkRow(e)||(this.savedColumnIndex=e)}constructor(e,t,n,i,r){B(this,"grid",[]),B(this,"cellIdToGridLocation",new Map),B(this,"hunkRowIndexes",new Set),B(this,"focusedGridCell",void 0),B(this,"lastSelectedGridCell",void 0),B(this,"savedColumnIndex",void 0),this.fileAnchor=e,this.isSplitDiff=t,this.initializeGrid(n,i),this.focusFirstGridCell(r)}};function z(e){e&&setTimeout(()=>{0!==e.tabIndex&&(e.tabIndex=0)})}var G=n(69676);let V={ArrowLeft:G.z0.ArrowHorizontal,ArrowDown:G.z0.ArrowVertical,ArrowUp:G.z0.ArrowVertical,ArrowRight:G.z0.ArrowHorizontal,h:G.z0.HL,j:G.z0.JK,k:G.z0.JK,l:G.z0.HL,a:G.z0.AD,s:G.z0.WS,w:G.z0.WS,d:G.z0.AD,Tab:G.z0.Tab,Home:G.z0.HomeAndEnd,End:G.z0.HomeAndEnd,PageUp:G.z0.PageUpDown,PageDown:G.z0.PageUpDown,Backspace:G.z0.Backspace},W=G.z0.ArrowAll|G.z0.PageUpDown|G.z0.HomeAndEnd|G.z0.AD,K={ghostUser:{displayName:"Ghost",login:"ghost",avatarUrl:"https://avatars.githubusercontent.com/ghost",path:"/ghost",url:"/ghost"}};function q(e){return e in V&&(V[e]&W)>0}function X({clearSelectedDiffRowRange:e,containerRef:t,fileAnchor:n,isSplitDiff:i,leftLines:r,replaceSelectedDiffRowRangeFromGridCells:a,rightLines:s,selectedDiffRowRange:o,updateSelectedDiffRowRange:d,disabled:c}){var u;let f=(0,l.useRef)(void 0),m=(0,l.useMemo)(()=>new GridNavigator(n,i,r,s,f.current?.focusedGridCell?.cellId),[n,i,r,s]);(0,l.useEffect)(()=>{f.current=m},[m]),u=f.current,(0,l.useEffect)(()=>{if(u&&document.activeElement){let e=function(e,t,n){let i=[];for(let r=0;r<t.length;r++){let l=t[r],a=n?.[r]??l,s=!(0,b.Po)(l)&&l?.type==="HUNK";l&&a&&!e.hasLine(l,a,s)&&i.push(l)}return i}(u,r,s);if(0!==e.length){if(document.activeElement===document.body){let t,i,l;let a=r.indexOf(e[e.length-1]),s=r[a+1],o=e[0];s&&!(0,b.Po)(s)&&"HUNK"===s.type&&(t=(0,b.u6)((0,b.qX)(n,s,s),0),i=document.querySelector(`[data-grid-cell-id=${t}]`),l=i?.querySelector("button[data-direction=down], button[data-direction=all]")),l||(t=(0,b.u6)((0,b.qX)(n,o,o),0),i=document.querySelector(`[data-grid-cell-id=${t}]`),l=i?.querySelector("button[data-direction=up], button[data-direction=all]")),t&&i&&(l?l.focus():i.focus(),m.focusGridCell(t),z(i))}else if("BUTTON"===document.activeElement.tagName)z(document.activeElement.closest("td"));else if("TD"===document.activeElement.tagName){let e=document.activeElement.getAttribute("data-grid-cell-id"),n=m.focusedGridCell?.cellId;if(e!==n){let e=t.current?.querySelector(`[data-grid-cell-id=${n}]`);e?.focus()}}}}},[n,r,m,s,u,t]),function(e,t){let n=(0,l.useCallback)(e=>{let n=e.target.getAttribute("data-grid-cell-id");n&&t.focusGridCell(n)},[t]);(0,l.useEffect)(()=>{let t=e.current;return t?.addEventListener("focusin",n),()=>t?.removeEventListener("focusin",n)},[e,n])}(t,m);let h=(0,l.useCallback)((t,i,r)=>{let l=m.getValidSelectableRowCell();switch(!0){case(r.metaKey||r.ctrlKey)&&"KeyA"===r.code:{let e=m.getFirstCodeCell(),t=m.getLastCodeCell();if(!e||!t)return i;return a({diffAnchor:n,focusedGridCell:e,startGridCell:e,endGridCell:t}),i}case r.shiftKey&&"ArrowDown"===r.key:{let e=m.getNextSelectableCell("ArrowDown");if(!e||!l)return i;return o?.firstSelectedLineNumber?d(n,e.lineNumber,e.orientation,!0):a({diffAnchor:n,focusedGridCell:l,startGridCell:l,endGridCell:e}),i}case r.shiftKey&&"ArrowUp"===r.key:{let e=m.getNextSelectableCell("ArrowUp");if(!e||!l)return i;return o?.firstSelectedLineNumber?d(n,e.lineNumber,e.orientation,!0):a({diffAnchor:n,focusedGridCell:l,startGridCell:e,endGridCell:l}),i}case"ArrowLeft"===r.key&&r.metaKey&&r.shiftKey:return i;default:{let t=m.moveToNextItem(r.key,r.ctrlKey),n=t&&document.querySelector(`[data-grid-cell-id=${t.cellId}]`);return e(),m.clearLastSelectedCell(),n??void 0}}},[m,o,d,n,a,e]);return(0,H.G)({containerRef:t,bindKeys:W,getNextFocusable:h,focusableElementFilter:e=>"BUTTON"!==e.tagName&&"TEXTAREA"!==e.tagName,focusInStrategy:"previous",disabled:c},[h]),{gridNavigator:m}}var J=n(54332),Y=n(42242),Q=n(82431),Z=n(87330),ee=n(56126);let et=G.z0.ArrowAll;function en(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}G.z0.ArrowHorizontal,G.z0.ArrowVertical,G.z0.ArrowVertical,G.z0.ArrowHorizontal;let MarkerNavigator=class MarkerNavigator{focusMarker(e){let t=this.markers.findIndex(t=>t.id.toString()===e.toString());-1!==t&&(this.currentMarkerPosition={markerId:e,index:t})}get focusedMarker(){if(this.currentMarkerPosition)return this.markers[this.currentMarkerPosition.index]}moveToFirstComment(e){if(0!==this.markers.length&&!e)return}moveToNextMarker(e,t){let n;if(0===this.markers.length)return;if(t){let e=t.closest("[data-marker-id]"),n=e?.getAttribute("data-marker-id");n&&(this.currentMarkerPosition={markerId:n,index:this.markers.findIndex(e=>e.id.toString()===n.toString())})}if(!this.currentMarkerPosition){let t="ArrowUp"===e?this.markers.length-1:0,n=this.markers[t];if(!n)return;return this.currentMarkerPosition={markerId:n.id,index:t},this.markers[t]}let i=0===this.currentMarkerPosition.index,r=this.currentMarkerPosition.index===this.markers.length-1;switch(e){case"ArrowDown":if(r)return;n=(this.currentMarkerPosition.index+1)%this.markers.length;break;case"ArrowUp":if(i)return;n=(this.currentMarkerPosition.index-1+this.markers.length)%this.markers.length;break;default:return}let l=this.markers[n];if(l)return this.currentMarkerPosition={markerId:l.id,index:n},l}moveToNextMarkerItem(e,t){let n;if(!t||!this.markerComments)return;let i=t.closest("[data-marker-id]"),r=i?.getAttribute("data-marker-id");if(!i||!r)return;let l=this.markerComments[Number(r)]||[];if(0===l.length)return;let a=t.getAttribute("data-marker-navigation-comment-id"),s=l.findIndex(e=>e.id===a);if(-1===s)return;let o=s===l.length-1;switch(e){case"ArrowDown":if(o)return;n=s+1;break;case"ArrowUp":if(0===s)return;n=s-1;break;default:return}let d=l[n];if(d)return this.currentMarkerCommentPosition={markerId:d.id,index:n},d}constructor(e,t,n){if(en(this,"markers",void 0),en(this,"markerComments",null),en(this,"currentMarkerPosition",null),en(this,"currentMarkerCommentPosition",null),this.markers=e.map(e=>{let t=e.id;return{...e,id:t}}),this.markerComments=e.reduce((e,t)=>{let n=document.querySelectorAll(`[data-marker-navigation-comment-thread-id="${t.id}"]`);if(n){let i=Array.from(n).map(e=>({id:e.getAttribute("data-marker-navigation-comment-id")}));return{...e,[t.id]:i}}return e},{}),t&&!n){let e=this.markers.findIndex(e=>e.id.toString()===t.toString());-1!==e&&(this.currentMarkerPosition={markerId:t,index:e})}}};var ei=n(42389);let er="a, audio, button, details, embed, iframe, img, input, keygen, label, object, select, textarea, video";function el(e){e?.setAttribute("aria-hidden","true"),function t(n=0){setTimeout(()=>{let n=Array.from(e?.querySelectorAll("*")??[]),i=Array.from(e?.querySelectorAll(er)??[]);if(0===i.length)return t(200);for(let e of n)e?.setAttribute("aria-hidden","true");for(let e of i)e.setAttribute("tabindex","-1")},n)}()}function ea(e){setTimeout(()=>{for(let t of(e?.setAttribute("aria-hidden","false"),Array.from(e?.querySelectorAll("*")??[])))t?.setAttribute("aria-hidden","false");for(let t of Array.from(e?.querySelectorAll(er)??[]))t.setAttribute("tabindex","0")},100)}var es=n(33563);let eo={inlineAnnotation:"InlineAnnotation-module__inlineAnnotation--mNxPj"};function ed({annotation:e,isFirstMarker:t}){let n=(0,l.useRef)(null),{isInDialogMode:r}=(0,Y.q)();return(0,l.useEffect)(()=>{r?ea(n.current):el(n.current)},[r]),(0,i.jsx)("div",{id:`annotation_${e.databaseId}`,ref:n,className:(0,D.$)("border rounded-2 color-border-default color-shadow-small overflow-hidden",t?"mb-1":"mb-2",eo.inlineAnnotation),"data-level":e.annotationLevel,"data-testid":`annotation-${e.id}`,"data-marker-id":`${e.id}`,tabIndex:r?0:-1,children:(0,i.jsx)(es.Y,{annotation:e})})}try{ed.displayName||(ed.displayName="InlineAnnotation")}catch{}let ec={closeMarkersDialogButton:"InlineMarkers-module__closeMarkersDialogButton--H1wyh",markersWrapper:"InlineMarkers-module__markersWrapper--gRSoz",markersDialogActive:"InlineMarkers-module__markersDialogActive--j6cUe",markersDialogInactive:"InlineMarkers-module__markersDialogInactive--iCOj1"};var eu=n(12152),ef=n(80688),em=n(70404),eh=n(52464),ep=n(75177),eg=n(47139),ex=n(6869),eb=n(30729),ey=n(93116),eC=n(42522);let ev={inlineReviewThreadHeading:"InlineReviewThread-module__inlineReviewThreadHeading--CroDZ"};var eN=n(94493);function ej({children:e}){return(0,i.jsx)(eh.A,{sx:{fontWeight:500,color:"fg.default"},children:e})}function ew({thread:e}){return void 0!==e&&e?.diffSide&&e.line?e.startLine&&e.startDiffSide?ek({thread:e}):eL({thread:e}):null}function eL({thread:e}){let t="LEFT"===e.diffSide?"L":"R";return(0,i.jsxs)("h2",{className:ev.inlineReviewThreadHeading,children:["Comment on line"," ",(0,i.jsxs)(ej,{children:[t,e.line]})]})}function ek({thread:e}){let t="LEFT"===e.startDiffSide?"L":"R",n="LEFT"===e.diffSide?"L":"R";return(0,i.jsxs)("h2",{className:ev.inlineReviewThreadHeading,children:["Comment on lines"," ",(0,i.jsxs)(ej,{children:[t,e.startLine]})," ","to"," ",(0,i.jsxs)(ej,{children:[n,e.line]})]})}function eS(){return(0,i.jsx)("div",{className:"position-relative",children:(0,i.jsxs)(ey.E,{border:!0,children:[(0,i.jsx)(ey.E.Visual,{children:(0,i.jsx)(R.AlertIcon,{size:24,className:"fgColor-muted mt-3 mb-3"})}),(0,i.jsx)(ey.E.Heading,{children:(0,i.jsx)("strong",{children:"Comments cannot be loaded right now"})}),(0,i.jsx)("div",{className:"mb-n2",children:(0,i.jsx)(ey.E.Description,{children:"Refresh the page or try again later"})}),(0,i.jsx)(ey.E.SecondaryAction,{href:"https://www.githubstatus.com/",children:"GitHub status"})]})})}function eD({commentingImplementation:e,fileAnchor:t,filePath:n,threadId:r,isOutdated:a,threads:s,threadsConnectionId:o,isFirstThread:c,enterDialogMode:u,ghostUser:f,manuallyUpdateCommentsWithThisThreadId:m,suggestedChangesConfig:h,...p}){let[g,x]=(0,l.useState)(void 0),{fetchThread:b,shouldRefetchThread:y}=e,C=(0,l.useRef)(null),{isInDialogMode:v}=(0,Y.q)(),N=(0,ef.A)("localStorage"),j=g?.isResolved,[w,L]=(0,l.useState)(""),[k,S]=(0,l.useState)(j??!1);(0,l.useEffect)(()=>{let e=localStorage.getItem(`reviewThreadIsCollapsed_${r}`);null!==e?S(JSON.parse(e)):j&&S(!0)},[j,r]);let D=(0,l.useCallback)(async(e,t=!0)=>{x(await b(e,t))},[b]);(0,l.useEffect)(()=>{D(r,!1)},[D,m,r]),(0,l.useEffect)(()=>{v&&(v||!g)?ea(C.current):el(C.current)},[v,g]),(0,l.useEffect)(()=>{g||D(r,!1)},[r,g,b,D]);let I=(0,l.useMemo)(()=>{if(t&&g&&g.subject?.startDiffSide&&g.subject?.endDiffSide&&g.subject?.startLine&&g.subject?.endLine&&h?.configureSuggestedChangesFromLineRange){let e=g.subject?.startLine??g?.subject?.endLine,n=g.subject?.startDiffSide??g?.subject?.endDiffSide,i={diffAnchor:t,endLineNumber:g?.subject?.endLine,endOrientation:g.subject?.endDiffSide==="LEFT"?"left":"right",startLineNumber:e,firstSelectedLineNumber:e,firstSelectedOrientation:"LEFT"===n?"left":"right",startOrientation:"LEFT"===n?"left":"right"};return h?.configureSuggestedChangesFromLineRange(i)}},[t,g,h]);(0,l.useEffect)(()=>{g&&y?.(g)&&D(r,!0)},[D,y,g,r,s]);let{sendAnalyticsEvent:E}=(0,em.s)(),{resolveThread:_,unresolveThread:A,resolvingEnabled:T}=e,O=s.find(e=>e.id===r);if(!g||!(g.commentsData.comments.length>0))return null;let M=!!g.isResolved,$=O?.commentsConnectionId,P=T&&g.commentsData.comments.some(e=>e.state?.toUpperCase()!=="PENDING");return(0,i.jsx)(eu.t,{fallback:(0,i.jsx)(eS,{}),children:(0,i.jsxs)("div",{className:"rounded-2 bgColor-default",ref:C,children:[(0,i.jsxs)(ep.A,{sx:{display:"flex",flexDirection:"row",width:"100%",alignItems:"center",borderBottom:"1px solid",borderColor:"border.muted"},className:"px-1",children:[(0,i.jsx)(Z.K,{"aria-label":k?"Expand comment":"Collapse comment",icon:k?R.ChevronRightIcon:R.ChevronDownIcon,size:"small",variant:"invisible",onClick:()=>{window.requestAnimationFrame(()=>{N.setItem(`reviewThreadIsCollapsed_${r}`,JSON.stringify(!k))}),S(e=>!e)},"data-is-first-collapse-button":c}),(0,i.jsx)(ew,{thread:O}),(0,i.jsxs)(ep.A,{sx:{display:"flex",flexDirection:"row",gap:1,alignItems:"center",justifyContent:"right",flexGrow:1},children:[M&&(0,i.jsx)(eg.A,{variant:"secondary",children:"Resolved"}),P&&(0,i.jsx)(eC.m,{text:M?"Unresolve conversation":"Resolve conversation",type:"label",direction:"w",id:"resolve-conversation",children:(0,i.jsx)(Z.K,{"aria-labelledby":"resolve-conversation",icon:M?R.CheckCircleFillIcon:R.CheckCircleIcon,sx:{color:M?"var(--fgColor-done, var(--color-done-fg)) !important":void 0},variant:"invisible",onClick:M?()=>{g&&(A({threadId:g.id,onCompleted:()=>{y||D(g.id),S(!1),N.removeItem(`reviewThreadIsCollapsed_${r}`)},onError:()=>{L("Failed to unresolve thread")}}),E("comments.unresolve_thread","RESOLVE_CONVERSATION_BUTTON"))}:()=>{g&&(_({threadId:g.id,onCompleted:()=>{y||D(g.id),S(!0),N.removeItem(`reviewThreadIsCollapsed_${r}`)},onError:()=>{L("Failed to resolve thread")}}),E("comments.resolve_thread","RESOLVE_CONVERSATION_BUTTON"))}})})]})]}),(0,i.jsxs)(l.Suspense,{fallback:(0,i.jsxs)(ep.A,{sx:{height:"90px",alignItems:"center",display:"flex",flexDirection:"column",justifyContent:"center",color:"fg.muted",fontSize:0},children:[(0,i.jsx)(d.A,{}),(0,i.jsx)("p",{children:"Loading comments"})]}),children:[w&&(0,i.jsxs)(ex.A,{variant:"danger",className:"m-2",children:[(0,i.jsx)(eb.A,{icon:R.StopIcon,className:"mr-2"}),w]}),!k&&(0,i.jsx)(eN.H,{enterDialogMode:u,commentingImplementation:e,commentsConnectionId:$,filePath:n,onRefreshThread:D,thread:g,threadsConnectionId:o,suggestedChangesConfig:I,shouldLimitHeight:!1,...p,ghostUser:f})]})]})})}try{ej.displayName||(ej.displayName="Emphasis")}catch{}try{ew.displayName||(ew.displayName="ThreadBanner")}catch{}try{eL.displayName||(eL.displayName="SingleLineThreadBanner")}catch{}try{ek.displayName||(ek.displayName="MultineLineThreadBanner")}catch{}try{eS.displayName||(eS.displayName="CommentErrorFallback")}catch{}try{eD.displayName||(eD.displayName="InlineReviewThread")}catch{}let eI={[ei.U.Failure]:0,[ei.U.Warning]:1,[ei.U.Notice]:2};function eE(e){return(0,i.jsx)(ee.j,{children:(0,i.jsx)(eR,{...e})})}function eR({annotations:e,children:t,commentingImplementation:n,conversationListThreads:r,inlineMarkersRef:a,isMarkerListOpen:s,isRowSelected:o,fileAnchor:d,filePath:c,lineType:u,onAnnotationSelected:f,onCloseConversationDialog:m,onCloseConversationList:h,onCloseFocusMode:p,onThreadSelected:g,returnFocusRef:x,selectedAnnotationId:y,selectedThreadId:C,threadsConnectionId:v,suggestedChangesConfig:N,manuallyUpdateCommentsWithThisThreadId:j,ghostUser:w,enterDialogMode:L,...k}){let S=(0,l.useCallback)(async e=>{let t=await n.fetchThread(e,!1);t&&r.push(t),E({})},[n,r]),[I,E]=(0,l.useState)({});(0,l.useEffect)(()=>{0===r.length&&j&&""!==j&&S(j)},[n,r.length,S,j]);let{isInDialogMode:_,enableInlineCommentDialogMode:A}=(0,Y.q)(),T=(0,l.useRef)(null),O=(0,l.useMemo)(()=>[...e].sort((e,t)=>eI[e.annotationLevel]-eI[t.annotationLevel]),[e]),M=(0,l.useMemo)(()=>t?[...r,{id:"new-comment"},...O]:[...r,...O],[t,r,O]);return!function({containerRef:e,markers:t,disabled:n=!1,selectedMarkerId:i}){let r=(0,l.useRef)(void 0),a=(0,l.useMemo)(()=>new MarkerNavigator(t,r.current?.focusedMarker?.id||i||void 0),[t,i]);(0,l.useEffect)(()=>{r.current=a},[a]);let s=(0,l.useCallback)((e,t,n)=>{let i=n.key;switch(!0){case"ArrowUp"===i||"ArrowDown"===i:if(t?.hasAttribute("data-marker-id")){let e=a.moveToNextMarker(i,t);if(e)return document.querySelector(`[data-marker-id="${e.id}"]`)||void 0;return t}if(t?.hasAttribute("data-marker-navigation-comment-id")){let e=a.moveToNextMarkerItem(i,t);if(e)return document.querySelector(`[data-marker-navigation-comment-id="${e.id}"]`)||void 0}return t;case"ArrowRight"===i:if(t?.hasAttribute("data-marker-navigation-comment-id"))return t;if(t?.hasAttribute("data-marker-id"))return t?.querySelector('[data-first-thread-comment="true"]')||void 0;return t;case"ArrowLeft"===i:if(t?.hasAttribute("data-marker-id"))return t;if(t?.hasAttribute("data-marker-navigation-comment-id"))return t?.closest("[data-marker-id]")||void 0;return t;default:return t??void 0}},[a]);(0,H.G)({containerRef:e,bindKeys:et,getNextFocusable:s,focusableElementFilter:e=>e.hasAttribute("data-marker-id")||e.hasAttribute("data-marker-navigation-comment-id"),focusInStrategy:"previous",disabled:n},[s,n])}({containerRef:T,markers:M,disabled:!_,selectedMarkerId:C}),(0,i.jsxs)("div",{className:(0,D.$)("d-flex pt-1",_?ec.markersDialogActive:ec.markersDialogInactive),style:_?{backgroundColor:(0,b.Yf)(u,!0,o)}:{},onClick:()=>{_||A()},"data-inline-markers":!0,ref:a,children:[(0,i.jsxs)("div",{className:ec.markersWrapper,ref:T,children:[r.map((e,t)=>(0,i.jsx)("div",{className:(0,D.$)("mt-1 border rounded-2 color-border-default color-shadow-small",t===M.length-1?"mb-1":"mb-2"),"data-first-marker":0===t,"data-marker-id":`${e.id}`,tabIndex:_?0:-1,children:(0,i.jsx)(eD,{manuallyUpdateCommentsWithThisThreadId:j,enterDialogMode:L,isFirstThread:0===t,commentingImplementation:n,filePath:c,fileAnchor:d,threadId:e.id,isOutdated:e.isOutdated,threads:r,threadsConnectionId:v,onThreadSelected:g,suggestedChangesConfig:N,ghostUser:w,...k})},`review-thread-${e.id}`)),t,O.map((e,t)=>{let n=0===t&&e===M[0];return(0,i.jsx)(ed,{annotation:e,isFirstMarker:n},`annotation-${e.id}`)})]}),_&&(0,i.jsx)(Z.K,{icon:R.XIcon,className:(0,D.$)(ec.closeMarkersDialogButton,"ml-2 position-relative",0===r.length?"mt-2":"mt-1"),"aria-label":"Return to code","data-exit-dialog-mode-button":"true",variant:"default",size:"small",onMouseUp:p,onKeyDown:e=>{("Enter"===e.key||"Space"===e.code)&&p()}})]})}try{eE.displayName||(eE.displayName="InlineMarkers")}catch{}try{eR.displayName||(eR.displayName="InlineMarkersInternal")}catch{}var e_=n(84100),eA=n(86617),eT=n(89323),eO=n(15385),eM=n(76797);function e$({fileAnchor:e}){let{isSplit:t,isLeftSide:n,diffLine:i}=F(),{selectedDiffRowRange:r}=L(),{getDiffSingleLineCode:a,getUnifiedDiffMultiLineCode:s,getSplitDiffMultiLineCode:o}=function(e,t){let{selectedDiffLines:n,getDiffLinesByDiffAnchor:i}=L();return{getUnifiedDiffMultiLineCode:()=>{let n=i(e);if(!n||!t)return"";let{startOrientation:r,endOrientation:l,startLineNumber:a,endLineNumber:s}=t,o=0,d=0;return n.length>1&&(o=n.findIndex(e=>"left"===r?e.left===a:e.right===a),d=n.findIndex(e=>"left"===l?e.left===s:e.right===s)),(0,b.Ls)(n.slice(o,d+1))},getDiffSingleLineCode:(t,n)=>{if(!t||!n)return"";let r=i(e)?.find(e=>"left"===t?e.left===n:e.right===n);return r?(0,b.Ls)([r]):""},getSplitDiffMultiLineCode:e=>void 0===e?"":"left"===e?(0,b.Ls)(n.leftLines):(0,b.Ls)(n.rightLines)}}(e,r);return(0,l.useCallback)(async()=>{let e=window.getSelection();if(e&&""!==e.toString()){document.execCommand("copy");return}if(void 0===r||r?.startOrientation===r?.endOrientation&&r?.startLineNumber===r?.endLineNumber){await (0,eM.D)(a(n?"left":"right",n?i?.left:i?.right));return}if(t){await (0,eM.D)(o(n?"left":"right"));return}await (0,eM.D)(s())},[r,t,s,a,n,i?.left,i?.right,o])}let eP=(0,l.createContext)(null);function eF({children:e,...t}){let n=!!t.commentingImplementation,r=!!t.markerNavigationImplementation;if(t.commentingEnabled!==n&&t.commentingEnabled!==r)throw Error("commentingEnabled, commentingImplementation, and markerNavigationImplementation must be passed together");let a=t?.ghostUser??K.ghostUser,s=(0,l.useMemo)(()=>({ghostUser:a,...t}),[...Object.values(t),a]);return(0,i.jsx)(eP.Provider,{value:s,children:e})}function eU(){let e=(0,l.useContext)(eP);if(!e)throw Error("useDiffContext must be used within a DiffContextProvider");return e}try{eP.displayName||(eP.displayName="DiffContext")}catch{}try{eF.displayName||(eF.displayName="DiffContextProvider")}catch{}var eH=n(57259);function eB(e){return null!=e}let ez="thread",eG="annotation",eV=(0,l.createContext)(null);function eW({children:e,line:t}){let[n,r]=(0,l.useState)(!1),[a,s]=(0,l.useState)(),[o,d]=(0,l.useState)(),[c,u]=(0,l.useState)(),[f,m]=(0,l.useState)(),[h,p]=(0,l.useState)(),{ghostUser:g,markerNavigationImplementation:x}=eU(),{originalLineThreads:b,modifiedLineThreads:y}=F(),[C,v]=(0,l.useState)(),N=eq({line:t,side:C,originalLineThreads:b,modifiedLineThreads:y,ghostUser:g}),j=(0,l.useMemo)(()=>!!a||!!o||!!c||!!f,[a,c,o,f]),w=(0,l.useCallback)(()=>{r(!0)},[]),L=(0,l.useCallback)(()=>{r(!1)},[]),k=(0,l.useCallback)(e=>{e?p({id:e,kind:ez}):p(void 0)},[]),S=h?.kind===ez?h.id:void 0,D=h?.kind===eG?h.id:void 0,I=(0,l.useCallback)(e=>{e?p({id:e,kind:eG}):p(void 0)},[]),E=(0,l.useCallback)((e,t,n)=>{switch((0,eH.e)(x?.overlayPortalContainerName),e){case"context-menu":s(t),m(void 0),u(void 0),d(void 0);break;case"new-conversation":m({cellId:t,withSuggestedChange:n?.withSuggestedChange}),s(void 0),u(void 0),d(void 0);break;case"marker-details":u(t),s(void 0),d(void 0),m(void 0);break;case"marker-list":d(t),s(void 0),m(void 0),u(void 0)}},[x?.overlayPortalContainerName]),R=(0,l.useCallback)(e=>{switch(e){case"context-menu":s(void 0);break;case"new-conversation":m(void 0);break;case"marker-details":u(void 0);break;case"marker-list":d(void 0)}},[]),_=(0,l.useCallback)(e=>(v(e),eq({line:t,side:e,modifiedLineThreads:y,originalLineThreads:b,ghostUser:g})),[t,y,b,g]),A=(0,l.useMemo)(()=>t.annotationsData?.annotations?.filter(eB)??[],[t.annotationsData?.annotations]),T=(0,l.useMemo)(()=>({annotations:A,isActionBarVisible:n,showActionBar:w,hideActionBar:L,selectThreadId:k,selectAnnotationId:I,closeDialog:R,openDialog:E,anyMenuOpen:j,selectedThreadId:S,selectedAnnotationId:D,openContextMenuCell:a,openMarkersListCell:o,openMarkerDetailsCell:c,openNewConversationCell:f,threads:N,updateVisibleThreads:_}),[A,n,w,L,k,I,R,E,j,S,D,a,o,c,f,N,_]);return(0,i.jsx)(eV.Provider,{value:T,children:e})}function eK(){let e=(0,l.useContext)(eV);if(!e)throw Error("useMarkersDialogContext must be used within a MarkersDialogContextProvider");return e}function eq({line:e,side:t,originalLineThreads:n,modifiedLineThreads:i,ghostUser:r}){switch(t){case"LEFT":return n||[];case"RIGHT":return i||[];case void 0:return U(e.threadsData,r);default:return[]}}try{eV.displayName||(eV.displayName="MarkersDialogContext")}catch{}try{eW.displayName||(eW.displayName="MarkersDialogContextProvider")}catch{}var eX=n(46584);function eJ(){let{diff_inline_comments:e,prx_files:t}=(0,eX.h)();return e||t}function eY({cellId:e,actionBarRef:t,toggleViewingMarkers:n,onOpenInLineThread:i}){let{replaceSelectedDiffRowRange:r}=L(),{fileAnchor:a}=F(),s=eJ(),[o,d]=(0,l.useState)(t),{annotations:c,openDialog:u,closeDialog:f,selectedAnnotationId:m,selectAnnotationId:h,selectedThreadId:p,selectThreadId:g,openContextMenuCell:x,openNewConversationCell:b,openMarkerDetailsCell:y,openMarkersListCell:C,updateVisibleThreads:v,threads:j,anyMenuOpen:w}=eK(),{sendAnalyticsEvent:k}=(0,em.s)(),S=(0,l.useMemo)(()=>b?.cellId===e,[e,b]),D=(0,l.useMemo)(()=>b?.withSuggestedChange,[b]),I=(0,l.useCallback)(t=>{s&&i?.(),u("new-conversation",e,t)},[e,s,i,u]),E=(0,l.useCallback)(()=>{I()},[I]),R=(0,l.useCallback)(()=>{d(t),I(),k("diff.start_new_conversation","PLUS_ICON")},[t,I,k]),_=(0,l.useCallback)(()=>{I({withSuggestedChange:!0}),k("diff.start_new_conversation_with_suggested_change","CELL_CONTEXT_MENU")},[I,k]),A=(0,l.useCallback)(()=>{d(t),I({withSuggestedChange:!0}),k("diff.start_new_conversation_with_suggested_change","ACTION_BAR_CONTEXT_MENU")},[t,I,k]),T=(0,l.useCallback)(()=>{f("new-conversation")},[f]),O=(0,l.useMemo)(()=>x===e,[e,x]),M=(0,l.useCallback)(()=>{u("context-menu",e)},[e,u]),$=(0,l.useCallback)(()=>{d(t),M()},[t,M]),P=(0,l.useCallback)(()=>{f("context-menu")},[f]),U=(0,l.useCallback)(()=>{O?P():M()},[P,O,M]),H=(0,l.useCallback)(()=>{d(t),U()},[t,U]),B=(0,l.useMemo)(()=>y===e?p:void 0,[e,y,p]),z=(0,l.useMemo)(()=>y===e?m:void 0,[e,y,m]),G=(0,l.useCallback)(()=>{s?i?.():u("marker-details",e)},[e,s,i,u]),V=(0,l.useCallback)(()=>{f("marker-details")},[f]),W=N((e,t={skipLineSelection:!1})=>{if(g(e),G(),t.skipLineSelection)return;let n=j.find(t=>t.id===e);if(n&&n.diffSide&&n.line){let e=n.startLine??n.line,t=n.startDiffSide??n.diffSide;r({diffAnchor:a,endLineNumber:n.line,endOrientation:"LEFT"===n.diffSide?"left":"right",startLineNumber:e,startOrientation:"LEFT"===t?"left":"right",firstSelectedLineNumber:e,firstSelectedOrientation:"LEFT"===t?"left":"right"})}}),K=N((e,t={skipLineSelection:!1})=>{if(h(e),G(),t.skipLineSelection)return;let n=c.find(t=>t.id===e);n&&r({diffAnchor:a,endLineNumber:n.endLine,endOrientation:"right",startLineNumber:n.startLine,startOrientation:"right",firstSelectedLineNumber:n.startLine,firstSelectedOrientation:"right"})}),q=(0,l.useCallback)(()=>{u("marker-list",e)},[e,u]),X=(0,l.useCallback)(()=>{f("marker-list")},[f]),J=(0,l.useCallback)(e=>{if(s){n?.();return}let t=v(e);if(!t?.length&&!c.length)return;let i=t&&t[0],r=t&&1===t.length&&i&&!c.length,l=c[0],a=1===c.length&&l&&!t?.length;r?W(i.id):a?K(l.id):q()},[c,s,q,K,W,n,v]);return{isNewConversationDialogOpen:S,startNewConversation:E,startNewConversationFromActionBar:R,closeNewConversationDialog:T,startNewConversationWithSuggestedChange:_,startNewConversationFromActionBarWithSuggestedChange:A,shouldStartNewConversationWithSuggestedChange:D,isContextMenuOpen:O,openContextMenu:M,openContextMenuFromActionBar:$,closeContextMenu:P,toggleContextMenu:U,toggleContextMenuFromActionBar:H,optimizedSelectedThreadId:B,optimizedSelectedAnnotationId:z,selectThread:W,selectAnnotation:K,openMarkerDetailsDialog:G,closeConversationDetailsDialog:V,isMarkerListDialogOpen:C===e,openMarkerListDialog:q,closeMarkerListDialog:X,openMarkerOrListDialogFromActionBar:(0,l.useCallback)(e=>{J(e),d(t)},[t,J]),openMarkerOrListDialog:(0,l.useCallback)(e=>{J(e)},[J]),annotations:c,returnFocusRef:o,threads:j,anyMenuOpen:w}}function eQ({cellRef:e}){let{showActionBar:t,hideActionBar:n,anyMenuOpen:i}=eK(),[r,a]=(0,l.useState)(!1),s=(0,l.useCallback)(()=>{t()},[t]),o=(0,l.useCallback)(t=>{!i&&(e.current&&e.current.contains(t.relatedTarget)||n())},[i,e,n]),d=(0,l.useCallback)(()=>{t()},[t]),c=(0,l.useCallback)(()=>{!i&&(e.current===document.activeElement||e.current?.contains(document.activeElement)||n())},[i,e,n]);return{isActionBarFocused:r,handleCellBlur:o,handleCellFocus:s,handleCellMouseEnter:d,handleCellMouseLeave:c,handleActionBarBlur:(0,l.useCallback)(t=>{e.current&&!i&&(e.current.contains(t.relatedTarget)?e.current===t.relatedTarget&&a(!1):(n(),a(!1)))},[i,e,n]),handleActionBarFocusCapture:(0,l.useCallback)(()=>{i||a(!0)},[i]),handleActionBarKeydownCapture:(0,l.useCallback)(e=>{!i&&q(e.key)&&e.stopPropagation()},[i])}}n(70283);var eZ=n(64515),e0=n(91321),e1=n(62456),e2=n(46008),e4=n(82126);let e3={commentIndicatorContainer:"CommentIndicator-module__commentIndicatorContainer--L8lU3",AvatarStack:"CommentIndicator-module__AvatarStack--jMN2F",Compact:"CommentIndicator-module__Compact--SQwGN",Relaxed:"CommentIndicator-module__Relaxed--DWkA5",textStyles:"CommentIndicator-module__textStyles--ahQJa"},e6={compact:{avatarSize:18},relaxed:{avatarSize:20}};function e8({shouldAnimateRef:e,lineSpacingPreference:t="relaxed"}){let{diffLine:n}=F(),{ghostUser:r}=eU();(0,l.useEffect)(()=>{e?.current&&(e.current=!1)},[e]);let{avatarSize:a}=e6[t],s=(n.threadsData?.totalCommentsCount||0)+(n.annotationsData?.totalCount||0);if(0===s)return null;let o={},d=[];n.annotationsData?.annotations?.map(e=>{e?.annotationLevel&&d.push({id:e.id,level:e.annotationLevel})}),n.threadsData?.threads?.map(e=>e?.commentsData?.comments?.map(e=>{e?.author?o[e?.author.login]=e.author:r?.login&&(o[r.login]=r)}));let c=[...d.sort((e,t)=>(e4.GF[e.level]?.priority||0)<(e4.GF[t.level]?.priority||0)?-1:1).map(t=>e?.current?(0,i.jsx)(e4.S,{annotationLevel:t.level},t.id):(0,i.jsx)(e4.Xh,{annotationLevel:t.level},t.id)),...Object.keys(o).map(e=>{let t=o[e]?.login,n=o[e]?.avatarUrl??(r?.avatarUrl||" ");return(0,i.jsx)(e1.r,{alt:t,size:20,src:n},t)})].slice(0,3),u=s>9?"9+":`${s}`;return(0,i.jsxs)("div",{className:(0,D.$)("d-flex","flex-justify-between","flex-items-center",e3.commentIndicatorContainer),children:[(0,i.jsx)(e2.A,{disableExpand:!0,size:a,className:(0,D.$)(e3.AvatarStack,"relaxed"===t?e3.Relaxed:e3.Compact),children:c}),(0,i.jsx)("span",{className:(0,D.$)("fgColor-default","ml-1",e3.textStyles),children:u})]})}try{e8.displayName||(e8.displayName="CommentIndicator")}catch{}var e5=n(35149),e7=n(39298),e9=n(5993);let te=({fileDiffReference:e,selectedRange:t,showDivider:n})=>{let r=(0,l.useMemo)(()=>{let n={...e};return t&&(n.selectedRange={start:`${t?.startOrientation[0]?.toUpperCase()??""}${t?.startLineNumber}`,end:`${t?.endOrientation[0]?.toUpperCase()??""}${t?.endLineNumber}`}),n},[e,t]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(eT.W,{children:[(0,i.jsx)(eT.W.Anchor,{children:(0,i.jsxs)(eO.l.Item,{children:[(0,i.jsx)(eO.l.LeadingVisual,{children:(0,i.jsx)(R.CopilotIcon,{})}),"Copilot"]})}),(0,i.jsx)(eT.W.Overlay,{children:(0,i.jsxs)(eO.l,{children:[(0,i.jsx)(e7.t,{fileDiffReference:r,eventContext:{prx:!0}}),(0,i.jsx)(e9.e,{fileDiffReference:r,eventContext:{prx:!0}}),(0,i.jsx)(e5.i,{fileDiffReference:r,eventContext:{prx:!0}})]})})]}),n&&(0,i.jsx)(eO.l.Divider,{})]})};try{te.displayName||(te.displayName="CopilotDiffChatContextMenu")}catch{}function tt(){let{nextHunk:e,currentHunk:t,previousHunk:n}=F(),{addInjectedContextLines:i}=eU(),r=!!t&&0!==t.startBlobLineNumber,l=!!t&&!!e;return{expandStartOfHunk:()=>{r&&t&&i({start:Math.max(0,t.startBlobLineNumber-20),end:t.startBlobLineNumber})},expandEndOfHunk:()=>{l&&t&&i({start:t.endBlobLineNumber+1,end:t.endBlobLineNumber+1+20})},expandEndOfPreviousHunk:()=>{n&&i({start:n.endBlobLineNumber+1,end:n.endBlobLineNumber+1+20})},canExpandEndOfHunk:l,canExpandStartOfHunk:r}}var tn=n(96339);let ti={left:"L",right:"R"},tr="Add comment",tl="Suggest change";function ta(e,t,n){let i=n&&!(0,b.Ji)(t)?ti.left:ti.right;return`${e} on line ${i}${t.blobLineNumber}`}function ts({handleStartConversationWithSuggestedChange:e,handleStartConversation:t}){let n,r,a;let{selectedDiffRowRange:s,selectedDiffLines:o,replaceSelectedDiffRowRange:d}=L(),{commentingEnabled:c}=eU(),{diffLine:u,isLeftSide:f,isSplit:m,diffContext:h}=F(),p=(0,l.useMemo)(()=>o.leftLines[0],[o.leftLines]),g=(0,l.useMemo)(()=>o.leftLines[o.leftLines.length-1],[o.leftLines]),x=(0,l.useMemo)(()=>o.leftLines.every(e=>!(0,b.Po)(e)&&"DELETION"!==e.type),[o.leftLines]),y=(0,l.useMemo)(()=>o.rightLines[0],[o.rightLines]),C=(0,l.useMemo)(()=>o.rightLines[o.rightLines.length-1],[o.rightLines]),v=(0,l.useMemo)(()=>0===o.rightLines.length,[o.rightLines]),N=(0,l.useMemo)(()=>0===o.leftLines.length,[o.leftLines]),j=(0,l.useMemo)(()=>!(o.leftLines.find(e=>!(0,b.Po)(e)&&!(0,b.Ji)(e)&&"INJECTED_CONTEXT"!==e.type)||o.rightLines.find(e=>!(0,b.Po)(e)&&!(0,b.Ji)(e)&&"INJECTED_CONTEXT"!==e.type)),[o.leftLines,o.rightLines]),w=(0,l.useCallback)((n,i)=>{!(!s||!g||!p||(0,b.Po)(g)||(0,b.Po)(p))&&p.left&&g.left&&(d({diffAnchor:s.diffAnchor,endLineNumber:g.left,endOrientation:"left",startLineNumber:p.left,startOrientation:"left",firstSelectedLineNumber:p.left,firstSelectedOrientation:"left"}),i?.withSuggestedChange?e():t())},[s,g,p,d,e,t]),k=(0,l.useCallback)((n,i)=>{!(!s||!C||!y||(0,b.Po)(C)||(0,b.Po)(y))&&y.right&&C.right&&(d({diffAnchor:s.diffAnchor,endLineNumber:C.right,endOrientation:"right",startLineNumber:y.right,startOrientation:"right",firstSelectedLineNumber:y.right,firstSelectedOrientation:"right"}),i?.withSuggestedChange?e():t())},[s,C,y,d,e,t]),S="DELETION"!==u.type&&("pr"===h||void 0===h),D=(0,l.useMemo)(()=>!!s&&(s.startOrientation!==s.endOrientation||s.startLineNumber!==s.endLineNumber),[s]);if(!c)return null;let I=!1,E=!1;if(s&&D){let l=ti[s.startOrientation],o=ti[s.endOrientation];return a=` on lines ${l}${s.startLineNumber}-${o}${s.endLineNumber}`,!(0,b.Po)(p)&&!(0,b.Po)(g)&&p&&g&&(I=!0,n=p.left===g.left?v?` on line L${p.left}`:`, original line L${p.left}`:v?` on lines L${p.left}-L${g.right}`:`, original lines L${p.left}-L${g.left}`),!(0,b.Po)(y)&&!(0,b.Po)(C)&&y&&C&&(E=!0,r=y.right===C.right?N||m&&j?` on line R${y.right}`:`, modified line R${C.right}`:N||m&&j?` on lines R${y.right}-R${C.right}`:`, modified lines R${y.right}-R${C.right}`),(0,i.jsx)(i.Fragment,{children:m?(0,i.jsx)(i.Fragment,{children:j?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(eO.l.Item,{onSelect:k,children:[(0,i.jsx)(eO.l.LeadingVisual,{children:(0,i.jsx)(R.PlusIcon,{})}),tr+r,(0,i.jsx)(eO.l.TrailingVisual,{children:(0,i.jsx)(tn.U,{keys:"Alt+n"})})]}),(0,i.jsxs)(eO.l.Item,{onSelect:e=>k(e,{withSuggestedChange:!0}),children:[(0,i.jsx)(eO.l.LeadingVisual,{children:(0,i.jsx)(R.PlusCircleIcon,{})}),tl+r]})]}):(0,i.jsxs)(i.Fragment,{children:[I?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(eO.l.Item,{onSelect:w,children:[(0,i.jsx)(eO.l.LeadingVisual,{children:(0,i.jsx)(R.PlusIcon,{})}),tr+n,(0,i.jsx)(eO.l.TrailingVisual,{children:(0,i.jsx)(tn.U,{keys:v?"Alt+n":"Alt+Shift+N"})})]}),x&&(0,i.jsxs)(eO.l.Item,{onSelect:e=>w(e,{withSuggestedChange:!0}),children:[(0,i.jsx)(eO.l.LeadingVisual,{children:(0,i.jsx)(R.PlusCircleIcon,{})}),tl+n]})]}):null,E?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(eO.l.Item,{onSelect:k,children:[(0,i.jsx)(eO.l.LeadingVisual,{children:(0,i.jsx)(R.PlusIcon,{})}),tr+r,(0,i.jsx)(eO.l.TrailingVisual,{children:(0,i.jsx)(tn.U,{keys:"Alt+n"})})]}),(0,i.jsxs)(eO.l.Item,{onSelect:e=>k(e,{withSuggestedChange:!0}),children:[(0,i.jsx)(eO.l.LeadingVisual,{children:(0,i.jsx)(R.PlusCircleIcon,{})}),tl+r]})]}):null]})}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(eO.l.Item,{onSelect:t,children:[(0,i.jsx)(eO.l.LeadingVisual,{children:(0,i.jsx)(R.PlusIcon,{})}),tr+a]}),S&&x&&(0,i.jsxs)(eO.l.Item,{onSelect:e,children:[(0,i.jsx)(eO.l.LeadingVisual,{children:(0,i.jsx)(R.PlusCircleIcon,{})}),tl+a]})]})})}return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(eO.l.Item,{onSelect:t,children:[(0,i.jsx)(eO.l.LeadingVisual,{children:(0,i.jsx)(R.PlusIcon,{})}),ta(tr,u,f)]}),S&&(0,i.jsxs)(eO.l.Item,{onSelect:e,children:[(0,i.jsx)(eO.l.LeadingVisual,{children:(0,i.jsx)(R.PlusCircleIcon,{})}),ta(tl,u,f)]})]})}try{ts.displayName||(ts.displayName="StartConversationContextMenuItems")}catch{}function to(e){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(tm,{...e}),(0,i.jsx)(tu,{fileDiffReference:e.copilotChatReference}),(0,i.jsx)(tb,{handleCopyCode:e.handleCopyCode}),(0,i.jsx)(tf,{}),(0,i.jsx)(td,{}),(0,i.jsx)(ty,{})]})}function td(){let{diffLine:e,fileAnchor:t}=F(),{selectedDiffRowRange:n}=L(),r=(0,l.useCallback)(()=>{let i=(0,b.j2)({line:e,range:n,fileAnchor:t});i&&(0,eM.D)(i)},[t,e,n]);return(0,i.jsxs)(eO.l.Item,{onSelect:r,onMouseDown:e=>{window.getSelection()?.toString()!==""&&e.preventDefault()},children:[(0,i.jsx)(eO.l.LeadingVisual,{children:(0,i.jsx)(R.LinkIcon,{})}),"Copy link",(0,i.jsx)(eO.l.TrailingVisual,{children:(0,i.jsx)(tn.U,{keys:"Mod+Alt+y"})})]})}function tc(){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(tC,{}),(0,i.jsx)(tf,{})]})}let tu=e=>{let{selectedDiffRowRange:t}=L(),{diffLine:n,isLeftSide:r,fileAnchor:l}=F(),a=(0,b.Av)(t,n,r,l);return e.fileDiffReference?(0,i.jsx)(te,{showDivider:!0,selectedRange:a,fileDiffReference:e.fileDiffReference}):null};function tf(){let{fileAnchor:e}=F();return(0,i.jsxs)(eO.l.Item,{onSelect:()=>{setTimeout(()=>{document.querySelector(`table[data-diff-anchor="${e}"]`)?.dispatchEvent(new KeyboardEvent("keydown",{key:"a",code:"KeyA",ctrlKey:!0}))})},children:[(0,i.jsx)(eO.l.LeadingVisual,{children:(0,i.jsx)(R.MultiSelectIcon,{})}),"Select all",(0,i.jsx)(eO.l.TrailingVisual,{children:(0,i.jsx)(tn.U,{keys:"Mod+a"})})]})}function tm({handleViewMarkersSelection:e,shouldDisplayCollapseComments:t,showStartConversation:n,startConversationCurrentLine:r,startConversationWithSuggestedChange:l}){let{commentingEnabled:a}=eU(),{originalLineHasThreads:s,modifiedLineHasThreads:o}=F(),{annotations:d}=eK(),c=d.length>0;return a&&(n||s||o||c)?(0,i.jsxs)(i.Fragment,{children:[n&&(0,i.jsx)(ts,{handleStartConversation:r,handleStartConversationWithSuggestedChange:l}),(0,i.jsx)(th,{handleViewMarkersSelection:e,shouldDisplayCollapseComments:t}),(0,i.jsx)(eO.l.Divider,{})]}):null}function th({handleViewMarkersSelection:e,shouldDisplayCollapseComments:t}){let n=eJ(),{data:r}=(0,eA.Pe)(),{commentingEnabled:l}=eU(),{isSplit:a}=F();return r&&l&&(!n||r.commentsPreference!==eA.sI.Visible)?a?(0,i.jsx)(tp,{handleViewMarkersSelection:e,shouldDisplayCollapseComments:t}):(0,i.jsx)(tg,{onSelect:()=>e(),shouldDisplayCollapseComments:t}):null}function tp({handleViewMarkersSelection:e,shouldDisplayCollapseComments:t}){let{originalLineHasThreads:n,modifiedLineHasThreads:r,isLeftSide:l}=F(),{annotations:a}=eK(),s=a.length>0;return l?(0,i.jsxs)(i.Fragment,{children:[n&&(0,i.jsx)(tx,{text:t?"Collapse comments":"Expand comments",onSelect:()=>e("LEFT")}),(r||s)&&(0,i.jsx)(tx,{text:t?"Collapse comments, modified line":"Expand comments, modified line",onSelect:()=>e("RIGHT")})]}):(0,i.jsxs)(i.Fragment,{children:[(r||s)&&(0,i.jsx)(tx,{text:t?"Collapse comments":"Expand comments",onSelect:()=>e("RIGHT")}),n&&(0,i.jsx)(tx,{text:t?"Collapse comments, original line":"Expand comments, original line",onSelect:()=>e("LEFT")})]})}function tg({onSelect:e,shouldDisplayCollapseComments:t}){let{ghostUser:n}=eU(),{diffLine:r}=F(),{annotations:l}=eK();return r&&U(r.threadsData,n).length>0||l.length>0?(0,i.jsx)(tx,{text:t?"Collapse comments":"Expand comments",onSelect:()=>e()}):null}function tx({onSelect:e,text:t}){return(0,i.jsxs)(eO.l.Item,{onSelect:e,children:[(0,i.jsx)(eO.l.LeadingVisual,{children:(0,i.jsx)(R.CommentDiscussionIcon,{})}),t]})}function tb({handleCopyCode:e}){return(0,i.jsxs)(eO.l.Item,{onSelect:e,onMouseDown:e=>{window.getSelection()?.toString()!==""&&e.preventDefault()},children:[(0,i.jsx)(eO.l.LeadingVisual,{children:(0,i.jsx)(R.CopyIcon,{})}),"Copy",(0,i.jsx)(eO.l.TrailingVisual,{children:(0,i.jsx)(tn.U,{keys:"Mod+c"})})]})}function ty(){let{canExpandStartOfHunk:e,canExpandEndOfHunk:t}=tt(),{previousHunk:n,nextHunk:r}=F();return e||t||n||r?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eO.l.Divider,{}),(0,i.jsx)(tC,{}),(0,i.jsx)(tv,{})]}):null}function tC(){let{canExpandStartOfHunk:e,expandEndOfHunk:t,expandStartOfHunk:n,canExpandEndOfHunk:r}=tt();return(0,i.jsxs)(i.Fragment,{children:[e&&(0,i.jsxs)(eO.l.Item,{onSelect:n,children:[(0,i.jsx)(eO.l.LeadingVisual,{children:(0,i.jsx)(R.FoldUpIcon,{})}),"Expand above"]}),r&&(0,i.jsxs)(eO.l.Item,{onSelect:t,children:[(0,i.jsx)(eO.l.LeadingVisual,{children:(0,i.jsx)(R.FoldDownIcon,{})}),"Expand below"]})]})}function tv(){let{previousHunk:e,nextHunk:t}=F(),{fileAnchor:n}=F();return(0,i.jsxs)(i.Fragment,{children:[t?(0,i.jsxs)(eO.l.Item,{"aria-keyshortcuts":"PageDown",onSelect:()=>{setTimeout(()=>{document.querySelector(`table[data-diff-anchor="${n}"]`)?.dispatchEvent(new KeyboardEvent("keydown",{key:"PageDown"}))})},children:[(0,i.jsx)(eO.l.LeadingVisual,{children:(0,i.jsx)(R.MoveToBottomIcon,{})}),"Go to next hunk",(0,i.jsx)(eO.l.TrailingVisual,{children:"Page Down"})]}):null,e?(0,i.jsxs)(eO.l.Item,{"aria-keyshortcuts":"PageUp",onSelect:()=>{setTimeout(()=>{document.querySelector(`table[data-diff-anchor="${n}"]`)?.dispatchEvent(new KeyboardEvent("keydown",{key:"PageUp"}))})},children:[(0,i.jsx)(eO.l.LeadingVisual,{children:(0,i.jsx)(R.MoveToTopIcon,{})}),"Go to previous hunk",(0,i.jsx)(eO.l.TrailingVisual,{children:"Page Up"})]}):null]})}try{to.displayName||(to.displayName="CellContextMenu")}catch{}try{td.displayName||(td.displayName="CopyAnchorLink")}catch{}try{tc.displayName||(tc.displayName="EmptyCellContextMenu")}catch{}try{tf.displayName||(tf.displayName="SelectAllListItem")}catch{}try{tm.displayName||(tm.displayName="MarkerListItems")}catch{}try{th.displayName||(th.displayName="ViewMarkerListItems")}catch{}try{tp.displayName||(tp.displayName="SplitDiffMarkersListItems")}catch{}try{tg.displayName||(tg.displayName="UnifiedDiffMarkerListItem")}catch{}try{tx.displayName||(tx.displayName="MarkerListItem")}catch{}try{tb.displayName||(tb.displayName="CopyContentListItems")}catch{}try{ty.displayName||(ty.displayName="HunkListItems")}catch{}try{tC.displayName||(tC.displayName="ExpandHunksListItems")}catch{}try{tv.displayName||(tv.displayName="JumpToHunkListItems")}catch{}function tN({iconColor:e,icon:t,size:n=12,backgroundColor:r="fg.onEmphasis",absolute:l=!0,backgroundSx:a}){let s,o;return 12===n?(s="10px",o="1px"):20===n?(s="16px",o="2px"):(s="16px",o="4px"),(0,i.jsxs)(ep.A,{sx:{display:"flex",borderRadius:"100px",...l?{position:"absolute",bottom:-1,right:-1,boxShadow:"0 0 0 2px var(--bgColor-default, var(--color-canvas-default))",backgroundColor:"var(--bgColor-default, var(--color-canvas-default))"}:{position:"relative"},...a},children:[(0,i.jsx)(ep.A,{sx:{display:"flex",position:"absolute",borderRadius:"100px",width:s,height:s,left:o,top:o,backgroundColor:r}}),(0,i.jsx)(eb.A,{icon:t,size:n,sx:{color:e,position:"relative"}})]})}try{tN.displayName||(tN.displayName="StatusIcon")}catch{}function tj({zIndex:e,altText:t,hovercardUrl:n,src:r,square:l,icon:a,iconColor:s,backgroundColor:o,backgroundSx:d,sx:c,size:u=20}){return(0,i.jsxs)(ep.A,{sx:{position:"relative",display:"flex",gap:2,alignItems:"center",...e,...c},children:[(0,i.jsx)(e1.r,{alt:t,"data-hovercard-url":n,size:u,square:l,src:r}),(0,i.jsx)(tN,{icon:a,iconColor:s,size:12,backgroundColor:o,backgroundSx:d})]})}try{tj.displayName||(tj.displayName="StatusAvatar")}catch{}function tw({authorAvatarUrl:e,authorLogin:t,lineSpacingPreference:n,sx:r}){return(0,i.jsx)(tj,{altText:`${t}'s avatar image with pending indicator`,icon:R.DotFillIcon,iconColor:"var(--fgColor-attention, var(--color-attention-fg))",square:!1,size:"compact"===n?18:20,src:e,backgroundSx:{backgroundColor:"var(--bgColor-default, var(--color-canvas-default))",boxShadow:"0 0 0 .1px var(--bgColor-default, var(--color-canvas-default))"},sx:{alignItems:"center",display:"flex",height:"var(--diff-line-minimum-height)",...r}})}try{tw.displayName||(tw.displayName="InProgressCommentIndicator")}catch{}let tL={"action-bar-position":"ActionBar-module__action-bar-position--q5zYS","left-action-bar":"ActionBar-module__left-action-bar--EJ7Y6","left-action-bar-draft-compact":"ActionBar-module__left-action-bar-draft-compact--BA7vx","left-action-bar-draft-relaxed":"ActionBar-module__left-action-bar-draft-relaxed--yz9iI","left-action-bar-new":"ActionBar-module__left-action-bar-new--NXupU",actionBarArrowSizing:"ActionBar-module__actionBarArrowSizing--VJyrJ",actionBarHeight:"ActionBar-module__actionBarHeight--BT8aR",actionBarStartCommentWidth:"ActionBar-module__actionBarStartCommentWidth--NZ_pB","action-bar-button-group":"ActionBar-module__action-bar-button-group--eolOy"},tk=(0,l.forwardRef)(function({authorAvatarUrl:e,authorLogin:t,cellId:n,cellRef:r,showStartConversation:a,hasDraftComment:s,copilotChatReference:o,handleCopyCode:d,onOpenInLineThread:c,onStartConversation:u,shouldDisplayCollapseComments:f,toggleViewingMarkers:m},h){let p=(0,l.useRef)(null),g=(0,l.useRef)(null),{commentingEnabled:x,viewerData:{lineSpacingPreference:b,commentsPreference:y}}=eU(),{diffLine:C,isRowSelected:v}=F(),N=(0,l.useRef)(null),j=p.current?p:g;(0,eZ.T)(h,j);let w=eJ(),L=C.threadsData?.totalCommentsCount||0,k=C.annotationsData?.totalCount||0,{isActionBarFocused:S,handleActionBarBlur:E,handleActionBarFocusCapture:_,handleActionBarKeydownCapture:A}=eQ({cellRef:r}),{annotations:T,isContextMenuOpen:O,openMarkerOrListDialogFromActionBar:M,startNewConversationFromActionBar:$,startNewConversationFromActionBarWithSuggestedChange:P,anyMenuOpen:U,threads:H,toggleContextMenu:B,toggleContextMenuFromActionBar:z}=eY({cellId:n,actionBarRef:N,onOpenInLineThread:c,toggleViewingMarkers:m}),G=(0,l.useCallback)(e=>{v&&e.preventDefault()},[v]),V=x&&L+k>0&&(!w||y===eA.sI.Collapsed),W=x&&a,K={onBlur:E,onFocusCapture:_,onKeyDownCapture:A},q=(0,l.useCallback)(e=>{u?.(),$(),G(e)},[u,$,G]);return(0,i.jsxs)(i.Fragment,{children:[W&&(0,i.jsx)("div",{"aria-hidden":!S,className:(0,D.$)("d-flex","flex-row",tL["left-action-bar"]),children:(0,i.jsx)(i.Fragment,{children:s?(0,i.jsx)(I.Q,{"aria-label":"Continue comment in progress",size:"small",className:(0,D.$)("py-0","compact"===b?tL["left-action-bar-draft-compact"]:tL["left-action-bar-draft-relaxed"],tL.actionBarHeight),onClick:q,...K,children:(0,i.jsx)(tw,{lineSpacingPreference:b,authorAvatarUrl:e,authorLogin:t})}):(0,i.jsx)(Z.K,{icon:R.PlusIcon,"aria-label":"Add comment",ref:g,size:"small",className:(0,D.$)("fgColor-muted","bgColor-accent-emphasis","fgColor-onEmphasis","px-0",tL["left-action-bar-new"],tL.actionBarHeight,tL.actionBarStartCommentWidth),onClick:q,...K})})}),(0,i.jsx)("div",{"aria-hidden":!S,className:(0,D.$)("d-flex","flex-row",tL["action-bar-position"]),children:(0,i.jsxs)(e0.A,{onClick:G,className:tL["action-bar-button-group"],...K,children:[V&&(0,i.jsx)(I.Q,{ref:p,"aria-expanded":U,"aria-label":"View comments",size:"small",className:(0,D.$)("py-0","px-1",tL.actionBarHeight),onClick:e=>{(1===H.length||1===T.length)&&e.preventDefault(),M()},children:(0,i.jsx)(e8,{lineSpacingPreference:b})}),(0,i.jsxs)(eT.W,{anchorRef:N,open:O,onOpenChange:B,children:[(0,i.jsx)(eT.W.Anchor,{children:(0,i.jsx)(Z.K,{ref:N,"aria-haspopup":"true","aria-label":"More actions",icon:R.TriangleDownIcon,size:"small",className:(0,D.$)("fgColor-muted",tL.actionBarArrowSizing),onClick:z})}),(0,i.jsx)(eT.W.Overlay,{width:"medium",children:(0,i.jsx)(eO.l,{children:(0,i.jsx)(to,{shouldDisplayCollapseComments:f,copilotChatReference:o,showStartConversation:a,handleCopyCode:d,handleViewMarkersSelection:M,startConversationCurrentLine:$,startConversationWithSuggestedChange:P})})})]})]})})]})});tk.displayName="ActionBar";let tS={visibilityHidden:"DiffHighlightedOverlay-module__visibilityHidden--v59uf",userSelectNone:"DiffHighlightedOverlay-module__userSelectNone--i39lB",focusedResultStyles:"DiffHighlightedOverlay-module__focusedResultStyles--QZMIm",nonFocusedResultStyles:"DiffHighlightedOverlay-module__nonFocusedResultStyles--x2N7d",nonHunkStyles:"DiffHighlightedOverlay-module__nonHunkStyles--_dJlQ"};function tD({searchResults:e,focusedSearchResult:t,className:n,styleObject:r}){let l=0,a=e[0]?.text??"",s=e[0]?.diffLineNumIndex??-1,o=`overlay-${s}-${a}`;return(0,i.jsxs)("span",{className:(0,D.$)(n,"position-absolute",tS.userSelectNone,!e[0].isHunk&&tS.nonHunkStyles),style:{...r},children:[e.map(e=>{var n,r;let s=e.indexWithinPathDigest===t,o=(0,i.jsxs)("span",{children:[(0,i.jsx)("span",{className:(0,D.$)(tS.visibilityHidden,tS.userSelectNone),children:a.substring(l,e.column)}),(0,i.jsx)("span",{className:(0,D.$)(tS.userSelectNone,s&&tS.focusedResultStyles,!s&&tS.nonFocusedResultStyles),children:(0,i.jsx)("span",{className:(0,D.$)(!s&&tS.visibilityHidden),id:(n=e.indexWithinPathDigest,r=e.pathDigest,`match-${r}-${n}`),children:a.substring(e.column,e.columnEnd)})})]},`find-match-${e.diffLineNumIndex}-${e.column}`);return l=e.columnEnd,o}),(0,i.jsx)("span",{className:(0,D.$)(tS.visibilityHidden,tS.userSelectNone),children:a.substring(l)})]},o)}try{tD.displayName||(tD.displayName="DiffHighlightedOverlay")}catch{}function tI(e,t,n){let i=e.threadsData?.totalCount||0,r=t.threadsData?.totalCount||0;if(0===i&&0===r)return;let l="";1===i?l="has a comment.":i>1&&(l="has comments.");let a="";1===r?a="has a comment.":r>1&&(a="has comments.");let s="";if("LEFT"===n){let e=`${l.charAt(0).toUpperCase()}${l.slice(1)}`,t=`${a.length>1?"Modified line":""} ${a}`;s=`${e} ${t}`}else{let e=`${a.charAt(0).toUpperCase()}${a.slice(1)}`,t=`${l.length>1?"Original line":""} ${l}`;s=`${e} ${t}`}return s}function tE({summary:e}){let t=eJ();return""===e?null:(t&&(e+=" Press Enter to view."),(0,i.jsx)("span",{className:"sr-only user-select-none",children:e.trimStart().trimEnd()}))}try{tE.displayName||(tE.displayName="DiffLineScreenReaderSummary")}catch{}let tR={"comment-indicator":"DiffLineTableCellParts-module__comment-indicator--eI0hb","in-progress-comment-indicator":"DiffLineTableCellParts-module__in-progress-comment-indicator--hx3m3"};function t_(e,t){switch(t){case"SHOW_MARKERS":return{userMinimized:!1,showMarkers:!0};case"USER_EXPANDED_MARKERS":return{showMarkers:!0,userMinimized:!1};case"USER_MINIMIZED_MARKERS":return{userMinimized:!0,showMarkers:!1};case"USER_EXITED_MARKERS_DIALOG":return{...e,showMarkers:!1}}}let tA=["CONTEXT","INJECTED_CONTEXT"];function tT(e){let{rowId:t}=F();if(t)return(0,b.u6)(t,e)}let tO=(0,l.forwardRef)(function({children:e,ContextMenu:t,className:n,columnIndex:r,handleDiffCellClick:a,handleDiffCellMouseDown:s,handleExitDialogMode:o,handleHideMarkersFromFocus:d,handleDiffSideCellSelectionBlocking:c,handleStartConversation:u,handleUserClosedMarkersDialog:f,lineAnchor:m,firstLineNumberSelection:h,commentDialogOpen:p,enterDialogMode:x,hasThreads:y,...C},v){let{diffLine:N,fileAnchor:j,isRowSelected:w,isLeftSide:k}=F(),S=(0,l.useRef)(null);(0,l.useImperativeHandle)(v,()=>S.current,[]);let[D,I]=(0,l.useState)(!1),{selectedDiffRowRange:E}=L(),{disableInlineCommentDialogMode:R,isInDialogMode:_}=(0,Y.q)(),A=(0,l.useRef)(null),T=(0,e_.U)(e=>{if(!e.target)return;let t=e.target;if(!D||A.current?.contains(t)||S.current?.contains(t)||2!==e.button?S.current?.contains(t)&&e.target.closest("button")?.contains(t)&&I(!1):I(!1),_){let t=!e.target.closest("[data-inline-markers]"),n=!e.target.closest("#__primerPortalRoot__");t&&n&&R()}});(0,l.useEffect)(()=>(g.XC?.addEventListener("mousedown",T),()=>g.XC?.removeEventListener("mousedown",T)),[T]),(0,l.useEffect)(()=>()=>g.XC?.removeEventListener("mousedown",T),[]);let O=(0,l.useCallback)(()=>{let e=(0,b.j2)({line:N,range:E,fileAnchor:j});e&&(0,eM.D)(e)},[j,N,E]),M=(0,l.useCallback)(()=>{h?.current&&(h.current=null)},[h]),$=(0,l.useCallback)(e=>{let t=e.target?.closest("td"),n=t?.classList.contains("diff-line-number");e.shiftKey?e.preventDefault():n?s?.():h&&(h.current=null),h&&n&&(h.current=k?N.left:N.right),c?.(e)},[c]),P=(0,l.useCallback)(()=>{S.current?.focus(),R(),o?.(),f?.()},[R,o,f]),U=e$({fileAnchor:j}),H=eJ(),B=(0,l.useCallback)(async e=>{if(H){if(e.target===S.current&&(e?.metaKey||e?.ctrlKey)&&"c"===e.key){e.preventDefault(),await U();return}if(e.target===S.current&&(e?.metaKey||e?.ctrlKey)&&e.altKey&&"y"===e.key){O();return}if(S.current?.contains(e.target)&&e?.key==="Escape"){P();return}if(S.current?.contains(e.target)&&"true"===e.target.getAttribute("data-exit-dialog-mode-button")&&!e?.shiftKey&&e?.key==="Tab"){e.preventDefault(),S.current?.querySelector('[data-is-first-collapse-button="true"]')?.focus();return}if(S.current?.contains(e.target)&&"true"===e.target.getAttribute("data-is-first-collapse-button")&&e?.shiftKey&&e?.key==="Tab"){e.preventDefault(),S.current?.querySelector('[data-exit-dialog-mode-button="true"]')?.focus();return}e.target===S.current&&"Enter"===e.key&&(x?.(),!1===y&&u?.(),e.preventDefault())}},[H,U,O,P,x,y,u]),z=`inline-dialog-heading-${(0,l.useId)()}`;return(0,i.jsxs)("td",{ref:S,"data-grid-cell-id":tT(r),"data-line-anchor":m,"data-selected":w,role:_?"dialog":"gridcell",style:{userSelect:"none",position:"relative"},tabIndex:-1,valign:"top",className:n?`focusable-grid-cell ${n} ${r<3?"left-side":""}`:"focusable-grid-cell",onKeyDown:B,onBlur:e=>e.target.ariaSelected="false",onClick:a,onFocus:e=>e.target.ariaSelected="true",onMouseDown:$,onMouseUp:M,"aria-labelledby":_?z:void 0,...C,children:[_&&(0,i.jsx)("h1",{id:z,className:"sr-only",children:"Comment view"}),e,t&&D&&(0,i.jsx)(eT.W,{anchorRef:S,open:!0,onOpenChange:I,children:(0,i.jsx)(eT.W.Overlay,{width:e?"medium":"small",children:(0,i.jsx)(eO.l,{children:t})})})]})});function tM(){let{isSplit:e}=F();return(0,i.jsx)("div",{className:(0,D.$)("hunk-kebab-icon pr-2 pb-1",!e&&"hunk-kebab-icon-unified"),children:(0,i.jsx)(R.KebabHorizontalIcon,{})})}let t$=(0,l.forwardRef)(function({summary:e,searchResultsForLine:t,focusedSearchResult:n,columnIndex:r,lineAnchor:a,firstLineNumberSelection:s,handleDiffCellClick:d,handleDiffSideCellSelectionBlocking:c,filePath:u,copilotChatReference:f},m){let{diffLine:h,fileAnchor:p,isLeftSide:g,isRowSelected:x}=F(),[y,C]=(0,b._S)(h.html,h.type),[v,j]=(0,l.useState)(""),w=C&&["+","-"].includes(C),{isActionBarVisible:k}=eK(),{selectedDiffRowRange:S,selectedDiffLines:I}=L(),{commentBatchPending:E,commentingEnabled:_,commentingImplementation:A,initialExpandedThreadId:T,markerNavigationImplementation:O,repositoryId:M,subjectId:$,subject:P,viewerData:U}=eU(),{hasPersistedComment:H}=(0,Q.L4)({diffSide:g?"LEFT":"RIGHT",filePath:u,line:h.blobLineNumber,subjectId:$,fileLevelComment:!1}),{isInDialogMode:B,enableInlineCommentDialogMode:z,disableInlineCommentDialogMode:G}=(0,Y.q)(),V=(0,l.useRef)(null),W=(0,l.useRef)(null);(0,l.useImperativeHandle)(m,()=>W.current,[]);let K=eJ(),q=!!h.threadsData?.threads?.length||!!h.annotationsData?.annotations?.length,X=(0,b.S4)({hasThreads:q&&!K}),J=function(e,t,n){let{selectedDiffRowRange:i}=L();return(0,l.useMemo)(()=>{let r="Add a comment on",l=!!i&&i.startLineNumber!==i.endLineNumber;if(i&&l&&n){let e={left:"L",right:"R"},t=e[i.startOrientation],n=e[i.endOrientation];r+=i.startLineNumber!==i.endLineNumber?` lines ${t}${i.startLineNumber} to ${n}${i.endLineNumber}`:` line ${t}${i.startLineNumber}`}else{let n=t&&!(0,b.Ji)(e)?"L":"R";r+=` line ${n}${e.blobLineNumber}`}return r},[e,t,i,n])}(h,!!g,x),Z=tT(r),{handleCellBlur:ee,handleCellFocus:et,handleCellMouseEnter:en,handleCellMouseLeave:ei}=eQ({cellRef:W}),er=(0,l.useRef)(null),[el,ea]=function(e){let[t,n]=(0,l.useReducer)(t_,{userMinimized:e===eA.sI.Collapsed,showMarkers:!1});return(0,l.useEffect)(()=>{e===eA.sI.Visible?n("SHOW_MARKERS"):n("USER_MINIMIZED_MARKERS")},[e,n]),[t,n]}(U.commentsPreference),es=(0,l.useCallback)((e=!0)=>{W.current?.classList.contains("diff-text-cell")&&(z(),ea("USER_EXPANDED_MARKERS"),e&&setTimeout(()=>{W.current?.querySelector('[data-first-marker="true"]')?.focus()},0))},[ea,z]),eo=(0,l.useCallback)(()=>{setTimeout(()=>W.current?.focus()),G(),ea("USER_MINIMIZED_MARKERS")},[G,ea]),ed=(0,l.useCallback)(()=>{U.commentsPreference===eA.sI.Collapsed&&el.showMarkers?eo():es()},[eo,es,el.showMarkers,U.commentsPreference]),{annotations:ec,isNewConversationDialogOpen:eu,shouldStartNewConversationWithSuggestedChange:ef,startNewConversation:eh,startNewConversationWithSuggestedChange:ep,openMarkerOrListDialog:eg,selectAnnotation:ex,selectThread:eb,isMarkerListDialogOpen:ey,closeNewConversationDialog:eC,closeMarkerListDialog:ev,closeConversationDetailsDialog:eN,returnFocusRef:ej,optimizedSelectedAnnotationId:ew,optimizedSelectedThreadId:eL,threads:ek}=eY({cellId:Z,actionBarRef:V,onOpenInLineThread:es}),eS=(0,l.useMemo)(()=>{var e;return(!eu||!K)&&(e=U.viewerCanComment,_&&e&&(0,b.a1)(h,I))},[eu,K,_,U.viewerCanComment,h,I]);(0,l.useEffect)(()=>{A&&T&&eL!==T&&ek.map(e=>e.id).includes(T)&&eb(T,{skipLineSelection:!0})},[T]),(0,l.useEffect)(()=>{if(!O)return;let{activeGlobalMarkerID:e,onActivateGlobalMarkerNavigation:t}=O;if(e){let n=ek.map(e=>e.id),i=ec.map(e=>e.id);n.includes(e)?(eb(e,{skipLineSelection:!0}),t()):i.includes(e)&&(ex(e,{skipLineSelection:!0}),t())}},[eb,ek,O,ec,ex]);let eD=({onCompleted:e,threadsConnectionId:t,...n})=>{if(!A||!h)return;let{leftLines:i,rightLines:r}=I;if(S){let e="left"===S.endOrientation?i:r,n=e[e.length-1];n&&(0,b.qK)(n)&&n.threadsData?.__id&&(t=n.threadsData?.__id)}A.addThread({...n,diffLine:h,isLeftSide:g,isLineSelected:x,selectedDiffRowRange:S,threadsConnectionId:t,onCompleted:(t,n)=>{e?.(t,n),eb(t),K&&j(t)}})},eI=({onCompleted:e,...t})=>{A&&h&&A.deleteComment({...t,onCompleted:()=>{e?.(),ek.length<=1&&(eN(),setTimeout(()=>W.current?.focus()))},filePath:u})},eR=function(e,t,n){let{sendAnalyticsEvent:i}=(0,em.s)(),{getDiffLinesFromLineRange:r,selectedDiffRowRange:a}=L(),s=N(function(n,l){if(!e)return;let a=function(e){if(!e)return"DELETION"!==t.type;if("right"===e.startOrientation&&"right"===e.endOrientation)return!0;if(e.startLineNumber===e.endLineNumber&&e.startOrientation===e.endOrientation)return"DELETION"!==t.type;let n=r(e)?.selectedLeftLines;return!!n?.every(e=>"empty-diff-line"!==e&&"DELETION"!==e.type)}(n);return{isValidSuggestionRange:a,showSuggestChangesButton:a,sourceContentFromDiffLines:a?function(e){let n=r(e)?.selectedRightLines;if(e&&n&&n.length>1)return(0,b.Ls)(n);if(!t)return"";let[i]=(0,b._S)(t.text,t.type);return i}(n):void 0,onInsertSuggestedChange:()=>{i("diff.add_suggested_change","ADD_SUGGESTED_CHANGE_BUTTON")},shouldInsertSuggestedChange:l}});return(0,l.useMemo)(()=>({selectedDiffRowRange:a,configureSuggestedChangesFromLineRange:s,shouldStartNewConversationWithSuggestedChange:n}),[a,s,n])}(A?.suggestedChangesEnabled,h,ef),e_=(0,l.useCallback)(()=>{K&&es?.(),eh?.()},[K,es,eh]),eT=(0,l.useCallback)(()=>{B||0!==(W.current?.querySelectorAll(":focus")??[]).length||G()},[G,B]),eO=(0,l.useRef)(!0),{ghostUser:eM}=eU(),eP=e$({fileAnchor:p}),eF=(0,l.useMemo)(()=>q&&U.commentsPreference===eA.sI.Collapsed?!el.userMinimized:(!!eu||!!q)&&!!_&&(U.commentsPreference===eA.sI.Collapsed&&(!!eu||!!B)||U.commentsPreference===eA.sI.Visible&&(!!q||!!eu||!!el.showMarkers)),[_,q,B,eu,el.showMarkers,el.userMinimized,U.commentsPreference]),eH=(0,l.useMemo)(()=>(0,b.dT)(h),[h]);return(0,i.jsxs)(tO,{ref:W,columnIndex:r,commentDialogOpen:eu,handleDiffCellClick:d,enterDialogMode:es,handleDiffSideCellSelectionBlocking:c,handleExitDialogMode:()=>ea("USER_EXITED_MARKERS_DIALOG"),handleUserClosedMarkersDialog:()=>ea("USER_MINIMIZED_MARKERS"),lineAnchor:a,firstLineNumberSelection:s,handleStartConversation:e_,hasThreads:q,ContextMenu:(0,i.jsx)(to,{shouldDisplayCollapseComments:eF,copilotChatReference:f,showStartConversation:eS,handleViewMarkersSelection:eg,startConversationCurrentLine:e_,startConversationWithSuggestedChange:ep}),className:(0,D.$)(`diff-text-cell ${g?"left-side-diff-cell":"right-side-diff-cell"} ${eH?"pt-4":""}`,{"border-right":g&&"HUNK"!==h.type}),style:{backgroundColor:(0,b.Yf)(h.type,!1,x),paddingRight:X},onBlur:e=>{ee(e),eT()},onFocus:et,onMouseEnter:en,onMouseLeave:ei,children:[(0,i.jsxs)("code",{className:(0,D.$)("diff-text syntax-highlighted-line",{addition:"ADDITION"===h.type,deletion:"DELETION"===h.type}),children:[w&&(0,i.jsx)("span",{className:"diff-text-marker",children:C}),t&&t.length>0&&(0,i.jsx)(tD,{searchResults:t,focusedSearchResult:n,className:(0,D.$)("diff-text-inner",{"color-fg-muted":"HUNK"===h.type})}),(0,i.jsx)(o.mo,{html:y,className:(0,D.$)("diff-text-inner",{"color-fg-muted":"HUNK"===h.type})})]}),h.displayNoNewLineWarning&&(0,i.jsx)(R.NoEntryIcon,{size:16,className:"fgColor-danger"}),k&&(0,i.jsx)(tk,{shouldDisplayCollapseComments:!!K&&el.showMarkers,copilotChatReference:f,authorAvatarUrl:U.avatarUrl,authorLogin:U.login,ref:V,cellId:Z,cellRef:W,onStartConversation:e_,hasDraftComment:H,showStartConversation:eS,onOpenInLineThread:es,handleCopyCode:eP,toggleViewingMarkers:ed}),A&&O&&(0,i.jsx)(i.Fragment,{children:K?eF?(0,i.jsx)(eE,{inlineMarkersRef:er,manuallyUpdateCommentsWithThisThreadId:v,annotations:ec,enterDialogMode:es,batchPending:E,batchingEnabled:A.batchingEnabled,commentingImplementation:{...A,deleteComment:eI},conversationListThreads:ek,fileAnchor:p,filePath:u,onCloseFocusMode:eo,isMarkerListOpen:!!W.current?.classList.contains("diff-text-cell")&&ek.length>0,isRowSelected:x,lineType:h.type,repositoryId:M,returnFocusRef:ej,selectedAnnotationId:ew,selectedThreadId:eL||(W.current?.classList.contains("diff-text-cell")&&ek.length>0?ek[0]?.id:null),subjectId:$,subject:P,suggestedChangesConfig:eR,onCloseConversationDialog:eN,onCloseConversationList:ev,onAnnotationSelected:ex,onThreadSelected:eb,viewerData:U,ghostUser:eM,children:eu&&(0,i.jsx)("div",{className:(0,D.$)(" border rounded-2 color-border-default",(ek.length,"mt-2 mb-1")),children:(0,i.jsx)(Q.cT,{isDialog:!1,addCommentDialogTitle:J,anchorRef:W,batchPending:E,batchingEnabled:A.batchingEnabled,commentBoxConfig:A.commentBoxConfig,commentBoxSubject:A.commentBoxSubject,filePath:u,isLeftSide:!!g,isOpen:eu,lineNumber:x?S?.endLineNumber:h.blobLineNumber,repositoryId:M,returnFocusRef:ej,startLineNumber:x?S?.startLineNumber:void 0,subjectId:$,suggestedChangesConfig:eR,viewerData:U,onAddComment:eD,onCloseCommentDialog:()=>{eo(),eC()}})})}):null:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(Q.c7,{annotations:ec,batchPending:E,batchingEnabled:A.batchingEnabled,commentingImplementation:{...A,deleteComment:eI},conversationAnchorRef:W,conversationListAnchorRef:ej,conversationListThreads:ek,fileAnchor:p,filePath:u,isMarkerListOpen:ey,repositoryId:M,returnFocusRef:ej,selectedAnnotationId:ew,selectedThreadId:eL,subjectId:$,subject:P,suggestedChangesConfig:eR,onCloseConversationDialog:eN,onCloseConversationList:ev,onAnnotationSelected:ex,onThreadSelected:eb,markerNavigationImplementation:O,viewerData:U,ghostUser:eM}),(0,i.jsx)(Q.cT,{addCommentDialogTitle:J,anchorRef:W,batchPending:E,batchingEnabled:A.batchingEnabled,commentBoxConfig:A.commentBoxConfig,commentBoxSubject:A.commentBoxSubject,filePath:u,isLeftSide:!!g,isOpen:eu,lineNumber:h.blobLineNumber,repositoryId:M,returnFocusRef:ej,subjectId:$,suggestedChangesConfig:eR,viewerData:U,onAddComment:eD,onCloseCommentDialog:eC})]})}),!k&&(!K||U.commentsPreference===eA.sI.Collapsed)&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{"aria-hidden":"true",style:{left:"compact"===U.lineSpacingPreference?"-1px":"-2px"},className:(0,D.$)("position-absolute top-0 d-flex user-select-none",tR["in-progress-comment-indicator"]),children:H&&(0,i.jsx)(tw,{lineSpacingPreference:U.lineSpacingPreference,authorAvatarUrl:U.avatarUrl,authorLogin:U.login})}),(0,i.jsx)("div",{"aria-hidden":"true",className:(0,D.$)("position-absolute top-0 d-flex user-select-none",tR["comment-indicator"]),children:(0,i.jsx)(e8,{shouldAnimateRef:eO,lineSpacingPreference:U.lineSpacingPreference})})]}),e&&(0,i.jsx)(tE,{summary:e})]})}),tP=(0,l.memo)(t$),tF=(0,l.memo)(tU);function tU({children:e,columnIndex:t,handleDiffCellClick:n,handleDiffSideCellSelectionBlocking:r,firstLineNumberSelection:a,filePath:s,copilotChatReference:o,contentRef:d,...c}){let u=(0,l.useRef)(null),{diffLine:f,fileAnchor:m,isLeftSide:h,isRowSelected:p}=F(),{updateSelectedDiffRowRange:g}=L(),x=(0,l.useCallback)(()=>{a&&null!==a.current&&g(m,h?f.left:f.right,h?"left":"right",!0,!0)},[m,h,f.left,f.right,a,g]),y=(0,l.useCallback)(()=>{g(m,h?f.left:f.right,h?"left":"right",!1,!0)},[m,h,f.left,f.right,g]);return(0,i.jsx)(tO,{ref:u,className:(0,D.$)("diff-line-number position-relative",tA.includes(f.type)&&"diff-line-number-neutral"),columnIndex:t,handleDiffCellClick:n,handleDiffSideCellSelectionBlocking:r,firstLineNumberSelection:a,style:{backgroundColor:(0,b.Yf)(f.type,!0,p),textAlign:"center"},handleDiffCellMouseDown:y,onMouseEnter:x,...c,children:(0,i.jsx)("code",{children:e})})}function tH({ContextMenu:e,renderHunkButton:t,searchResultsForLine:n,focusedSearchResult:r}){let a=(0,l.useRef)(null),[s,d]=function(e){let[t,n]=(0,l.useState)(!1),[i,r]=(0,l.useState)(!1),a=(0,l.useCallback)(t=>{e.current&&e.current.contains(t.relatedTarget)||n(!1)},[e]),s=(0,l.useCallback)(()=>{e.current===document.activeElement&&n(!0)},[e]),o=(0,l.useCallback)(t=>{e.current&&!e.current.contains(t.relatedTarget)&&n(!1),r(!1)},[e]);return[{onFocus:s,onBlur:a},{"aria-hidden":!i,tabIndex:t?0:-1,onBlur:o,onFocusCapture:(0,l.useCallback)(e=>{e.stopPropagation(),r(!0)},[]),onKeyDownCapture:(0,l.useCallback)(e=>{q(e.key)&&e.stopPropagation()},[])}]}(a),{diffLine:c}=F();return(0,i.jsx)(tO,{ref:a,ContextMenu:e,colSpan:4,columnIndex:0,style:{backgroundColor:"var(--bgColor-accent-muted, var(--color-accent-subtle))",flexGrow:1},...s,className:"diff-hunk-cell",children:(0,i.jsxs)("div",{className:"d-flex flex-row",children:[t?.(d)??(0,i.jsx)(tM,{}),(0,i.jsxs)("code",{className:"diff-text-cell hunk",children:[n&&n.length>0&&(0,i.jsx)(tD,{searchResults:n,focusedSearchResult:r,className:(0,D.$)("diff-text-inner",{"color-fg-muted":"HUNK"===c.type})}),(0,i.jsx)(o.mo,{className:"diff-text-inner color-fg-muted",html:c.html})]})]})})}function tB({columnIndex:e,showRightBorder:t}){return(0,i.jsx)(tO,{ContextMenu:(0,i.jsx)(tc,{}),className:(0,D.$)("empty-diff-line",{"border-right":t}),columnIndex:e})}try{tO.displayName||(tO.displayName="Cell")}catch{}try{tM.displayName||(tM.displayName="HunkKebabIcon")}catch{}try{t$.displayName||(t$.displayName="ContentCellUnmemoized")}catch{}try{tP.displayName||(tP.displayName="ContentCell")}catch{}try{tF.displayName||(tF.displayName="LineNumberCell")}catch{}try{tU.displayName||(tU.displayName="LineNumberCellUnmemoized")}catch{}try{tH.displayName||(tH.displayName="HunkCell")}catch{}try{tB.displayName||(tB.displayName="EmptyCell")}catch{}var tz=n(21728),tG=n(94977);function tV(){let e;let t=(0,tz.c)(1);return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,i.jsx)(tG.A,{direction:"n",text:"This line has hidden Unicode characters",children:(0,i.jsx)(R.AlertIcon,{className:"mr-2"})}),t[0]=e):e=t[0],e}try{tV.displayName||(tV.displayName="HiddenUnicodeAlert")}catch{}let tW=({summary:e,resultsForLine:t,focusedSearchResult:n,handleDiffSideCellSelectionBlocking:r,handleDiffRowClick:a,lineAnchor:s,filePath:o,copilotChatReference:d,firstLineNumberSelection:c})=>{let{diffLine:u,hasHiddenUnicodeCharacters:f,isLeftSide:m,isSplit:h,setInGridMode:p}=F(),g=(0,l.useRef)(null),x="ADDITION"!==u.type,b=!h||m,y=b&&!x,C="DELETION"!==u.type,v=!h||!m,N=v&&!C,j=(0,l.useCallback)(e=>{u.left&&a(e,u.left,"left",e.shiftKey,!0)},[a,u.left]),w=(0,l.useCallback)(e=>{u.left&&a(e,u.left,"left",e.shiftKey,!1)},[a,u.left]),L=(0,l.useCallback)(e=>{u.right&&a(e,u.right,"right",e.shiftKey,!0)},[a,u.right]),k=(0,l.useCallback)(e=>{u.right&&a(e,u.right,"right",e.shiftKey,!1)},[a,u.right]),S=(0,l.useCallback)(()=>{r&&r("left")},[r]),D=(0,l.useCallback)(()=>{r&&r("right")},[r]);return(0,i.jsxs)(eW,{line:u,children:[b&&(0,i.jsxs)(tF,{copilotChatReference:d,columnIndex:0,filePath:o,handleDiffCellClick:y?L:j,handleDiffSideCellSelectionBlocking:D,firstLineNumberSelection:c,contentRef:g,children:[f&&!C&&(0,i.jsx)(tq,{children:(0,i.jsx)(tV,{})}),x&&u.left]}),v&&(0,i.jsxs)(tF,{copilotChatReference:d,columnIndex:h?2:1,filePath:o,handleDiffCellClick:N?j:L,handleDiffSideCellSelectionBlocking:S,firstLineNumberSelection:c,contentRef:g,children:[f&&C&&(0,i.jsx)(tq,{children:(0,i.jsx)(tV,{})}),C&&u.right]}),(0,i.jsx)(Y.f,{enableDiffGridMode:p,children:(0,i.jsx)(tP,{copilotChatReference:d,columnIndex:h?m?1:3:2,filePath:o,handleDiffCellClick:m?w:k,lineAnchor:s,handleDiffSideCellSelectionBlocking:m?D:S,searchResultsForLine:t,focusedSearchResult:n,summary:e,firstLineNumberSelection:c,ref:g})})]})},tK=({summary:e,resultsForLine:t,focusedSearchResult:n,fileAnchor:r,filePath:l,handleDiffRowClick:a,handleDiffSideCellSelectionBlocking:s,copilotChatReference:o,firstLineNumberSelection:d})=>{let{diffLine:c,isLeftSide:u}=F();if((0,b.Po)(c))return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(tB,{columnIndex:u?0:2}),(0,i.jsx)(tB,{columnIndex:u?1:3,showRightBorder:u})]});let f=u?"left":(0,m.XU)(c.type),h="left"===f?c.left:c.right,p=(0,m.IQ)(r,f,h??0);switch(c.type){case"HUNK":return null;case"ADDITION":case"DELETION":case"CONTEXT":case"INJECTED_CONTEXT":return(0,i.jsx)(tJ,{copilotChatReference:o,filePath:l,handleDiffRowClick:a,handleDiffSideCellSelectionBlocking:s,lineAnchor:p,resultsForLine:t,focusedSearchResult:n,summary:e,firstLineNumberSelection:d});default:throw Error(`cannot handle type ${c.type}`)}};function tq({children:e}){return(0,i.jsx)("span",{className:"position-absolute",style:{left:"-1px",zIndex:"1"},children:e})}let tX=l.memo(tK),tJ=l.memo(tW);try{tW.displayName||(tW.displayName="CodeDiffLineUnmemoized")}catch{}try{tK.displayName||(tK.displayName="DiffLineSideUnmemoized")}catch{}try{tq.displayName||(tq.displayName="DiffCodeAlert")}catch{}try{tX.displayName||(tX.displayName="DiffLineSide")}catch{}try{tJ.displayName||(tJ.displayName="CodeDiffLine")}catch{}let tY={"expand-button-line":"ExpandableHunkHeaderDiffLine-module__expand-button-line--rnQN5","expand-up-and-down":"ExpandableHunkHeaderDiffLine-module__expand-up-and-down--hCan_","expand-button-unified":"ExpandableHunkHeaderDiffLine-module__expand-button-unified--j86KQ"};function tQ({direction:e,icon:t,label:n,onClick:r,ariaLabel:l,className:a,...s}){let{sendAnalyticsEvent:o}=(0,em.s)(),{isSplit:d}=F();return(0,i.jsx)("button",{onClick:()=>{r(),o("file_entry.expand_hunk","FILE_EXPANDER_BUTTON")},className:(0,D.$)("Button Button--iconOnly Button--invisible",tY["expand-button-line"],!d&&tY["expand-button-unified"],a),"aria-label":l??n,"data-direction":e,...s,children:(0,i.jsx)(t,{})})}function tZ({nextLine:e,prevLine:t,resultsForLine:n,focusedSearchResult:r}){let{fileLineCount:a,diffLine:s}=F(),{expandStartOfHunk:o,expandEndOfPreviousHunk:d}=tt(),c=!t,u=!e,f=0===s.blobLineNumber,m=c||u,h=u&&s.blobLineNumber===a,p=(0,l.useMemo)(()=>!m&&!(s.blobLineNumber<=0)&&(s.blobLineNumber-t.blobLineNumber<=20||e.blobLineNumber-s.blobLineNumber>=20),[m,s,e,t]),g=(0,l.useMemo)(()=>!m&&!h&&s.blobLineNumber-t.blobLineNumber>20,[m,h,s,t]),x=(0,l.useMemo)(()=>!(s.blobLineNumber<=0)&&!f&&!!c,[c,f,s]),y=(0,l.useMemo)(()=>!c&&!h&&!!u,[c,u,h]),C=(0,l.useMemo)(()=>{switch(!0){case p:return"expand-all";case g:return"expand-up-and-down";case x:return"expand-up";case y:return"expand-down"}},[p,g,x,y]),v=()=>o(),N=()=>d(),j=()=>o();return(0,i.jsx)(tH,{searchResultsForLine:n,focusedSearchResult:r,renderHunkButton:n=>{switch(C){case"expand-all":return(0,i.jsx)(tQ,{...n,direction:"all",icon:R.UnfoldIcon,label:`Expand file from line ${t?.blobLineNumber||""} to line ${e?.blobLineNumber||""}`,onClick:j});case"expand-up-and-down":return(0,i.jsxs)("div",{className:"d-flex flex-column",children:[(0,i.jsx)(tQ,{...n,direction:"down",icon:R.FoldDownIcon,label:`Expand file down from line ${t?.blobLineNumber||""}`,className:tY["expand-up-and-down"],onClick:N}),(0,i.jsx)(tQ,{...n,direction:"up",icon:R.FoldUpIcon,label:`Expand file up from line ${e?.blobLineNumber||""}`,className:tY["expand-up-and-down"],onClick:v})]});case"expand-up":return(0,i.jsx)(tQ,{...n,direction:"up",icon:R.FoldUpIcon,label:`Expand file up from line ${e?.blobLineNumber||""}`,onClick:v});case"expand-down":return(0,i.jsx)(tQ,{...n,direction:"down",icon:R.FoldDownIcon,label:`Expand file down from line ${t?.blobLineNumber||""}`,onClick:N});default:return null}},ContextMenu:(0,i.jsx)(t0,{handleCopyContent:()=>{let[e]=(0,b._S)((0,b.ZC)(s.html),s.type);(0,eM.D)(e)},handleExpandAbove:v,handleExpandAll:j,handleExpandBelow:N,shouldCopyContent:!!s.html,shouldExpandAbove:g||x,shouldExpandBelow:g||y})})}function t0({shouldExpandBelow:e,shouldExpandAbove:t,shouldCopyContent:n,handleExpandAll:r,handleExpandBelow:l,handleExpandAbove:a,handleCopyContent:s}){let o={includeShiftKey:!0,key:"["},d={key:"]"},c={key:"["},u={key:"C"};return(0,i.jsx)(eT.W.Overlay,{width:"medium",children:(0,i.jsxs)(eO.l,{children:[(0,i.jsxs)(eO.l.Item,{"aria-keyshortcuts":(0,b.oE)(o),onSelect:r,children:[(0,i.jsx)(eO.l.LeadingVisual,{children:(0,i.jsx)(R.UnfoldIcon,{})}),"Expand all",(0,i.jsx)(eO.l.TrailingVisual,{children:(0,i.jsx)("span",{children:`${(0,b.pI)(o)}`})})]}),t?(0,i.jsxs)(eO.l.Item,{"aria-keyshortcuts":(0,b.oE)(d),onSelect:a,children:[(0,i.jsx)(eO.l.LeadingVisual,{children:(0,i.jsx)(R.FoldUpIcon,{})}),"Expand above",(0,i.jsx)(eO.l.TrailingVisual,{children:(0,i.jsx)("span",{children:`${(0,b.pI)(d)}`})})]}):null,e?(0,i.jsxs)(eO.l.Item,{"aria-keyshortcuts":(0,b.oE)(c),onSelect:l,children:[(0,i.jsx)(eO.l.LeadingVisual,{children:(0,i.jsx)(R.FoldDownIcon,{})}),"Expand below",(0,i.jsx)(eO.l.TrailingVisual,{children:(0,i.jsx)("span",{children:`${(0,b.pI)(c)}`})})]}):null,(0,i.jsx)(tv,{}),n?(0,i.jsxs)(eO.l.Item,{"aria-keyshortcuts":(0,b.oE)(u),onSelect:s,children:[(0,i.jsx)(eO.l.LeadingVisual,{children:(0,i.jsx)(R.CopyIcon,{})}),"Copy",(0,i.jsx)(eO.l.TrailingVisual,{children:(0,i.jsx)("span",{children:`${(0,b.pI)(u)}`})})]}):null]})})}try{tQ.displayName||(tQ.displayName="ExpandButtonLine")}catch{}try{tZ.displayName||(tZ.displayName="ExpandableHunkHeaderDiffLine")}catch{}try{t0.displayName||(t0.displayName="HunkContextMenu")}catch{}var t1=n(55314),t2=n(96728);let t4=(0,l.memo)(function({searchResults:e,diffContext:t="pr",focusedSearchResult:n,clearSelectedDiffRowRange:r,diffEntryId:a,diffHasHiddenUnicodeCharacters:s,diffLines:o,fileAnchor:d,fileLineCount:c,filePath:u,handleDiffRowClick:f,handleDiffSideCellSelectionBlocking:m,replaceSelectedDiffRowRangeFromGridCells:h,selectedDiffRowRange:p,setInGridMode:g,showHiddenUnicode:x,tableRef:C,updateDiffLines:v,updateSelectedDiffRowRange:N,copilotChatReference:j,inGridMode:w,firstLineNumberSelection:L}){let{leftLines:k,rightLines:S}=function(e){let t=e.reduce((e,t)=>e+(t.threadsData?.totalCount??0),0)??0,{leftLines:n,rightLines:i}=(0,l.useMemo)(()=>(function(e){let t=[],n=[],i=()=>{for(;t.length<n.length;)t.push(J.V);for(;n.length<t.length;)n.push(J.V)};for(let r of e)switch(r.type){case"ADDITION":n.push(r);break;case"DELETION":t.push(r);break;case"CONTEXT":case"INJECTED_CONTEXT":i();let[e,l]=[{...r,threadsData:void 0,annotationsData:void 0},{...r,threadsData:r.threadsData?{...r.threadsData,threads:r.threadsData.threads,totalCommentsCount:r.threadsData.totalCommentsCount,totalCount:r.threadsData.totalCount}:void 0}];t.push(e),n.push(l);break;case"HUNK":i(),t.push(r),n.push(r)}return i(),{leftLines:t,rightLines:n}})(e),[e,t]);return{leftLines:n,rightLines:i}}(o),{ghostUser:D}=eU();X({clearSelectedDiffRowRange:r,containerRef:C,fileAnchor:d,isSplitDiff:!0,leftLines:k,replaceSelectedDiffRowRangeFromGridCells:h,rightLines:S,selectedDiffRowRange:p,updateSelectedDiffRowRange:N,disabled:!w});let I=(0,l.useMemo)(()=>{if(p)return y({selectedDiffRowRange:p,leftLines:k,rightLines:S,isNumberCell:!0})},[p,k,S]);(0,l.useEffect)(()=>{v(d,o)},[o,d,v]);let E=(0,l.useMemo)(()=>M(k),[k]),R=new Map,_=new Map,A=new Map;for(let t=0;t<(e?.length??0);t++){let n=e?.[t];n&&(R.has(n.leftLineNumber)?R.get(n.leftLineNumber)?.push(n):-1!==n.leftLineNumber&&R.set(n.leftLineNumber,[n]),A.has(n.hunkLineNumber)?A.get(n.hunkLineNumber)?.push(n):n.isHunk&&A.set(n.hunkLineNumber,[n]),_.has(n.rightLineNumber)?_.get(n.rightLineNumber)?.push(n):-1!==n.rightLineNumber&&_.set(n.rightLineNumber,[n]))}let T=e=>{let t=!1;return s&&!(0,b.Po)(e)&&(t=(0,t1.Y)(e.text),x&&t&&(e=e.html?{...e,html:(0,t2.Gx)(e.html)??e.html}:{...e,text:(0,t1.TA)(e.text)})),[e,t]},$=[];for(let e=0;e<k.length;e++){let r=k[e],l=S[e],s=k[e-1],[o,h]=T(r),[p,x]=T(l),y=(0,b.Po)(k[e+1])?S[e+1]:k[e+1],C=(0,b.qK)(o)&&"HUNK"===o.type,v=(0,b.qX)(d,o,p),N=(0,b.Po)(o)?(0,b.Po)(p)?void 0:p:o;if(!N)continue;let w=(0,b.Po)(o)?void 0:o.threadsData,M=(0,b.Po)(p)?void 0:p.threadsData,{currentHunk:F,nextHunk:H,previousHunk:B}=O(N,E),z=R.get((0,b.Po)(o)?-2:o.left??-2),G=_.get((0,b.Po)(p)?-2:p.right??-2),V=A.get(N.blobLineNumber),W=V?.[0]?.rightLineNumber===p?.right?n:void 0,K=z?.[0]?.leftLineNumber===o?.left?n:void 0,q=G?.[0]?.rightLineNumber===p?.right?n:void 0,X=tI(o,p,"LEFT"),J=tI(o,p,"RIGHT"),Y=U(M,D),Q=U(w,D),Z={currentHunk:F,diffEntryId:a,fileAnchor:d,fileLineCount:c,filePath:u,isRowSelected:(I?.isRowSelected(r)||I?.isRowSelected(l))??!1,nextHunk:H,previousHunk:B,rowId:v,isSplit:!0,diffContext:t,setInGridMode:g};$.push((0,i.jsx)("tr",{className:"diff-line-row",children:C?(0,i.jsx)(P,{...Z,hasHiddenUnicodeCharacters:h||x,diffLine:N,modifiedLineThreads:Y,originalLineThreads:Q,children:(0,i.jsx)(tZ,{nextLine:y,prevLine:s,focusedSearchResult:W,resultsForLine:V})}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(P,{...Z,diffLine:o,hasHiddenUnicodeCharacters:h,isLeftSide:!0,modifiedLineThreads:Y,originalLineThreads:Q,children:(0,i.jsx)(tX,{summary:X,copilotChatReference:j,fileAnchor:d,filePath:u,handleDiffRowClick:f,handleDiffSideCellSelectionBlocking:m,resultsForLine:z,focusedSearchResult:K,firstLineNumberSelection:L})}),(0,i.jsx)(P,{...Z,diffLine:p,hasHiddenUnicodeCharacters:x,modifiedLineThreads:Y,originalLineThreads:Q,children:(0,i.jsx)(tX,{summary:J,copilotChatReference:j,fileAnchor:d,filePath:u,handleDiffRowClick:f,handleDiffSideCellSelectionBlocking:m,resultsForLine:G,focusedSearchResult:q,firstLineNumberSelection:L})})]})},v))}return(0,i.jsx)(i.Fragment,{children:$})});try{t4.displayName||(t4.displayName="SplitDiffLines")}catch{}let t3=(0,l.memo)(function({searchResults:e,diffContext:t="pr",focusedSearchResult:n,clearSelectedDiffRowRange:r,diffEntryId:a,diffHasHiddenUnicodeCharacters:s,diffLines:o,fileLineCount:d,fileAnchor:c,filePath:u,tableRef:f,selectedDiffRowRange:h,showHiddenUnicode:p,handleDiffRowClick:g,updateDiffLines:x,updateSelectedDiffRowRange:C,replaceSelectedDiffRowRangeFromGridCells:v,copilotChatReference:N,setInGridMode:j,inGridMode:w,firstLineNumberSelection:L}){X({clearSelectedDiffRowRange:r,containerRef:f,fileAnchor:c,isSplitDiff:!1,leftLines:o,replaceSelectedDiffRowRangeFromGridCells:v,selectedDiffRowRange:h,updateSelectedDiffRowRange:C,disabled:!w});let k=(0,l.useMemo)(()=>{if(h)return y({selectedDiffRowRange:h,leftLines:o,isNumberCell:!0})},[h,o]),S=(0,l.useMemo)(()=>M(o.map(e=>e)),[o]);(0,l.useEffect)(()=>{x(c,o)},[o,c,x]);let D=new Map;for(let t=0;t<(e?.length??0);t++){let n=e?.[t];n&&(e&&D.has(n.diffLineNumIndex)?D.get(n.diffLineNumIndex)?.push(n):e&&D.set(n.diffLineNumIndex,[n]))}let I=o.map((e,r)=>{let l=e,f=o[r+1],h=o[r-1],x="HUNK"===e.type,y=(0,m.IQ)(c,(0,m.XU)(l.type),l.blobLineNumber),{currentHunk:C,nextHunk:v,previousHunk:w}=O(l,S),I=D.get(r),E=r===I?.[0]?.diffLineNumIndex?n:void 0,R=tI(e,e,"RIGHT"),_=k?.isRowSelected(e)??!1,A=(0,b.qX)(c,l,l),T=s&&(0,t1.Y)(l.text);p&&T&&(l=l.html?{...l,html:(0,t2.Gx)(l.html)??l.html}:{...l,text:(0,t1.TA)(l.text)});let M={diffEntryId:a,diffLine:l,currentHunk:C,fileAnchor:c,fileLineCount:d,filePath:u,hasHiddenUnicodeCharacters:T,isLeftSide:"DELETION"===l.type,isRowSelected:_,isSplit:!1,nextHunk:v,previousHunk:w,diffContext:t,rowId:A,setInGridMode:j};return(0,i.jsx)("tr",{className:"diff-line-row",children:(0,i.jsx)(P,{...M,children:x?(0,i.jsx)(tZ,{nextLine:f,prevLine:h,focusedSearchResult:E,resultsForLine:I}):(0,i.jsx)(tJ,{filePath:u,copilotChatReference:N,handleDiffRowClick:g,firstLineNumberSelection:L,lineAnchor:y,resultsForLine:I,focusedSearchResult:E,summary:R})})},A)});return(0,i.jsx)(i.Fragment,{children:I})});try{t3.displayName||(t3.displayName="UnifiedDiffLines")}catch{}let t6={tableLayoutFixed:"DiffLines-module__tableLayoutFixed--YZcIJ",compact:"DiffLines-module__compact--wEEom"};var t8=n(94232);function t5(e){let t,n,r,l,a;let s=(0,tz.c)(7),{isShown:o,toggleShowHiddenCharacters:d}=e;s[0]===Symbol.for("react.memo_cache_sentinel")?(t=[],s[0]=t):t=s[0];let[c]=(0,t8.I)(t7,g.cg,t);if(!c)return null;s[1]===Symbol.for("react.memo_cache_sentinel")?(n=(0,i.jsx)(R.AlertIcon,{}),s[1]=n):n=s[1],s[2]===Symbol.for("react.memo_cache_sentinel")?(r=(0,i.jsxs)("span",{children:["This file contains bidirectional or hidden Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters."," ",(0,i.jsx)(h.A,{inline:!0,href:"https://github.co/hiddenchars",target:"_blank",rel:"noreferrer",children:"Learn more about bidirectional Unicode characters"})]}),s[2]=r):r=s[2],s[3]===Symbol.for("react.memo_cache_sentinel")?(l={backgroundClip:"padding-box"},s[3]=l):l=s[3];let u=o?"Hide revealed characters":"Show hidden characters";return s[4]!==u||s[5]!==d?(a=(0,i.jsxs)(ex.A,{className:"d-flex flex-items-center",full:!0,variant:"warning",children:[n,r,(0,i.jsx)(I.Q,{className:"ml-4 float-right",onClick:d,size:"small",style:l,children:u})]}),s[4]=u,s[5]=d,s[6]=a):a=s[6],a}function t7(){return g.cg}try{t5.displayName||(t5.displayName="HiddenUnicodeBanner")}catch{}function t9({diffAnchor:e,children:t}){return(0,i.jsx)("div",{className:"fgColor-muted p-2","data-diff-anchor":e,children:t})}let ne=(0,l.memo)(function({searchResults:e,diffContext:t="pr",focusedSearchResult:n,diffEntryData:r,diffLinesManuallyUnhidden:l,baseHelpUrl:a,onHandleLoadDiff:s,copilotChatReference:o,hasExpandedAllRanges:d,...c}){let f=`diff-${r.pathDigest}`;return r.isBinary?(0,i.jsx)(t9,{diffAnchor:f,children:"Binary file not shown."}):(0,u.dK)(r)?(0,i.jsx)(t9,{diffAnchor:f,children:"File renamed without changes."}):(0,u.Jc)(r)?(0,i.jsx)(t9,{diffAnchor:f,children:"File copied without changes."}):(0,u.Sn)(r,r.status,r.oldTreeEntry?.mode,r.newTreeEntry?.mode)?(0,i.jsx)(t9,{diffAnchor:f,children:"File mode changed."}):!l&&(0,u.HI)(r)?(0,i.jsx)(_,{diffAnchor:f,onLoadDiff:s,children:(0,u.l_)(r.truncatedReason)}):(0,u.s8)(r)?(0,i.jsx)(t9,{diffAnchor:f,children:"Whitespace-only changes."}):!l&&(0,u.lO)(r)?(0,i.jsx)(_,{diffAnchor:f,onLoadDiff:s,children:"This file was deleted."}):!l&&(0,u.xW)(r)?(0,i.jsxs)(_,{diffAnchor:f,helpText:"customizing how changed files appear on GitHub.",helpUrl:`${a}/github/administering-a-repository/customizing-how-changed-files-appear-on-github`,onLoadDiff:s,children:["Some generated files are not rendered by default. Learn more about"," "]}):r.isTooBig&&0===r.diffLines.length?l?(0,i.jsxs)(t9,{diffAnchor:f,children:["Diff is too big to render. To view,"," ",(0,i.jsx)(h.A,{inline:!0,href:`${a}/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally`,children:"check out this pull request locally."})]}):(0,i.jsx)(_,{diffAnchor:f,onLoadDiff:s,children:"Large diffs are not rendered by default."}):r.diffLines?(0,i.jsx)(eF,{...c,children:(0,i.jsx)(S,{children:(0,i.jsx)(nt,{diffAnchor:f,diffContext:t,diffEntryData:r,viewerData:c.viewerData,focusedSearchResult:n,searchResults:e,copilotChatReference:o,hasExpandedAllRanges:d})})}):null});function nt({diffAnchor:e,viewerData:t,diffEntryData:n,searchResults:r,focusedSearchResult:a,copilotChatReference:s,diffContext:o,hasExpandedAllRanges:d}){let c=(0,l.useRef)(null),[u,h]=(0,l.useState)(!0),[p,x]=(0,l.useState)(null),[y,C]=(0,l.useState)(!1),v=n.newTreeEntry?.lineCount??n.oldTreeEntry?.lineCount??0,N=(0,l.useMemo)(()=>{let e=n.diffLines[n.diffLines.length-1];return e?.blobLineNumber&&e.blobLineNumber<v?n.diffLines.concat({__id:A.finalLineId,blobLineNumber:e.blobLineNumber+1,left:null,right:null,type:"HUNK",html:"",text:""}):n.diffLines},[n.diffLines,v]),{diffViewPreference:j,lineSpacingPreference:w,tabSizePreference:k}=t,{selectedDiffRowRange:S,replaceSelectedDiffRowRange:I,replaceSelectedDiffRowRangeFromGridCells:E,clearSelectedDiffRowRange:R,updateDiffLines:_,updateSelectedDiffRowRange:T}=L(),O=(0,l.useCallback)(e=>{if(!c.current||!e.target)return;let t=e.target,n=t.closest("td.diff-line-number"),i=c.current.contains(t);n&&!i&&(R(),B.current=null)},[R,c]);(0,l.useEffect)(()=>(g.XC?.addEventListener("mousedown",O),()=>{g.XC?.removeEventListener("mousedown",O)}),[O]);let M=e===S?.diffAnchor,$=(0,l.useMemo)(()=>{let e;let t=n.status,i=n.oldTreeEntry?.path,r=n.newTreeEntry?.path;if(i||r)return e="RENAMED"===t?`${i} renamed to ${r}`:"DELETED"===t||"REMOVED"===t?i:r,`Diff for: ${e}`},[n]);(0,l.useEffect)(()=>{if(!M)return;let e=(0,b.On)(S,N);e&&e!==S&&I(e)},[N,S,M,I]);let P=g.cg?.location.search,F=(0,l.useMemo)(()=>"split"===new URLSearchParams(P).get("diff")||"split"===j,[P,j]),U=(0,m.c7)(N),H=(0,l.useCallback)(e=>{x(e)},[x]),B=(0,l.useRef)(null),z=(0,l.useCallback)(e=>{if(e.shiftKey&&e.metaKey&&"ArrowLeft"===e.key&&!d&&u&&e.target?.getAttribute("role")==="gridcell"){let e=document.querySelector(`.js-expand-all-difflines-button[data-file-path="${n.path}"]`);e?.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0}))}},[d,u,n.path]),G=(0,l.useCallback)((t,n,i,r,l)=>{!function(e){let t=document.getElementById("__primerPortalRoot__");return!!t&&!!e&&t.contains(e)}(t.target)&&!t.defaultPrevented&&l&&T(e,n,i,r,l)},[e,T]),V=(0,l.useCallback)(e=>{let t=document.getSelection();if(t){let n=[];for(let e=0;e<t.rangeCount;e++){let i=t.getRangeAt(e).cloneContents();if(i.querySelectorAll("td").length){let e=`td.diff-line-number, span.diff-text-marker${F?`, ${"left"===p?"td.left-side-diff-cell":"td.right-side-diff-cell"}`:""}`;for(let t of i.querySelectorAll(e))t.parentNode&&t.parentNode.removeChild(t);for(let e of i.children){let t=e.textContent;"\n"===t?n.push(""):n.push(t)}}else 1===t.rangeCount?n.push(t.toString()):n.push(i.textContent)}e.clipboardData.setData("text/plain",n.join("\n")),e.preventDefault()}},[p,F]),W=(0,l.useMemo)(()=>N.some(e=>(0,t1.Y)(e.text)),[N]),K={searchResults:r,diffContext:o,focusedSearchResult:a,clearSelectedDiffRowRange:R,diffEntryId:n.objectId,diffHasHiddenUnicodeCharacters:W,diffLines:N,fileAnchor:e,fileLineCount:v,filePath:n.path,handleDiffRowClick:G,handleDiffSideCellSelectionBlocking:H,replaceSelectedDiffRowRangeFromGridCells:E,selectedDiffRowRange:M?S:null,showHiddenUnicode:y,tableRef:c,updateDiffLines:_,updateSelectedDiffRowRange:T,copilotChatReference:s,setInGridMode:h,inGridMode:u,firstLineNumberSelection:B};return(0,i.jsxs)(i.Fragment,{children:[W&&(0,i.jsx)(t5,{isShown:y,toggleShowHiddenCharacters:()=>C(!y)}),(0,i.jsx)("table",{"aria-label":$,onKeyDown:z,ref:c,className:(0,D.$)("tab-size","width-full",t6.tableLayoutFixed,{[t6.compact]:"compact"===w}),"data-block-diff-cell-selection":p,"data-diff-anchor":e,"data-tab-size":k,"data-paste-markdown-skip":!0,onCopy:V,role:"grid",style:{"--line-number-cell-width":`${U}px`,"--line-number-cell-width-unified":`${2*parseFloat(U)}px`},children:F?(0,i.jsx)(f.wj,{lineWidth:U,children:(0,i.jsx)(t4,{...K})}):(0,i.jsx)(f.Qe,{lineWidth:U,children:(0,i.jsx)(t3,{...K})})})]})}try{t9.displayName||(t9.displayName="PlainTextStatus")}catch{}try{ne.displayName||(ne.displayName="DiffLines")}catch{}try{nt.displayName||(nt.displayName="CodeDiffLines")}catch{}var nn=n(60281),ni=n(46309),nr=n(58599);let nl={filesActionList:"SubmoduleDiff-module__filesActionList--Uek7G",fileRowLinkItem:"SubmoduleDiff-module__fileRowLinkItem--ebKNW",path:"SubmoduleDiff-module__path--GK9U6",fileRow:"SubmoduleDiff-module__fileRow--ohBMr",linesAdded:"SubmoduleDiff-module__linesAdded--jgi_y",linesDeleted:"SubmoduleDiff-module__linesDeleted--C3uEX"};function na({submodule:e}){let{basePath:t,changedFiles:n,contentsUrl:r,newCommitOid:a,oldCommitOid:s,status:o,submoduleUrl:d}=e,c=e.summary.length>0&&e.contentsUrl&&"MODIFIED"===o,u=(0,l.useMemo)(()=>{switch(o){case"ADDED":return(0,i.jsx)(nd,{commitOid:a,contentsUrl:r,type:"added"});case"DELETED":case"REMOVED":return(0,i.jsx)(nd,{commitOid:s,contentsUrl:r,type:"deleted"});default:return(0,i.jsx)(nc,{newCommitOid:a,oldCommitOid:s,changedFiles:n,contentsUrl:r})}},[a,s,o,n,r]);return(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:`px-3 py-2 ${c?"border-bottom bgColor-muted":""}`,children:[(0,i.jsx)(R.FileSubmoduleIcon,{className:"fgColor-muted mr-2",size:16}),(0,i.jsx)(ns,{basePath:t,submoduleUrl:d}),u]}),c&&(0,i.jsx)(eO.l,{className:nl.filesActionList,showDividers:!0,variant:"full",children:e.summary.map(e=>(0,i.jsx)(nu,{compareUrl:`${r}/compare/${s}...${a}`,linesAdded:e.linesAdded,linesDeleted:e.linesDeleted,path:e.path,pathDigest:e.pathDigest,status:e.status},e.pathDigest))})]})}function ns({basePath:e,submoduleUrl:t}){return(0,i.jsxs)(i.Fragment,{children:["Submodule"," ",t?(0,i.jsx)(h.A,{inline:!0,href:t,children:e}):e," "]})}function no(e){return e.slice(0,7)}function nd({commitOid:e="",contentsUrl:t,type:n}){let r="added"===n?"added at":"deleted from";return t?(0,i.jsxs)(i.Fragment,{children:[r," ",(0,i.jsx)(h.A,{inline:!0,href:`${t}/tree/${e}`,children:no(e)})]}):(0,i.jsxs)(i.Fragment,{children:[r," ",no(e)]})}function nc({newCommitOid:e="",oldCommitOid:t="",changedFiles:n=0,contentsUrl:r}){let l=n>0&&r?`${n} ${1===n?"file":"files"}`:`from ${no(t)} to ${no(e)}`;return(0,i.jsxs)(i.Fragment,{children:["updated"," ",r?(0,i.jsx)(h.A,{inline:!0,href:`${r}/compare/${t}...${e}`,children:l}):l]})}function nu({compareUrl:e,linesAdded:t,linesDeleted:n,path:l,pathDigest:a,status:s}){return(0,i.jsx)(eO.l.LinkItem,{href:`${e}#diff-${a}`,className:nl.fileRowLinkItem,children:(0,i.jsxs)(ni.B,{gap:"condensed",direction:"horizontal",align:"center",className:nl.fileRow,children:[(0,i.jsx)(nr.E,{status:s}),(0,i.jsxs)("div",{className:"d-flex gap-1 flex-justify-between width-full",children:[(0,i.jsx)("span",{className:nl.path,children:l}),(t>0||n>0)&&(0,i.jsxs)("div",{className:"d-flex flex-shrink-0 gap-1 flex-nowrap",children:[(0,i.jsx)("div",{className:nl.linesAdded,children:t>0&&(0,i.jsxs)(r.C,{isAddition:!0,children:["+",nf(t)]})}),(0,i.jsx)("div",{className:nl.linesDeleted,children:n>0&&(0,i.jsxs)(r.C,{isAddition:!1,children:["-",nf(n)]})})]})]})]})})}function nf(e){return e>999?`${(e/1e3).toFixed(1)}k`:e.toLocaleString()}try{na.displayName||(na.displayName="SubmoduleDiff")}catch{}try{ns.displayName||(ns.displayName="SubmodulePath")}catch{}try{nd.displayName||(nd.displayName="SubmoduleCommitChange")}catch{}try{nc.displayName||(nc.displayName="SubmoduleModified")}catch{}try{nu.displayName||(nu.displayName="SubmoduleFileRow")}catch{}var nm=n(5796);let nh=({hasCopilotAccess:e,isBinary:t,isSubmodule:n,path:i,repository:r,status:l})=>!!e&&!t&&!n&&!!i&&"DELETED"!==l&&"REMOVED"!==l&&!!r.id&&!!r.name&&!!r.ownerLogin,np=({newCommitOid:e,newTreeEntry:t,oldCommitOid:n,oldTreeEntry:i,path:r,pathDigest:l,repository:a})=>{let s=n&&e?(0,nm.IO9)({repo:a,commitish:n,action:"raw",path:r}):"";return{baseFile:ng({path:i?.path,oid:n,repository:a}),headFile:ng({path:t?.path,oid:e,repository:a}),baseBranchRef:n,id:`#diff-${l}`,type:"file-diff",url:s}},ng=({path:e,oid:t,repository:n})=>e&&t?{type:"file",url:(0,nm.IO9)({repo:n,commitish:t,action:"raw",path:e}),path:e,repoID:n.id,repoName:n.name,repoOwner:n.ownerLogin,ref:t,commitOID:t}:null,nx=(0,l.forwardRef)(function({collapsed:e,commentingEnabled:t,commentBatchPending:n,commentingImplementation:a,currentUser:s,diffContext:o,diffLines:d,diffManuallyExpanded:u,diffMatches:f,diffSize:m,focusedSearchResult:h,helpUrl:p,isBinary:g,isSelected:x=!1,isSubmodule:b,isTooBig:y,leftSideContent:C,linesAdded:v,linesChanged:N,linesDeleted:j,initialExpandedThreadId:w,markerNavigationImplementation:L,newTreeEntry:k,newCommitOid:S,objectId:I,oldTreeEntry:E,oldCommitOid:R,onToggleCollapse:_,path:A,pathDigest:T,pullRequestState:O,pullRequest:M,repository:$,richDiff:P,rightSideContent:F,hasExpandedAllRanges:U,expandAllContextLines:H,canExpandOrCollapseLines:B,status:z,submodule:G,truncatedReason:V,addInjectedContextLines:W,loadDiff:K},q){let[X,J]=(0,l.useState)(P?.defaultToRichDiff),Y=b&&!!G,Q=!Y&&!X,[Z,ee]=(0,l.useState)(u),et=function({isBinary:e,isSubmodule:t,path:n,status:i,repository:r,newCommitOid:a,newTreeEntry:s,oldCommitOid:o,oldTreeEntry:d,pathDigest:c,hasCopilotAccess:u}){return(0,l.useMemo)(()=>{if(nh({isBinary:e,isSubmodule:t,path:n,status:i,repository:r,hasCopilotAccess:u}))return np({newCommitOid:a,newTreeEntry:s,oldCommitOid:o,oldTreeEntry:d,path:n,pathDigest:c,repository:r})},[a,s,o,d,c,r,u,e,t,n,i])}({isBinary:g,isSubmodule:b,path:A,status:z,repository:$,newCommitOid:S,newTreeEntry:k,oldCommitOid:R,oldTreeEntry:E,pathDigest:T,hasCopilotAccess:s.hasCopilotAccess}),en=async()=>{await K(),ee(!0)},ei=(0,l.useMemo)(()=>({avatarUrl:s?.avatarURL??"",diffViewPreference:s?.splitPreference,isSiteAdmin:!1,login:s?.login??"",lineSpacingPreference:s?.lineSpacing,tabSizePreference:s?.tabSize??8,viewerCanComment:s?.canComment,viewerCanApplySuggestion:s?.canApplySuggestion,commentsPreference:s?.commentsPreference}),[s]),er=(0,l.useId)(),el=`heading-${er}`;return(0,i.jsxs)("div",{role:"region",ref:q,"aria-labelledby":el,id:`diff-${T}`,className:(0,D.$)(nn.A.diffTargetable,nn.A.diff),"data-targeted":x,children:[(0,i.jsx)("div",{className:nn.A.diffHeaderWrapper,children:(0,i.jsx)(r.B,{headingId:el,areLinesExpanded:U,canExpandOrCollapseLines:B,fileLinkHref:`#diff-${T}`,isCollapsed:e,isBinary:g,size:m,canToggleRichDiff:P?.canToggleRichDiff,linesAdded:v,linesChanged:N,linesDeleted:j,newMode:k?.mode,newPath:k?.path,oldMode:E?.mode,oldPath:E?.path,patchStatus:z,path:A,onToggleExpandAllLines:H,onToggleFileCollapsed:t=>_(t,!e),onToggleDiffDisplay:e=>J(e),additionalLeftSideContent:C,rightSideContent:F,showRichDiff:X})}),e?null:(0,i.jsxs)("div",{className:"border position-relative rounded-bottom-2",children:[Y&&(0,i.jsx)(na,{submodule:G}),X&&(0,i.jsx)(c,{loading:!1,proseDiffHtml:P?.proseDiffHtml,fileRendererInfo:P?.renderInfo,dependencyDiffPath:P?.dependencyDiffPath}),Q&&(0,i.jsx)(ne,{hasExpandedAllRanges:U,diffContext:o,copilotChatReference:et,searchResults:f,focusedSearchResult:h,diffEntryData:{diffLines:d,isBinary:g,isTooBig:y,linesChanged:N,newTreeEntry:k,newCommitOid:S,objectId:I,oldTreeEntry:E,oldCommitOid:R,path:A,pathDigest:T,status:z,truncatedReason:V},baseHelpUrl:p,commentBatchPending:n,repositoryId:$.id.toString(),subject:{state:O},subjectId:M?.globalRelayId||"",viewerData:ei,newCommitOid:S,oldCommitOid:R,addInjectedContextLines:W,commentingEnabled:t||!1,commentingImplementation:a,initialExpandedThreadId:w,markerNavigationImplementation:L,diffLinesManuallyUnhidden:Z,onHandleLoadDiff:en})]})]},`${T}_${d.length}`)});function nb({path:e,pathDigest:t,linesAdded:n,linesChanged:a,linesDeleted:s,oldTreeEntry:o,newTreeEntry:d,status:c}){let u=(0,l.useId)(),f=`heading-${u}`,[m,h]=(0,l.useState)(!1);return(0,i.jsxs)("div",{role:"region","aria-labelledby":f,id:`diff-${t}`,className:(0,D.$)(nn.A.diffTargetable,nn.A.diff),children:[(0,i.jsx)("div",{className:nn.A.diffHeaderWrapper,children:(0,i.jsx)(r.B,{headingId:f,isCollapsed:m,isBinary:!1,linesAdded:n,linesChanged:a,linesDeleted:s,newMode:d?.mode,newPath:d?.path,oldMode:o?.mode,oldPath:o?.path,patchStatus:c,path:e,onToggleFileCollapsed:()=>h(!m)})}),!m&&(0,i.jsx)("div",{className:"border position-relative rounded-bottom-2",children:(0,i.jsxs)(ey.E,{children:[(0,i.jsx)(ey.E.Visual,{children:(0,i.jsx)(R.AlertIcon,{size:"medium",className:"fgColor-muted"})}),(0,i.jsx)(ey.E.Heading,{as:"h4",children:"There was an issue loading this file"}),(0,i.jsxs)(ey.E.Description,{children:[" ","Try refreshing the page or if the problem persists"," ",(0,i.jsx)("a",{className:"fgColor-muted",href:"https://support.github.com/",children:(0,i.jsx)("u",{children:"contact support"})}),"."]})]})})]},`${t}_error`)}let ny=(0,l.memo)(nx);try{nx.displayName||(nx.displayName="DiffUnmemoized")}catch{}try{nb.displayName||(nb.displayName="DiffErrorFallback")}catch{}try{ny.displayName||(ny.displayName="Diff")}catch{}var nC=n(9591);let nv={defaultStyles:"DiffFind-module__defaultStyles--gxyWR"};var nN=n(11499);let nj=(0,l.memo)(function({currentPathDigestIndex:e,searchTerm:t,searchResults:n,setSearchTerm:r,focusedSearchResult:a,currentIndex:s,setCurrentIndex:o,setFocusedSearchResult:d,scrollDiffCellIntoView:c}){let u=(0,l.useRef)([]),f=(0,l.useRef)(0),m=()=>{r(""),d(void 0),e.current=0},h=(0,i.jsxs)("div",{className:"d-flex flex-row flex-justify-center flex-items-center",children:[t&&(0,i.jsxs)("span",{className:"text-small fgColor-subtle mx-2 text-center",children:[0===n.size||void 0===a?0:s+1,"/",f.current]}),!t&&(0,i.jsx)("span",{className:"text-small fgColor-subtle mx-2 text-center pr-4",children:"\xa0"}),t&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(Z.K,{size:"small",variant:"invisible",onClick:()=>{p(-1)},icon:R.ChevronUpIcon,"aria-label":"Up","data-testid":"up-search"}),(0,i.jsx)(Z.K,{size:"small",variant:"invisible",onClick:()=>{p(1)},icon:R.ChevronDownIcon,"aria-label":"Down","data-testid":"down-search"})]})]}),p=t=>{if(void 0===a||""===a.pathDigest){e.current=0,d({pathDigest:u.current[0]??"",indexWithinDigest:0});return}1===t?(o(s===f.current-1?0:s+1),a.indexWithinDigest===n.get(a.pathDigest).length-1?(e.current=e.current+1,e.current===u.current.length&&(e.current=0),a.pathDigest=u.current[e.current]??"",a.indexWithinDigest=0):a.indexWithinDigest=a.indexWithinDigest+1):(o(0===s?f.current-1:s-1),0===a.indexWithinDigest?(e.current=e.current-1,-1===e.current&&(e.current=u.current.length-1),a.pathDigest=u.current[e.current]??"",a.indexWithinDigest=n.get(a.pathDigest).length-1):a.indexWithinDigest=a.indexWithinDigest-1),d(a)};return(0,l.useEffect)(()=>{u.current=Array.from(n.keys()),e.current=0,d({pathDigest:u.current[0]??"",indexWithinDigest:0});let t=0;for(let e of n.values())t+=e.length;f.current=t},[e,n,n.size,d]),(0,l.useEffect)(()=>{n.size>0&&void 0!==a&&c(a)},[n,a,s]),(0,i.jsxs)("div",{className:nv.defaultStyles,children:[(0,i.jsx)(nN.ak,{commands:{"pull-requests-diff-view:jump-to-next-result-alternate":()=>p(1),"pull-requests-diff-view:jump-to-previous-result-alternate":()=>p(-1)}}),(0,i.jsx)(nN.tL,{commands:{"pull-requests-diff-view:jump-to-next-result":()=>p(1),"pull-requests-diff-view:jump-to-previous-result":()=>p(-1)},children:(0,i.jsx)(nC.A,{className:"border-0 box-shadow-none",style:{width:"100%"},validationStatus:f.current>1e3?"error":void 0,type:"text",leadingVisual:()=>(0,i.jsx)(eb.A,{icon:R.SearchIcon,"aria-hidden":"true"}),autoComplete:"off",name:"Find in commit input","aria-label":"Search within code",placeholder:"Search within code",value:t,onChange:e=>{e.target.value?(r(e.target.value),o(0)):m()},block:!0,trailingAction:h})})]})});try{nj.displayName||(nj.displayName="DiffFind")}catch{}let nw=(0,l.createContext)({diffFindOpen:!1,setDiffFindOpen:()=>void 0});function nL({children:e,searchTerm:t,setSearchTerm:n}){let r=(0,l.useRef)(""),[a,s]=(0,l.useState)(!1),o=(0,l.useCallback)(e=>{e&&""===t&&""!==r.current?n(r.current):e||""===t||(r.current=t,n("")),s(e)},[t,n]),d=(0,l.useMemo)(()=>({diffFindOpen:a,setDiffFindOpen:o}),[a,o]);return(0,i.jsx)(nw.Provider,{value:d,children:e})}try{nw.displayName||(nw.displayName="DiffFindOpenContext")}catch{}try{nL.displayName||(nL.displayName="DiffFindOpenProvider")}catch{}var nk=n(73412),nS=n(93307);function nD({data:e}){let{query:t,diffEntryInfo:n,currentDiffEntryData:i}=e;return{matchingDiffs:i?function(e,t,n){if(0===n.size)return new Map;let i=n.size>=200,r={},l=e.reduce((n,i,l)=>{if(r[l])return n;r[l]=!0;let a=nR(t,[e[l]]),s=a.next();for(;!s.done&&n.size<200;){let{resultsWithinDiff:t}=s.value;n.set(e[l]?.pathDigest??"",t),s=a.next()}return n},new Map);if(l.size<200&&i){let n=nR(t,e,l.size),i=n.next();for(;!i.done&&l.size<200;){let{resultsWithinDiff:t,diff:r}=i.value;l.set(e[r]?.pathDigest??"",t),i=n.next()}}return l}(n,nE(t),i):function(e,t){let n=new Map,i=nR(t,e),r=i.next();for(;!r.done&&n.size<200;){let{resultsWithinDiff:t,diff:l}=r.value;n.set(e[l]?.pathDigest??"",t),r=i.next()}return n}(n,nE(t)),query:t}}let nI={Text:"Text"};function nE(e){let t=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{kind:nI.Text,regexp:RegExp(t,"gi")}}function*nR(e,t,n=0){for(let i=n;i<t.length;i++){let n=t[i],r=[],l=0;for(let a=0;a<n.diffLines.length;a++){let s,o;s=t[i]?.diffLines[a]?.type==="HUNK"?n.diffLines[a]?.text:n.diffLines[a]?.text?.substring(1);let d=n.diffLines[a];for(;s&&null!==(o=e.regexp.exec(s));){let e=o[0],t=o.index;r.push({pathDigest:n.pathDigest,indexWithinPathDigest:l,matchContent:e,column:t,diffLineNumIndex:a,isHunk:d?.type==="HUNK",hunkLineNumber:d?.blobLineNumber??-1,leftLineNumber:d?.type!=="ADDITION"?d?.left??-1:-1,rightLineNumber:d?.type!=="DELETION"?d?.right??-1:-1,columnEnd:t+e.length,text:s}),l++}}0!==r.length&&(yield{diff:i,resultsWithinDiff:r})}}function n_(e,t,n,i){let[r,a]=(0,l.useState)(new Map),[s,o]=(0,l.useState)(void 0),[d,c]=(0,l.useState)(0),u=l.useRef();!u.current&&t&&(u.current=new nS.N(new nk.z(n,nD),200,e=>1!==e.query.length));let f=(0,l.useRef)(t);f.current=t;let m=(0,l.useRef)("");(0,l.useEffect)(()=>function(){u.current?.terminate()},[]);let h=(0,l.useRef)([]);return u.current&&e!==h.current&&(u.current.onResponse=e=>{e.query===f.current&&(a(e.matchingDiffs),m.current=f.current)},h.current=e),(0,l.useEffect)(()=>{if(!e||!u.current||!m.current||""===m.current){a(new Map),o(void 0);return}a(new Map),o(void 0),u.current.post({query:m.current,diffEntryInfo:e,currentDiffEntryData:void 0})},[e?.length,e]),(0,l.useEffect)(()=>{if(e&&u.current){if(""===t)a(new Map),o(void 0),c(0),m.current="";else{if(!(t.length>0&&t.length<=1e3))return;let n=m.current.length>0&&t.startsWith(m.current);u.current.post({query:t,diffEntryInfo:e,currentDiffEntryData:n?r:void 0}),c(0)}}},[t,i]),{focusedSearchResult:s,setFocusedSearchResult:o,searchResults:r,currentIndex:d,setCurrentIndex:c}}},29063:(e,t,n)=>{n.d(t,{Dd:()=>c,ZD:()=>u,i8:()=>f,j$:()=>m,jU:()=>d,o9:()=>h,pd:()=>s,yI:()=>o});var i=n(4460),r=n(47584);function l(e){let t=e.match(/^#?(diff-[a-f0-9]+)(L|R)(\d+)(?:-(L|R)(\d+))?$/i);if(null!=t&&6===t.length)return t;let n=e.match(/^#?(discussion-diff-[0-9]+)(L|R)(\d+)(?:-(L|R)(\d+))?$/i);return null!=n&&6===n.length?n:null}function a(e,t){return`${"left"===t?"L":"R"}${e}`}function s(e){let t=e.match(/^#?(diff-[a-f0-9]+)/);return t?.[1]}function o(e){return!!(l(e)||l(`diff-${e}`))&&(e.includes("R")||e.includes("L"))}function d(e){if(!(s(e)||s(`diff-${e}`)))return;let t=e.replace("#","").replace("diff-","");return t.includes("-")&&(t=t.split("-")[0]??""),t.includes("L")&&(t=t.split("L")[0]??""),t.includes("R")&&(t=t.split("R")[0]??""),t}function c(e){let t=e.match(/^#?(r\d+)/),n=t?.[1];return n?parseInt(n.slice(1)):void 0}function u(e){let t=l(e);if(t){let e=t[1],n=t[2]?"L"===t[2]?"left":"right":void 0,i=t[3]?parseInt(t[3]):void 0;if(!e||!n||void 0===i)return;return{diffAnchor:e,startOrientation:n,startLineNumber:i,endOrientation:(t[4]?"L"===t[4]?"left":"right":void 0)??n,endLineNumber:(t[5]?parseInt(t[5]):void 0)??i,firstSelectedLineNumber:i,firstSelectedOrientation:n}}}function f(e){!function(e){let t=`#${e}`;if(t===window.location.hash)return;let n=window.location.href;(0,i.Zu)(t),window.dispatchEvent(new HashChangeEvent("hashchange",{newURL:window.location.href,oldURL:n}))}(m(e))}function m(e){let t=a(e.startLineNumber,e.startOrientation),n=`${e.diffAnchor}${t}`;if(e.endLineNumber!==e.startLineNumber||e.endOrientation!==e.startOrientation){let t=a(e.endLineNumber,e.endOrientation);n+=`-${t}`}return n}function h(){let e=l(r.fV.hash??"")??"";return(""===e?s(r.fV.hash??"")??"":e?.[0]??"").replace("#","").replace("diff-","")}},37109:(e,t,n)=>{n.d(t,{Av:()=>L,Ji:()=>m,Ls:()=>j,Mk:()=>p,On:()=>o,Po:()=>u,S4:()=>y,Yf:()=>k,ZC:()=>g,_S:()=>h,a1:()=>N,a2:()=>s,dT:()=>w,j2:()=>x,oE:()=>C,pI:()=>b,qK:()=>f,qX:()=>d,u6:()=>c});var i=n(67220),r=n(96884),l=n(54332),a=n(29063);function s(e,t,n){return"left"===n?!u(e)&&e.left===t:!u(e)&&(0,i.XU)(e.type)===n&&e.right===t}function o(e,t){if(!e)return;if(!t)return e;let n=!1,i=!1,r=!1;for(let l of t)if(l&&(i||(i=s(l,e.startLineNumber,e.startOrientation)),r||(r=s(l,e.endLineNumber,e.endOrientation)),(n=r&&!i)||i&&r))break;return n?{...e,startLineNumber:e.endLineNumber,startOrientation:e.endOrientation,endLineNumber:e.startLineNumber,endOrientation:e.startOrientation}:e}function d(e,t,n){let i=`-${u(t)||"number"!=typeof t.left?"empty":t.left}`,r=n?`-${u(n)||"number"!=typeof n.right?"empty":n.right}`:"";return`${e}${i}${r}`}function c(e,t){return`${e}-${t}`}function u(e){return!!e&&e===l.V}function f(e){return!!e&&e!==l.V}function m(e){return"CONTEXT"===e.type}function h(e,t){let n;switch(t){case"ADDITION":n="+";break;case"DELETION":n="-";break;case"CONTEXT":case"INJECTED_CONTEXT":n=" "}if(!n||!e.startsWith(n))return[e,void 0];let i=e[0];return[e.substring(1),i]}function p(e){let t=[],n=[],i=()=>{for(;t.length<n.length;)t.push(l.V);for(;n.length<t.length;)n.push(l.V)};for(let r of e)switch(r.type){case"ADDITION":n.push(r);break;case"DELETION":t.push(r);break;case"CONTEXT":case"INJECTED_CONTEXT":case"HUNK":i(),t.push(r),n.push(r)}return i(),{leftLines:t,rightLines:n}}function g(e){return new DOMParser().parseFromString(e,"text/html").documentElement.textContent||""}function x({line:e,range:t,fileAnchor:n}){let i;let{origin:r,pathname:l}=window.location;if(t?i=(0,a.j$)(t):e&&(i=function(e,t){let n=["HUNK","CONTEXT","INJECTED_CONTEXT","DELETION"].includes(e.type),i=n?e.left:e.right,r=n?"left":"right";if(null!==i)return(0,a.j$)({diffAnchor:t,endLineNumber:i,endOrientation:r,startLineNumber:i,startOrientation:r,firstSelectedLineNumber:i,firstSelectedOrientation:r})}(e,n)),i)return`${r}${l}#${i}`}function b({includeControlKey:e=!0,includeShiftKey:t,includeOptionKey:n,key:i}){let l=e?`${(0,r.U0)()?"\u2318":"Ctrl + "}`:"";return n&&(l+=`${(0,r.U0)()?"\u2325":"Alt + "}`),t&&(l+=`${(0,r.U0)()?"\u21E7":"Shift + "}`),l+=i}function y({hasThreads:e}){return e?"80px":"24px"}function C({includeControlKey:e=!0,includeShiftKey:t,includeOptionKey:n,key:i}){let l="";return e&&(l+=(0,r.U0)()?"Command+":"Control+"),n&&(l+=(0,r.U0)()?"Option+":"Alt+"),t&&(l+="Shift+"),l+=i}let v=["ADDITION","DELETION","CONTEXT"],N=(e,t)=>{if(!e)return!1;let n=t.leftLines.concat(t.rightLines);return n.length>0&&n.includes(e)?n.every(e=>!u(e)&&v.includes(e.type)):!u(e)&&v.includes(e.type)},j=e=>e?e.filter(e=>!u(e)).map(e=>{let[t]=h(g(e.html),e.type);return t}).join("\n"):"";function w(e){return!!(e.text.length<1&&("CONTEXT"===e.type||"INJECTED_CONTEXT"===e.type)||("DELETION"===e.type||"ADDITION"===e.type)&&1===e.text.length&&["+","-"].includes(e.text.charAt(0)))}let L=(e,t,n,i)=>{let r;if(e)return e;if(!u(t)){let e=(n?t.left:t.right)??0,l=n?"left":"right";r={startOrientation:l,endOrientation:l,startLineNumber:e,endLineNumber:e,firstSelectedLineNumber:e,firstSelectedOrientation:l,diffAnchor:i}}return r};function k(e,t=!1,n=!1){let i;switch(e){case"ADDITION":i=t?"var(--diffBlob-additionNum-bgColor, var(--diffBlob-addition-bgColor-num))":"var(--diffBlob-additionLine-bgColor, var(--diffBlob-addition-bgColor-line))";break;case"DELETION":i=t?"var(--diffBlob-deletionNum-bgColor, var(--diffBlob-deletion-bgColor-num))":"var(--diffBlob-deletionLine-bgColor, var(--diffBlob-deletion-bgColor-line))";break;case"HUNK":i=t?"var(--diffBlob-hunkNum-bgColor-rest, var(--diffBlob-hunk-bgColor-num))":"var(--diffBlob-hunkLine-bgColor, var(--bgColor-accent-muted))";break;case"EMPTY":i=t?"var(--diffBlob-emptyNum-bgColor, var(--diffBlob-hunk-bgColor-num))":"var(--diffBlob-emptyLine-bgColor, var(--bgColor-accent-muted))";break;default:i="var(--bgColor-default)"}return n?`color-mix(in oklab, var(--bgColor-accent-emphasis) 8%, ${i})`:i}},87592:(e,t,n)=>{n.d(t,{U:()=>a,l:()=>s});var i=n(96540),r=n(29063),l=n(47584);function a(){let[e,t]=(0,i.useState)(""),n=(0,i.useCallback)(()=>{t(((0,r.pd)(l.fV.hash??"")??"").replace("diff-",""))},[]);return(0,i.useEffect)(()=>(window.addEventListener("hashchange",n),n(),()=>{window.removeEventListener("hashchange",n)}),[n]),e}function s(){let[e,t]=(0,i.useState)(""),n=(0,i.useCallback)(()=>{t((0,r.o9)())},[]);return(0,i.useEffect)(()=>(window.addEventListener("hashchange",n),n(),()=>{window.removeEventListener("hashchange",n)}),[n]),e}},54332:(e,t,n)=>{n.d(t,{V:()=>i});let i="empty-diff-line"},80934:(e,t,n)=>{n.d(t,{U:()=>d});var i=n(21728),r=n(57572),l=n(97665),a=n(94747),s=n(86617),o=n(56176);function d(e){let t,n,r,o;let d=(0,i.c)(10),{onSuccess:u,onError:f}=e,m=(0,l.jE)();return d[0]!==m?(t=async e=>{m.setQueryData((0,s.nZ)(),t=>({...t,...e}))},d[0]=m,d[1]=t):t=d[1],d[2]!==u?(n=()=>{u()},d[2]=u,d[3]=n):n=d[3],d[4]!==f?(r=e=>{f(e)},d[4]=f,d[5]=r):r=d[5],d[6]!==t||d[7]!==n||d[8]!==r?(o={mutationFn:c,onMutate:t,onSuccess:n,onError:r},d[6]=t,d[7]=n,d[8]=r,d[9]=o):o=d[9],(0,a.n)(o)}async function c(e){let{commentsPreference:t,lineSpacing:n,splitPreference:i}=e;if(!(0,o.M3)())return;let l={};t&&(l={...l,commentsPreference:t}),n&&(l={...l,lineSpacing:n}),i&&(l={...l,diff:i});let a=await (0,r.Sr)("/users/diffview",{method:"POST",headers:{Accept:"application/json"},body:l}),s=await a.json();if(a.ok)return s;throw Error(s.error||"Unknown error occurred",{cause:a.status})}},86617:(e,t,n)=>{n.d(t,{C0:()=>m,Pe:()=>u,Qn:()=>h,bJ:()=>f,in:()=>d,nZ:()=>c,sI:()=>o});var i=n(21728),r=n(41281),l=n(97286),a=n(46928),s=n(4460);let o={Visible:"visible",Collapsed:"collapsed"},d={hideWhitespace:!1,splitPreference:"split",lineSpacing:"relaxed",commentsPreference:o.Visible};function c(){return[r.u.diffViewUserSettings]}function u(e){let t,n,r;let a=(0,i.c)(6);a[0]===Symbol.for("react.memo_cache_sentinel")?(t=c(),a[0]=t):t=a[0];let s=t;return a[1]!==e?(n=async()=>e||d,a[1]=e,a[2]=n):n=a[2],a[3]!==e||a[4]!==n?(r={queryKey:s,queryFn:n,initialData:e,staleTime:1/0},a[3]=e,a[4]=n,a[5]=r):r=a[5],(0,l.I)(r)}function f(e,t){let n=new URL(window.location.href,window.location.origin);if(t){let i=encodeURIComponent(t);n.searchParams.set(e,i)}else n.searchParams.delete(e);(0,s.bj)(n.toString())}function m(e){let t;let n=(0,i.c)(2),r=e,[l]=(0,a.o)();n[0]!==l?(t=l.get("diff"),n[0]=l,n[1]=t):t=n[1];let s=t;return("split"===s||"unified"===s)&&(r=s),r}function h(e){let t=e,[n]=(0,a.o)(),i=n.get("w");return"1"===i?t=!0:"0"===i&&(t=!1),t}},79658:(e,t,n)=>{n.d(t,{sI:()=>i});let i={Visible:"visible",Collapsed:"collapsed"}},55314:(e,t,n)=>{n.d(t,{A0:()=>a,TA:()=>d,Y:()=>c,_n:()=>u,rE:()=>s,t6:()=>o});let i=/[\u202A-\u202E]|[\u2066-\u2069]|\u{E0001}|\u{E007F}/u,r=/[\u202A-\u202E]|[\u2066-\u2069]|\u{E0001}|\u{E007F}/gu,l=/([\u202A-\u202E]|[\u2066-\u2069]|\u{E0001}|\u{E007F})/gu,a=new Map(Object.entries({"\u202A":"U+202A","\u202B":"U+202B","\u202C":"U+202C","\u202D":"U+202D","\u202E":"U+202E","\u2066":"U+2066","\u2067":"U+2067","\u2068":"U+2068","\u2069":"U+2069","\u{E0001}":"U+E0001","\u{E007F}":"U+E007F"}));function s(e){return`<span class="hidden-unicode-replacement" data-code-text="${e}"></span>`}function o(e){return e.split(l)}function d(e){return c(e)?e.replaceAll(r,e=>a.get(e)??""):e}function c(e){return i.test(e)}function u(e){return a.get(e)}},41281:(e,t,n)=>{n.d(t,{u:()=>i});let i={codeButton:"code_button",codeowners:"codeowners",commits:"commits",diffEntries:"diff_entries",diffstat:"diffstat",header:"header",mergeBox:"merge_box",mergeInstructions:"merge_instructions",pendingReview:"pending_review",statusChecks:"status_checks",tabCounts:"tab_counts",threadPreviews:"thread_previews",viewedFilesCount:"viewed_files_count",viewedFilesCount2:"viewed_files_count2",diffSummaries:"diff_summaries",diffViewUserSettings:"user_diff_view_settings",tableOfContents:"table_of_contents",markers:"markers",diffCollapsedStatus:"diff_collapsed_status",diffContextLines:"diff_context_lines",abandonReview:"abandon_review",addCommentReaction:"add_comment_reaction",changeBase:"change_base",cleanupCodespaces:"cleanup_codespaces",createReviewComment:"create_review_comment",deleteHeadRef:"delete_head_ref",dequeuePullRequest:"dequeue_pull_request",disableAutoMerge:"disable_auto_merge",enableAutoMerge:"enable_auto_merge",dismissReview:"dismiss_review",markReadyForReview:"mark_ready_for_review",merge:"merge",removeCommentReaction:"remove_comment_reaction",reRequestReviewFromUser:"re_request_review_from_user",restoreHeadRef:"restore_head_ref",resolveThread:"resolve_thread",runActionRequiredWorkflows:"run_action_required_workflows",submitReview:"submit_review",unresolveThread:"unresolve_thread",updateReviewComment:"update_review_comment",updatePullRequestBranch:"update_pull_request_branch",updateTitle:"update_title",updateDiffViewUserSettings:"update_diff_view_user_settings",updateViewedFiles:"update_viewed_files",updateMergeBoxUserPreference:"update_merge_box_user_preference",hideComment:"hide_comment",unhideComment:"unhide_comment",submitSuggestedChanges:"apply_suggestions"}},28448:(e,t,n)=>{n.d(t,{Z:()=>r});var i=n(96540);function r({focusRowRef:e,mouseRowRef:t}){let[n,r]=i.useState(!1);return i.useEffect(()=>{if(e.current&&t.current){let n=()=>{let t=e.current?.querySelector(".PRIVATE_TreeView-item-content-text");t?.scrollWidth!==t?.offsetWidth&&r(!0)};e.current.onfocus=()=>{n()},e.current.onblur=()=>{r(!1)},t.current.onmouseenter=()=>{n()},t.current.onmouseleave=()=>{r(!1)}}},[e,t]),n}},87292:(e,t,n)=>{n.d(t,{L:()=>r});var i=n(96540);function r(e){(0,i.useEffect)(()=>{if(!e)return;let t=document.querySelector(".footer");if(t)return t.hidden=!0,()=>{t.hidden=!1}},[e])}},62964:(e,t,n)=>{n.d(t,{q:()=>m});var i=n(74848),r=n(78026),l=n(61663),a=n(94232),s=n(96540),o=n(5796),d=n(57572);async function c(e,t){if(!t)return;let n=new FormData;n.set("file_tree_visible",e?"true":"false"),(0,d.DI)((0,o.h6D)(t),{method:"PUT",body:n,headers:{Accept:"application/json"}})}let u={sm:l.Gy.small,md:l.Gy.medium,lg:l.Gy.large},f={size:"medium",mobileBreakpoint:"md"};function m(e,t,n,o){let d={...f,...o},[m]=(0,a.I)(()=>!1,!0,[]),h=(0,s.useRef)(null),p=(0,s.useRef)(null),g=u[d.mobileBreakpoint??"md"],[x,b]=(0,s.useState)(t),[y,C]=(0,s.useState)(!1),v=(0,s.useCallback)(()=>{(0,l.nn)(window.innerWidth)<=g?(C(!0),requestAnimationFrame(()=>p.current?.focus())):(b(!0),c(!0,n),requestAnimationFrame(()=>h.current?.focus()))},[g,n]),N=(0,s.useCallback)(()=>{(0,l.nn)(window.innerWidth)<=g?(C(!1),requestAnimationFrame(()=>p.current?.focus())):(b(!1),c(!1,n),requestAnimationFrame(()=>h.current?.focus()))},[g,n]),j=(0,s.useMemo)(()=>(0,i.jsx)(r.L,{expanded:x,alignment:"left",ariaLabel:x?"Collapse file tree":"Expand file tree",tooltipDirection:"se",testid:"file-tree-button",ariaControls:e,ref:h,onToggleExpanded:()=>{x?N():v()},className:`d-none d-${d.mobileBreakpoint}-flex position-relative`,size:d.size}),[x,e,d.mobileBreakpoint,d.size,N,v]),w=(0,s.useMemo)(()=>(0,i.jsx)(r.L,{expanded:y,alignment:"left",ariaLabel:y?"Collapse file tree":"Expand file tree",tooltipDirection:"se",testid:"file-tree-button",ariaControls:e,ref:p,onToggleExpanded:()=>{y?N():v()},className:`d-${d.mobileBreakpoint}-none position-relative`,size:d.size}),[y,e,d.mobileBreakpoint,d.size,N,v]);return{splitPagePaneHidden:m&&!t,splitPageContentHidden:{narrow:y,regular:!1},isTreeExpanded:x,isMobileTreeExpanded:y,expandTree:v,collapseTree:N,treeToggleElement:(0,s.useMemo)(()=>(0,i.jsxs)(i.Fragment,{children:[w,j]}),[w,j]),treeToggleRef:h}}},96590:(e,t,n)=>{n.d(t,{$:()=>s});var i=n(74848),r=n(38621),l=n(15385),a=n(39298);let s=e=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.l.Divider,{}),(0,i.jsx)(a.t,{eventContext:{prx:!0},leadingVisual:(0,i.jsx)(r.CopilotIcon,{}),fileDiffReference:e.copilotChatReference})]});try{s.displayName||(s.displayName="CopilotDiffChatBlobActionsMenuItems")}catch{}},35149:(e,t,n)=>{n.d(t,{i:()=>o});var i=n(74848),r=n(91618),l=n(46988),a=n(67136),s=n(15385);let o=({fileDiffReference:e,eventContext:t,afterSelect:n})=>{let{addToast:o}=(0,a.Y6)();return(0,i.jsx)(s.l.Item,{onSelect:()=>{(0,r.Oc)(e),o({message:"Reference added to thread",type:"success"}),(0,l.BI)("copilot.file-diff.add",t),n?.()},children:"Attach to current thread"})};try{o.displayName||(o.displayName="DiffLinesAttachMenuItem")}catch{}},39298:(e,t,n)=>{n.d(t,{t:()=>o});var i=n(74848),r=n(91618),l=n(77342),a=n(46988),s=n(15385);let o=({fileDiffReference:e,leadingVisual:t,eventContext:n,afterSelect:o})=>(0,i.jsxs)(s.l.Item,{onSelect:()=>{(0,r.qR)({intent:l.wh.conversation,references:[e]}),(0,a.BI)("copilot.file-diff.discuss",n),o?.()},children:[t&&(0,i.jsx)(s.l.LeadingVisual,{children:t}),"Ask about this diff"]});try{o.displayName||(o.displayName="DiffLinesDiscussMenuItem")}catch{}},5993:(e,t,n)=>{n.d(t,{e:()=>o});var i=n(74848),r=n(91618),l=n(77342),a=n(46988),s=n(15385);let o=({fileDiffReference:e,eventContext:t,afterSelect:n})=>(0,i.jsx)(s.l.Item,{onSelect:()=>{(0,r.qR)({content:"Explain",intent:l.wh.explainFileDiff,references:[e]}),(0,a.BI)("copilot.file-diff.explain",t),n?.()},children:"Explain"});try{o.displayName||(o.displayName="DiffLinesExplainMenuItem")}catch{}},10712:(e,t,n)=>{n.d(t,{oj:()=>v,ZH:()=>x});var i=n(74848),r=n(21728),l=n(38621),a=n(96540),s=n(61003),o=n(34614),d=n(7284),c=n(26920),u=n(58599),f=n(28448),m=n(29063),h=n(47584);let p={"file-tree-row":"DiffFileTree-module__file-tree-row--yr73E"},g=(0,a.memo)(function(e){let t;let n=(0,r.c)(2),{changeType:l}=e;return n[0]!==l?(t=(0,i.jsx)(u.E,{status:l}),n[0]=l,n[1]=t):t=n[1],t});g.displayName="FileStatusIconItem";let x=(0,a.memo)(function(e){let t,n,c,u,m,x,b,y,C,v;let N=(0,r.c)(44),{file:j,depth:w,hash:L,onSelect:k}=e,S=(0,a.useRef)(null),D=(0,a.useRef)(null),I=`#diff-${j.diff.pathDigest}`;N[0]===Symbol.for("react.memo_cache_sentinel")?(t={focusRowRef:S,mouseRowRef:S},N[0]=t):t=N[0];let E=(0,f.Z)(t),R=j.diff.totalCommentsCount??0,_=j.diff.highestAnnotationLevel,A=null,T=null;switch(_){case"WARNING":{let e,t;let n=R>0?"and ":"";N[1]!==n?(e=(0,i.jsxs)("span",{className:"sr-only",children:[n," has warning annotations"]}),N[1]=n,N[2]=e):e=N[2],T=e,N[3]===Symbol.for("react.memo_cache_sentinel")?(t=(0,i.jsx)("div",{className:"pl-1 fgColor-attention",children:(0,i.jsx)(l.AlertIcon,{})}),N[3]=t):t=N[3],A=t;break}case"NOTICE":{let e,t;let n=R>0?"and ":"";N[4]!==n?(e=(0,i.jsxs)("span",{className:"sr-only",children:[n," has notice annotations"]}),N[4]=n,N[5]=e):e=N[5],T=e,N[6]===Symbol.for("react.memo_cache_sentinel")?(t=(0,i.jsx)("div",{className:"pl-1 fgColor-default",children:(0,i.jsx)(l.InfoIcon,{})}),N[6]=t):t=N[6],A=t;break}case"FAILURE":{let e,t;let n=R>0?"and ":"";N[7]!==n?(e=(0,i.jsxs)("span",{className:"sr-only",children:[n," has failure annotations"]}),N[7]=n,N[8]=e):e=N[8],T=e,N[9]===Symbol.for("react.memo_cache_sentinel")?(t=(0,i.jsx)("div",{className:"pl-1 fgColor-danger",children:(0,i.jsx)(l.XCircleFillIcon,{})}),N[9]=t):t=N[9],A=t}}N[10]!==j.diff.pathDigest||N[11]!==L?(n=()=>{if(S.current&&j.diff.pathDigest===L){let e=window.setTimeout(()=>{let e=h.XC?.getElementById("diff_file_tree")?.parentElement,t=S.current.offsetTop,n=h.cg?.innerHeight??0;e&&(e.scrollTop=t-n/2)},0);return()=>{window.clearTimeout(e)}}},c=[j.diff.pathDigest,L],N[10]=j.diff.pathDigest,N[11]=L,N[12]=n,N[13]=c):(n=N[12],c=N[13]),(0,a.useEffect)(n,c),N[14]!==I||N[15]!==j.diff||N[16]!==k?(u=e=>{if(e.nativeEvent instanceof KeyboardEvent){if(S?.current!==document.activeElement){e.preventDefault();return}if("Enter"===e.key||" "===e.key){e.preventDefault(),k?.(j.diff),D?.current?.click();return}}if(e.nativeEvent instanceof MouseEvent){if(e.metaKey||e.ctrlKey||1===e.button){e.preventDefault(),window.open(I,"_blank");return}k?.(j.diff),D?.current?.click()}},N[14]=I,N[15]=j.diff,N[16]=k,N[17]=u):u=N[17];let O=u,M=j.diff.pathDigest===L;return N[18]!==j.diff.changeType?(m=(0,i.jsx)(s.G.LeadingVisual,{children:(0,i.jsx)(g,{changeType:j.diff.changeType})}),N[18]=j.diff.changeType,N[19]=m):m=N[19],N[20]!==I||N[21]!==j.fileName?(x=(0,i.jsx)(o.A,{href:I,muted:!0,ref:D,role:"presentation",className:"fgColor-default",tabIndex:-1,"data-analytics-opt-out":!0,children:j.fileName}),N[20]=I,N[21]=j.fileName,N[22]=x):x=N[22],N[23]!==j.fileName||N[24]!==E?(b=E&&(0,i.jsx)(d.m,{"data-testid":`${j.fileName}-item-tooltip`,id:`${j.fileName}-item-tooltip`,contentRef:S,"aria-label":j.fileName,open:!0,direction:"ne"}),N[23]=j.fileName,N[24]=E,N[25]=b):b=N[25],N[26]!==R?(y=!!R&&(0,i.jsxs)("span",{className:"sr-only",children:["has ",R<10?R:"9+"," ",R>1?"comments":"comment"]}),N[26]=R,N[27]=y):y=N[27],N[28]!==A||N[29]!==_||N[30]!==R?(C=(!!R||_)&&(0,i.jsx)(s.G.TrailingVisual,{children:(0,i.jsxs)("div",{className:"d-flex flex-items-center flex-row",children:[!!R&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.CommentIcon,{}),(0,i.jsx)("div",{className:"ml-1 text-bold fgColor-default f6",children:R<10?R:"9+"})]}),A]})}),N[28]=A,N[29]=_,N[30]=R,N[31]=C):C=N[31],N[32]!==T||N[33]!==w||N[34]!==j.diff.path||N[35]!==j.diff.pathDigest||N[36]!==O||N[37]!==C||N[38]!==M||N[39]!==m||N[40]!==x||N[41]!==b||N[42]!==y?(v=(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(s.G.Item,{defaultExpanded:!0,"aria-level":w,current:M,id:j.diff.path,onSelect:O,ref:S,className:p["file-tree-row"],children:[m,x,b,y,T,C]},j.diff.pathDigest)}),N[32]=T,N[33]=w,N[34]=j.diff.path,N[35]=j.diff.pathDigest,N[36]=O,N[37]=C,N[38]=M,N[39]=m,N[40]=x,N[41]=b,N[42]=y,N[43]=v):v=N[43],v});function b(e){let t,n,l,o,c,u,m,h,p,g,x,v;let N=(0,r.c)(43);N[0]!==e?({directory:t,renderPattern:l,depth:o,leadingPath:c,...n}=e,N[0]=e,N[1]=t,N[2]=n,N[3]=l,N[4]=o,N[5]=c):(t=N[1],n=N[2],l=N[3],o=N[4],c=N[5]);let j=void 0===o?0:o,w=void 0===c?"":c,L=w?`${w}/`:"",k=a.useRef(null),S=a.useRef(null);N[6]===Symbol.for("react.memo_cache_sentinel")?(u={focusRowRef:S,mouseRowRef:k},N[6]=u):u=N[6];let D=(0,f.Z)(u);if(!t.files.length&&1===t.directories.length){let e,r;if(N[7]!==j||N[8]!==t.directories||N[9]!==t.name||N[10]!==n||N[11]!==L||N[12]!==l){let r;N[14]!==j||N[15]!==t.name||N[16]!==n||N[17]!==L||N[18]!==l?(r=e=>(0,i.jsx)(b,{depth:0===j?1:j,directory:e,leadingPath:`${L}${t.name}`,renderPattern:l,...n},e.path),N[14]=j,N[15]=t.name,N[16]=n,N[17]=L,N[18]=l,N[19]=r):r=N[19],e=t.directories.map(r),N[7]=j,N[8]=t.directories,N[9]=t.name,N[10]=n,N[11]=L,N[12]=l,N[13]=e}else e=N[13];return N[20]!==e?(r=(0,i.jsx)(i.Fragment,{children:e}),N[20]=e,N[21]=r):r=N[21],r}N[22]!==j||N[23]!==t||N[24]!==n||N[25]!==l?(m=function(){return"traditional"===l?(0,i.jsx)(y,{directory:t,depth:j,renderPattern:l,...n}):(0,i.jsx)(C,{directory:t,depth:j,renderPattern:l,...n})},N[22]=j,N[23]=t,N[24]=n,N[25]=l,N[26]=m):m=N[26];let I=m;if(0===j){let e;return N[27]!==I?(e=I(),N[27]=I,N[28]=e):e=N[28],e}N[29]===Symbol.for("react.memo_cache_sentinel")?(h=(0,i.jsx)(s.G.LeadingVisual,{children:(0,i.jsx)(s.G.DirectoryIcon,{})}),N[29]=h):h=N[29];let E=`${L}${t.name}`;return N[30]!==E?(p=(0,i.jsx)("span",{ref:k,children:E}),N[30]=E,N[31]=p):p=N[31],N[32]!==t.name||N[33]!==L||N[34]!==D?(g=D&&(0,i.jsx)(d.m,{"data-testid":`${t.name}-directory-item-tooltip`,id:`${t.name}-directory-item-tooltip`,contentRef:S,"aria-label":`${L}${t.name}`,open:!0,direction:"ne"}),N[32]=t.name,N[33]=L,N[34]=D,N[35]=g):g=N[35],N[36]!==I?(x=(0,i.jsx)(s.G.SubTree,{children:I()}),N[36]=I,N[37]=x):x=N[37],N[38]!==t.path||N[39]!==p||N[40]!==g||N[41]!==x?(v=(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(s.G.Item,{ref:S,defaultExpanded:!0,id:t.path,children:[h,p,g,x]},t.path)}),N[38]=t.path,N[39]=p,N[40]=g,N[41]=x,N[42]=v):v=N[42],v}let y=(0,a.memo)(function(e){let t,n,l,a,s,o,d;let c=(0,r.c)(20);c[0]!==e?({directory:t,fileNodeRenderer:n,renderPattern:a,depth:s,...l}=e,c[0]=e,c[1]=t,c[2]=n,c[3]=l,c[4]=a,c[5]=s):(t=c[1],n=c[2],l=c[3],a=c[4],s=c[5]);let u=void 0===s?0:s;if(c[6]!==u||c[7]!==t.directories||c[8]!==t.files||c[9]!==n||c[10]!==l||c[11]!==a){let e;let r=t.files.map(N).concat(t.directories.map(j));r.sort(w),c[13]!==u||c[14]!==n||c[15]!==l||c[16]!==a?(e=e=>"file"!==e.pathType?(0,i.jsx)(b,{depth:u+1,directory:e.node,fileNodeRenderer:n,renderPattern:a,...l},e.path):n?n({...l,file:e.node,depth:u+1}):(0,i.jsx)(x,{depth:u+1,file:e.node,...l},e.path),c[13]=u,c[14]=n,c[15]=l,c[16]=a,c[17]=e):e=c[17],o=r.map(e),c[6]=u,c[7]=t.directories,c[8]=t.files,c[9]=n,c[10]=l,c[11]=a,c[12]=o}else o=c[12];return c[18]!==o?(d=(0,i.jsx)(i.Fragment,{children:o}),c[18]=o,c[19]=d):d=c[19],d});function C(e){let t,n,l,a,s,o;let d=(0,r.c)(21);d[0]!==e?({directory:t,depth:l,...n}=e,d[0]=e,d[1]=t,d[2]=n,d[3]=l):(t=d[1],n=d[2],l=d[3]);let c=void 0===l?0:l;if(d[4]!==c||d[5]!==t.files||d[6]!==n){let e;d[8]!==c||d[9]!==n?(e=e=>(0,i.jsx)(x,{depth:c+1,file:e,...n},e.filePath),d[8]=c,d[9]=n,d[10]=e):e=d[10],a=t.files.map(e),d[4]=c,d[5]=t.files,d[6]=n,d[7]=a}else a=d[7];if(d[11]!==c||d[12]!==t.directories||d[13]!==n){let e;d[15]!==c||d[16]!==n?(e=e=>(0,i.jsx)(b,{depth:c+1,directory:e,...n},e.path),d[15]=c,d[16]=n,d[17]=e):e=d[17],s=t.directories.map(e),d[11]=c,d[12]=t.directories,d[13]=n,d[14]=s}else s=d[14];return d[18]!==a||d[19]!==s?(o=(0,i.jsxs)(i.Fragment,{children:[a,s]}),d[18]=a,d[19]=s,d[20]=o):o=d[20],o}let v=(0,a.memo)(function(e){let t,n,l,o,d,u,f,p,g,x,y;let C=(0,r.c)(20);C[0]!==e?({diffs:n,fileNodeRenderer:l,renderPattern:d,className:t,...o}=e,C[0]=e,C[1]=t,C[2]=n,C[3]=l,C[4]=o,C[5]=d):(t=C[1],n=C[2],l=C[3],o=C[4],d=C[5]),C[6]!==n?(u=(0,c.xY)(n),C[6]=n,C[7]=u):u=C[7];let v=u,[N,j]=a.useState("");C[8]===Symbol.for("react.memo_cache_sentinel")?(f=()=>{j(((0,m.pd)(h.fV.hash??"")??"").replace("diff-",""))},C[8]=f):f=C[8];let w=f;return C[9]===Symbol.for("react.memo_cache_sentinel")?(p=()=>(window.addEventListener("hashchange",w),w(),()=>{window.removeEventListener("hashchange",w)}),g=[w],C[9]=p,C[10]=g):(p=C[9],g=C[10]),(0,a.useEffect)(p,g),C[11]!==l||C[12]!==o||C[13]!==v||C[14]!==N||C[15]!==d?(x=(0,i.jsx)(b,{directory:v,fileNodeRenderer:l,renderPattern:d,...o,hash:N}),C[11]=l,C[12]=o,C[13]=v,C[14]=N,C[15]=d,C[16]=x):x=C[16],C[17]!==t||C[18]!==x?(y=(0,i.jsx)(s.G,{"aria-label":"File Tree",className:t,children:x}),C[17]=t,C[18]=x,C[19]=y):y=C[19],y});try{x.displayName||(x.displayName="File")}catch{}try{b.displayName||(b.displayName="Directory")}catch{}try{y.displayName||(y.displayName="TraditionalDirectoryRendering")}catch{}try{C.displayName||(C.displayName="GroupedDirectoryRendering")}catch{}try{v.displayName||(v.displayName="DiffFileTree")}catch{}function N(e){return{path:e.filePath,pathType:"file",node:e}}function j(e){return{path:e.path,pathType:"directory",node:e}}function w(e,t){return(0,c.wH)(e.path,t.path)}},3240:(e,t,n)=>{n.d(t,{kF:()=>g,F7:()=>p});var i,r=n(74848),l=n(21728),a=n(38621),s=n(9591),o=n(89323),d=n(87330),c=n(63867),u=n(15385),f=n(96540),m=n(34164);let h={filterLoadingHeight:"FileFilter-module__filterLoadingHeight--cW8BP",filterMaxHeight:"FileFilter-module__filterMaxHeight--TgM5t"},p="No extension";function g({filterSize:e="medium",filterText:t,onFilterTextChange:n,fileExtensions:i,unselectedFileExtensions:l,onFilterChange:c,additionalFilterGroups:g}){i=i??{},l=l??new Set;let[x,b]=(0,f.useState)(t),y=(e,t)=>{c?.(e?"selectFileExtension":"unselectFileExtension",{extension:t})},C=Object.keys(i).filter(e=>e!==p).sort(),v=e=>!l.has(e),N=!!i[p];return(0,r.jsxs)("div",{className:"d-flex flex-nowrap gap-2",children:[(0,r.jsx)(s.A,{block:!0,"aria-label":"Filter files\u2026",leadingVisual:a.SearchIcon,placeholder:"Filter files\u2026",size:e,className:(0,m.$)("small"===e&&h.filterMaxHeight),value:x,onChange:e=>{b(e.target.value),n?.(e.target.value)}}),(0,r.jsxs)(o.W,{children:[(0,r.jsx)(o.W.Anchor,{children:(0,r.jsx)(d.K,{"aria-label":"Filter options",icon:a.SlidersIcon,className:"flex-shrink-0",size:e})}),(0,r.jsx)(o.W.Overlay,{children:(0,r.jsxs)(u.l,{children:[(0,r.jsxs)(u.l.Group,{selectionVariant:"multiple",children:[(0,r.jsx)(u.l.GroupHeading,{children:"File extensions"}),C.map(e=>{let t=v(e);return(0,r.jsx)(u.l.Item,{selected:t,onSelect:()=>y(!t,e),children:`${e} (${i[e]})`},e)}),N&&(0,r.jsx)(u.l.Item,{selected:v(p),onSelect:()=>y(!v(p),p),children:`${p} (${i[p]})`},p)]}),g]})})]})]})}try{(i=function(e){let t,n,i,u,f;let p=(0,l.c)(9),{filterText:g,onFilterTextChange:x}=e;return p[0]!==x?(t=e=>x?.(e.target.value),p[0]=x,p[1]=t):t=p[1],p[2]!==g||p[3]!==t?(n=(0,r.jsx)(s.A,{block:!0,"aria-label":"Filter files\u2026",leadingVisual:a.SearchIcon,placeholder:"Filter files\u2026",value:g,onChange:t}),p[2]=g,p[3]=t,p[4]=n):n=p[4],p[5]===Symbol.for("react.memo_cache_sentinel")?(i=(0,r.jsx)(o.W.Anchor,{children:(0,r.jsx)(d.K,{"aria-label":"Filter options",icon:a.SlidersIcon,className:"flex-shrink-0"})}),p[5]=i):i=p[5],p[6]===Symbol.for("react.memo_cache_sentinel")?(u=(0,r.jsxs)(o.W,{children:[i,(0,r.jsx)(o.W.Overlay,{className:(0,m.$)(h.filterLoadingHeight),children:(0,r.jsx)("div",{className:(0,m.$)("d-flex","flex-column","flex-justify-center","flex-items-center",h.filterLoadingHeight),children:(0,r.jsx)(c.A,{size:"medium"})})})]}),p[6]=u):u=p[6],p[7]!==n?(f=(0,r.jsxs)("div",{className:"d-flex flex-nowrap gap-2",children:[n,u]}),p[7]=n,p[8]=f):f=p[8],f}).displayName||(i.displayName="FileFilterLoading")}catch{}try{g.displayName||(g.displayName="FileFilterShared")}catch{}},58599:(e,t,n)=>{n.d(t,{E:()=>a});var i=n(74848),r=n(21728),l=n(38621);function a(e){let t=(0,r.c)(4),{status:n}=e;switch(n){case"ADDED":case"COPIED":{let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,i.jsx)(l.FileAddedIcon,{size:16,className:"fgColor-success"}),t[0]=e):e=t[0],e}case"DELETED":case"REMOVED":{let e;return t[1]===Symbol.for("react.memo_cache_sentinel")?(e=(0,i.jsx)(l.FileRemovedIcon,{size:16,className:"fgColor-danger"}),t[1]=e):e=t[1],e}case"RENAMED":{let e;return t[2]===Symbol.for("react.memo_cache_sentinel")?(e=(0,i.jsx)(l.FileMovedIcon,{size:16,className:"fgColor-attention"}),t[2]=e):e=t[2],e}default:{let e;return t[3]===Symbol.for("react.memo_cache_sentinel")?(e=(0,i.jsx)(l.FileDiffIcon,{size:16,className:"fgColor-muted"}),t[3]=e):e=t[3],e}}}try{a.displayName||(a.displayName="FileStatusIcon")}catch{}},57442:(e,t,n)=>{n.d(t,{G:()=>$});var i=n(74848),r=n(21728),l=n(38621),a=n(89323),s=n(15385),o=n(34164),d=n(84217),c=n(55847),u=n(98939),f=n(96540),m=n(56176),h=n(5796),p=n(86365),g=n(57572);function x(e){return!e.dismissed}function b(e){return 0===(function(){let e,t;let n=(0,r.c)(5),i=(0,p.B)();if(!i){let e;return n[0]===Symbol.for("react.memo_cache_sentinel")?(e=[],n[0]=e):e=n[0],e}n[1]!==i.userNotices?(e=i.userNotices??[],n[1]=i.userNotices,n[2]=e):e=n[2];let l=e;return n[3]!==l?(t=l.filter(x),n[3]=l,n[4]=t):t=n[4],t})().filter(t=>t.name===e).length}var y=n(80934);let C="compact_diff_lines";function v(){let e,t,n,l,a,s,o,p,x,v,w,L,k;let S=(0,r.c)(22),D=b(C),{dismissNotice:I}=function(e){let t,n;let i=(0,r.c)(5),l=b(e);i[0]!==l||i[1]!==e?(t=()=>{(0,m.M3)()&&!l&&(0,g.DI)((0,h.VB1)({noticeName:e}),{method:"POST"})},i[0]=l,i[1]=e,i[2]=t):t=i[2];let a=t;return i[3]!==a?(n={dismissNotice:a},i[3]=a,i[4]=n):n=i[4],n}(C);S[0]===Symbol.for("react.memo_cache_sentinel")?(e={onSuccess:j,onError:N},S[0]=e):e=S[0];let{mutate:E}=(0,y.U)(e),[R,_]=(0,f.useState)(!0);S[1]!==I||S[2]!==E?(t=()=>{E({lineSpacing:"compact"}),_(!1),I()},S[1]=I,S[2]=E,S[3]=t):t=S[3];let A=t;S[4]!==I?(n=()=>{_(!1),I()},S[4]=I,S[5]=n):n=S[5];let T=n;return D?null:(S[6]===Symbol.for("react.memo_cache_sentinel")?(l={top:"60px",right:"-4px"},S[6]=l):l=S[6],S[7]===Symbol.for("react.memo_cache_sentinel")?(a={minWidth:"260px",width:"40%"},S[7]=a):a=S[7],S[8]===Symbol.for("react.memo_cache_sentinel")?(s=(0,i.jsx)(d.A,{sx:{fontSize:2},as:"h2",children:"Customizable line height"}),o=(0,i.jsx)("p",{children:"The default line height has been increased for improved accessibility. You can choose to enable a more compact line height from the view settings menu."}),S[8]=s,S[9]=o):(s=S[8],o=S[9]),S[10]===Symbol.for("react.memo_cache_sentinel")?(p={flexShrink:0,flexGrow:1},S[10]=p):p=S[10],S[11]!==A?(x=(0,i.jsx)(c.Q,{onClick:A,sx:p,children:"Enable compact line height"}),S[11]=A,S[12]=x):x=S[12],S[13]===Symbol.for("react.memo_cache_sentinel")?(v={color:"accent.fg",flexGrow:1},S[13]=v):v=S[13],S[14]!==T?(w=(0,i.jsx)(c.Q,{onClick:T,variant:"invisible",sx:v,alignContent:"center",children:"Dismiss"}),S[14]=T,S[15]=w):w=S[15],S[16]!==w||S[17]!==x?(L=(0,i.jsxs)(u.A.Content,{className:"d-flex flex-column gap-2",sx:a,children:[s,o,(0,i.jsxs)("div",{className:"d-flex gap-2 flex-row w-full flex-wrap",children:[x,w]})]}),S[16]=w,S[17]=x,S[18]=L):L=S[18],S[19]!==R||S[20]!==L?(k=(0,i.jsx)(u.A,{open:R,caret:"top-right",sx:l,children:L}),S[19]=R,S[20]=L,S[21]=k):k=S[21],k)}function N(){}function j(){}try{v.displayName||(v.displayName="DiffCompactLinesPopover")}catch{}var w=n(86617),L=n(97665);function k(e){let t,n,l,a,o;let d=(0,r.c)(15),{lineSpacingPreferenceAvailable:c,reloadOnChange:u}=e,f=void 0===c||c,m=void 0!==u&&u,{data:h}=(0,w.Pe)();d[0]===Symbol.for("react.memo_cache_sentinel")?(t={onSuccess:D,onError:S},d[0]=t):t=d[0];let{mutate:p}=(0,y.U)(t),g=(0,L.jE)();d[1]!==h||d[2]!==g||d[3]!==m?(n=()=>{h&&(g.setQueryData((0,w.nZ)(),e=>({...e,hideWhitespace:!h.hideWhitespace})),(0,w.bJ)("w",h.hideWhitespace?"0":"1"),m&&window.location.reload())},d[1]=h,d[2]=g,d[3]=m,d[4]=n):n=d[4];let x=n;return h?(d[5]!==h.hideWhitespace||d[6]!==x?(l=(0,i.jsx)(s.l.Item,{selected:h.hideWhitespace,onSelect:x,children:"Hide whitespace"}),d[5]=h.hideWhitespace,d[6]=x,d[7]=l):l=d[7],d[8]!==h.lineSpacing||d[9]!==f||d[10]!==p?(a=f&&(0,i.jsx)(s.l.Item,{selected:"compact"===h.lineSpacing,onSelect:()=>p({lineSpacing:"compact"===h.lineSpacing?"relaxed":"compact"}),children:"Compact line height"}),d[8]=h.lineSpacing,d[9]=f,d[10]=p,d[11]=a):a=d[11],d[12]!==l||d[13]!==a?(o=(0,i.jsxs)(s.l.Group,{"aria-label":"Format",selectionVariant:"multiple",variant:"subtle",children:[l,a]}),d[12]=l,d[13]=a,d[14]=o):o=d[14],o):null}function S(){}function D(){}try{k.displayName||(k.displayName="DiffLinePresentationToggles")}catch{}function I(e){let t,n,l,a,o,d,c;let u=(0,r.c)(17),{reloadOnChange:f}=e,m=void 0!==f&&f,{data:h}=(0,w.Pe)(),p=h?.splitPreference;u[0]===Symbol.for("react.memo_cache_sentinel")?(t={onSuccess:R,onError:E},u[0]=t):t=u[0];let{mutate:g}=(0,y.U)(t);u[1]===Symbol.for("react.memo_cache_sentinel")?(n=(0,i.jsx)(s.l.GroupHeading,{children:"Layout"}),u[1]=n):n=u[1];let x="unified"===p;u[2]!==m||u[3]!==g?(l=()=>{g({splitPreference:"unified"}),(0,w.bJ)("diff","unified"),m&&window.location.reload()},u[2]=m,u[3]=g,u[4]=l):l=u[4],u[5]!==x||u[6]!==l?(a=(0,i.jsx)(s.l.Item,{selected:x,onSelect:l,children:"Unified"}),u[5]=x,u[6]=l,u[7]=a):a=u[7];let b="split"===p;return u[8]!==m||u[9]!==g?(o=()=>{g({splitPreference:"split"}),(0,w.bJ)("diff","split"),m&&window.location.reload()},u[8]=m,u[9]=g,u[10]=o):o=u[10],u[11]!==b||u[12]!==o?(d=(0,i.jsx)(s.l.Item,{selected:b,onSelect:o,children:"Split"}),u[11]=b,u[12]=o,u[13]=d):d=u[13],u[14]!==a||u[15]!==d?(c=(0,i.jsxs)(s.l.Group,{selectionVariant:"single",children:[n,a,d]}),u[14]=a,u[15]=d,u[16]=c):c=u[16],c}function E(){}function R(){}try{I.displayName||(I.displayName="DiffViewPreferenceToggle")}catch{}var _=n(46584),A=n(79658);function T(){let e,t,n,l;let a=(0,r.c)(8),{diff_inline_comments:o,prx_files:d}=(0,_.h)(),{data:c}=(0,w.Pe)();a[0]===Symbol.for("react.memo_cache_sentinel")?(e={onSuccess:M,onError:O},a[0]=e):e=a[0];let{mutate:u}=(0,y.U)(e);if(!c||!(o||d))return null;let f=c.commentsPreference===A.sI.Collapsed;return a[1]===Symbol.for("react.memo_cache_sentinel")?(t=(0,i.jsx)(s.l.Divider,{}),a[1]=t):t=a[1],a[2]!==f||a[3]!==u?(n=()=>u({commentsPreference:f?A.sI.Visible:A.sI.Collapsed}),a[2]=f,a[3]=u,a[4]=n):n=a[4],a[5]!==f||a[6]!==n?(l=(0,i.jsxs)(i.Fragment,{children:[t,(0,i.jsx)(s.l.Group,{"aria-label":"Comments",selectionVariant:"single",children:(0,i.jsx)(s.l.Item,{role:"menuitemcheckbox",selected:f,onSelect:n,children:"Minimize comments"})})]}),a[5]=f,a[6]=n,a[7]=l):l=a[7],l}function O(){}function M(){}try{T.displayName||(T.displayName="DiffCommentsPreferenceToggle")}catch{}function $(e){let t,n,d,c,u,f,m,h,p,g,x;let b=(0,r.c)(22),{invisible:y,lineSpacingPreferenceAvailable:C,reloadOnSplitPreferenceChange:N,reloadOnWhitespaceChange:j,small:w}=e,L=void 0===C||C,S=void 0!==N&&N,D=void 0!==j&&j,E=void 0===y||y?"Button--invisible":"Button--secondary",R=w&&"Button--small";return b[0]!==E||b[1]!==R?(t=(0,o.$)("Button Button--iconOnly",E,R),b[0]=E,b[1]=R,b[2]=t):t=b[2],b[3]===Symbol.for("react.memo_cache_sentinel")?(n=(0,i.jsx)(l.GearIcon,{}),b[3]=n):n=b[3],b[4]!==t?(d=(0,i.jsx)(a.W.Anchor,{children:(0,i.jsx)("button",{className:t,"aria-label":"Open diff view settings",children:n})}),b[4]=t,b[5]=d):d=b[5],b[6]!==S?(c=(0,i.jsx)(I,{reloadOnChange:S}),b[6]=S,b[7]=c):c=b[7],b[8]===Symbol.for("react.memo_cache_sentinel")?(u=(0,i.jsx)(T,{}),f=(0,i.jsx)(s.l.Divider,{}),b[8]=u,b[9]=f):(u=b[8],f=b[9]),b[10]!==L||b[11]!==D?(m=(0,i.jsx)(k,{lineSpacingPreferenceAvailable:L,reloadOnChange:D}),b[10]=L,b[11]=D,b[12]=m):m=b[12],b[13]!==c||b[14]!==m?(h=(0,i.jsx)(a.W.Overlay,{children:(0,i.jsxs)(s.l,{children:[c,u,f,m]})}),b[13]=c,b[14]=m,b[15]=h):h=b[15],b[16]!==h||b[17]!==d?(p=(0,i.jsxs)(a.W,{children:[d,h]}),b[16]=h,b[17]=d,b[18]=p):p=b[18],b[19]===Symbol.for("react.memo_cache_sentinel")?(g=(0,i.jsx)(v,{}),b[19]=g):g=b[19],b[20]!==p?(x=(0,i.jsxs)(i.Fragment,{children:[p,g]}),b[20]=p,b[21]=x):x=b[21],x}try{$.displayName||($.displayName="DiffViewSettings")}catch{}},78026:(e,t,n)=>{n.d(t,{L:()=>d});var i=n(74848),r=n(21728),l=n(38621),a=n(87330),s=n(94977),o=n(34164);let d=n(96540).forwardRef((e,t)=>{let n,d,c,u;let f=(0,r.c)(21),{expanded:m,testid:h,ariaLabel:p,ariaControls:g,onToggleExpanded:x,alignment:b,dataHotkey:y,className:C,size:v,tooltipDirection:N,variant:j}=e,w=`expand-button-${h}`,L=m?`collapse-${h}`:`expand-${h}`,k=`expand-button-${h}`,S=m?"left"===b?l.SidebarExpandIcon:l.SidebarCollapseIcon:"left"===b?l.SidebarCollapseIcon:l.SidebarExpandIcon;f[0]!==x?(n=e=>{x(e)},f[0]=x,f[1]=n):n=f[1];let D=j??"invisible";return f[2]!==C?(d=(0,o.$)(C,"fgColor-muted"),f[2]=C,f[3]=d):d=f[3],f[4]!==g||f[5]!==y||f[6]!==m||f[7]!==t||f[8]!==v||f[9]!==L||f[10]!==k||f[11]!==S||f[12]!==n||f[13]!==D||f[14]!==d?(c=(0,i.jsx)(a.K,{unsafeDisableTooltip:!0,ref:t,"data-testid":L,"aria-labelledby":k,"aria-expanded":m,"aria-controls":g,icon:S,"data-hotkey":y,onClick:n,variant:D,size:v,className:d,"data-analytics-opt-out":!0}),f[4]=g,f[5]=y,f[6]=m,f[7]=t,f[8]=v,f[9]=L,f[10]=k,f[11]=S,f[12]=n,f[13]=D,f[14]=d,f[15]=c):c=f[15],f[16]!==p||f[17]!==w||f[18]!==c||f[19]!==N?(u=(0,i.jsx)(s.A,{"aria-label":p,id:w,direction:N,children:c}),f[16]=p,f[17]=w,f[18]=c,f[19]=N,f[20]=u):u=f[20],u});d.displayName="ExpandButton"},8877:(e,t,n)=>{n.r(t),n.d(t,{default:()=>m});var i=n(74848),r=n(94232),l=n(6869),a=n(75177),s=n(63867),o=n(52464),d=n(96540);let c={ERROR:"ERROR",LOADING:"LOADING",LOADED:"LOADED",READY:"READY"};function u(e){e&&(e.load=e.hello=null,e.helloTimer&&(clearTimeout(e.helloTimer),e.helloTimer=null),e.loadTimer&&(clearTimeout(e.loadTimer),e.loadTimer=null))}function f(e,t){e&&e.postMessage&&e.postMessage(JSON.stringify(t),"*")}function m({identityUuid:e,size:t,type:n,url:o}){let[m]=(0,r.I)(()=>window.location.origin,"https://www.github.com",[]),p=new URL(o,m).origin,{renderState:g,errorMsg:x,iFrameRef:b,containerRef:y}=function(e){let[t,n]=function(e){let[t,n]=(0,d.useState)(e),i=(0,d.useRef)(t);return[i,e=>{i.current=e,n(e)}]}(c.LOADING),i=(0,d.useRef)(null),r=(0,d.useRef)(null),l=(0,d.useRef)(null),a=(0,d.useRef)({untimed:!0}),s=(0,d.useCallback)(t=>(function(e,t,n,i,r,l,a){if(e.origin!==t)return;let s=function(e){var t;let n=e.data;if(!n)return null;if("string"==typeof n)try{n=JSON.parse(n)}catch{return null}return"object"==typeof(t=n)&&t&&"render"===t.type&&"string"==typeof t.body&&"object"==typeof t.payload?n:null}(e);if(!s){l(c.ERROR);return}let o=s.body,d=null!=s.payload?s.payload:void 0,u=n.current?.contentWindow;switch(o){case"hello":(r.current??{untimed:!0}).hello=Date.now(),f(u,{type:"render:cmd",body:{cmd:"ack",ack:!0}}),f(u,{type:"render:cmd",body:{cmd:"branding",branding:!1}});break;case"error":case"error:fatal":case"error:invalid":d&&a(d.error??null),l(c.ERROR);break;case"loading":l(c.LOADING);break;case"loaded":l(c.LOADED);break;case"ready":d&&"number"==typeof d.height&&i.current&&(i.current.style.height=`${d.height}px`),l(c.READY);break;case"resize":d&&"number"==typeof d.height&&i.current&&(i.current.style.height=`${d.height}px`);break;case"code_rendering_service:container:get_size":f(u,{type:"render:cmd",body:{cmd:"code_rendering_service:container:size","code_rendering_service:container:size":{width:i.current?.getBoundingClientRect().width}}});break;case"code_rendering_service:markdown:get_data":if(!n.current||!i.current)return;!function(e,t){let n=e.getAttribute("data-content");if(!n)return;let i={type:"render:cmd",body:{cmd:"code_rendering_service:data:ready","code_rendering_service:data:ready":{data:JSON.parse(n).data,width:t.getBoundingClientRect().width}}};f(e.contentWindow,i)}(n.current,i.current)}})(t,e,r,l,a,n,e=>i.current=e),[e,n]);return(0,d.useEffect)(()=>{u(a.current);let e=e=>{(t.current===c.LOADING||t.current===c.LOADED)&&(!e||a.current.hello)&&n(c.ERROR)};return a.current={load:Date.now(),hello:null,helloTimer:window.setTimeout(e,1e4,!0),loadTimer:window.setTimeout(e,45e3)},()=>{u(a.current)}},[t,n]),(0,d.useEffect)(()=>(window.addEventListener("message",s),()=>window.removeEventListener("message",s)),[s]),{renderState:t.current,errorMsg:i.current,iFrameRef:r,containerRef:l}}(p);if("ipynb"===n&&t>3e7||t>2e8)return(0,i.jsx)(l.A,{variant:"danger",children:"Sorry, this is too big to display."});let C=g!==c.READY?{height:"1px",width:"1px",position:"fixed",bottom:0,right:0}:{height:"100%",width:"100%"};return(0,i.jsx)(a.A,{sx:{width:"100%",display:"flex",justifyContent:"center"},children:(0,i.jsxs)(a.A,{"data-hpc":!0,"data-host":p,"data-type":n,ref:y,sx:{width:1024,...g!==c.ERROR?{borderBottomLeftRadius:"6px",borderBottomRightRadius:"6px",lineHeight:"0",padding:5,textAlign:"center"}:{},...g===c.READY?{height:"500px",padding:0,background:"none"}:{}},children:[g===c.ERROR?(0,i.jsx)(h,{error:x}):g!==c.READY?(0,i.jsx)(s.A,{size:"large",sx:{mx:"auto"}}):null,g!==c.ERROR&&(0,i.jsx)(a.A,{as:"iframe",ref:b,src:`${o}#${e}`,sandbox:"allow-scripts allow-same-origin allow-top-navigation",sx:{border:0,display:"block",...C},name:e,title:"File display",children:"Viewer requires iframe."})]})})}function h({error:e}){if(!e)return(0,i.jsx)(l.A,{variant:"danger",children:"Unable to render code block"});let t=e.split("\n");return(0,i.jsxs)(l.A,{variant:"danger",children:[(0,i.jsx)(o.A,{as:"p",sx:{fontWeight:"bold"},children:"Error rendering embedded code"}),(0,i.jsx)("p",{children:t.map((e,t)=>(0,i.jsxs)(d.Fragment,{children:[e,(0,i.jsx)("br",{})]},`error-line-${t}`))})]})}try{m.displayName||(m.displayName="FileRendererBlob")}catch{}try{h.displayName||(h.displayName="FileRendererErrorMessage")}catch{}},96728:(e,t,n)=>{n.d(t,{Gx:()=>s});var i=n(74848),r=n(21728),l=n(55314);function a(e){let t;let n=(0,r.c)(2),{char:l}=e;return n[0]!==l?(t=(0,i.jsx)("span",{className:"hidden-unicode-replacement padded",children:l}),n[0]=l,n[1]=t):t=n[1],t}function s(e){return(0,l.Y)(e)?(0,l.t6)(e).map(e=>{let t=l.A0.get(e);return t?`<span class="hidden-unicode-replacement">${t}</span>`:e}).join(""):null}try{a.displayName||(a.displayName="HiddenUnicodeCharacter")}catch{}},84688:(e,t,n)=>{n.d(t,{x:()=>c});var i=n(74848),r=n(21728),l=n(93108),a=n(96540),s=n(94232);function o(e,t){let n,a,o,c,u,f;let m=(0,r.c)(13);m[0]!==e?({children:n,src:o,...a}=e,m[0]=e,m[1]=n,m[2]=a,m[3]=o):(n=m[1],a=m[2],o=m[3]),m[4]===Symbol.for("react.memo_cache_sentinel")?(c=[],m[4]=c):c=m[4];let[h]=(0,s.I)(d,!0,c);return m[5]!==h||m[6]!==o?(u=h?{}:{src:o,"data-nonce":(0,l.M1)()},m[5]=h,m[6]=o,m[7]=u):u=m[7],m[8]!==n||m[9]!==a||m[10]!==t||m[11]!==u?(f=(0,i.jsx)("include-fragment",{...a,ref:t,...u,children:n}),m[8]=n,m[9]=a,m[10]=t,m[11]=u,m[12]=f):f=m[12],f}function d(){return!1}let c=(0,a.forwardRef)(o);try{o.displayName||(o.displayName="IncludeFragmentWithRef")}catch{}try{c.displayName||(c.displayName="IncludeFragment")}catch{}}}]);
//# sourceMappingURL=ui_packages_diff-lines_diff-lines_ts-ui_packages_diff-lines_hooks_use-selected-diff-hash_ts-u-62bb97-5dc744f23fde.js.map